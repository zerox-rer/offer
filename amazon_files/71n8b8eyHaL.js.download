(function(v){var m=window.AmazonUIPageJS||window.P,u=m._namespace||m.attributeErrors,z=u?u("VSEComponentAssets",""):m;z.guardFatal?z.guardFatal(v)(z,window):z.execute(function(){v(z,window)})})(function(v,m,u){(function(){function z(d){m.URLSearchParams&&"1"===(new m.URLSearchParams(m.location.search)).get("iveDebug")&&(m.DistributionMetricsDebugInfo?m.DistributionMetricsDebugInfo.push(d):m.DistributionMetricsDebugInfo=[d])}function I(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,
function(d){var c=16*Math.random()|0;return("x"==d?c:c&3|8).toString(16)})}m.vseFeatures=m.vseFeatures||{};var D=m.gatedP||{register:function(d,c,a,b,g){void 0===g&&(g=m.vseFeatures);v.now(d).execute(d+"-prereg",function(f){f||g[c]||(g[c]=!0,b.resolve(a(b)).then(function(){v.now(d).execute(d+"-reg",function(a){a||(v.log("Gated registration failed to register module!","ERROR",d),g[c]=!1)})}))})},declare:function(d,c,a,b){void 0===b&&(b=m.vseFeatures);v.now(d).execute(d+"-prereg",function(g){g||b[c]||
(b[c]=!0,v.declare(d,a))})}},l={count:function(d,c){var a=m.ue;a&&a.count("vse:csm:"+d,c)},emitNexusMetric:function(d,c,a,b){void 0===b&&(b=!1);m.ue&&m.ue.event&&d&&d.events&&d.events[0]&&d.events[0].data&&(m.ue.event(d.events[0].data,c,a),b&&z(d.events[0].data))},emitSushiMetric:function(d,c,a,b){var g=this;void 0===c&&(c=!1);a=a||"https://unagi-na.amazon.com/1/events/com.amazon.eel.vse.metricstest.nexus";b=b||0;if(!(3<=b)){var f=JSON.stringify(d).replace(/\\\\/g,""),k={params:f,paramsFormat:"json",
contentType:"application/json; charset\x3dutf-8",error:function(){g.emitSushiMetric(d,c,a,++b)}},h=navigator.userAgent.match(/iPhone/i),p=!1;v.now("mash").execute("vse-detect-mshop",function(){p=!0});var t=null!==h&&p;v.when("A").execute("Emit-VSE-Metrics",function(b){navigator&&navigator.sendBeacon&&!t?navigator.sendBeacon(a,f):b.post(a,k)});c&&z(d)}},logFatal:function(d,c,a){m.ueLogError&&m.ueLogError(a,{logLevel:"FATAL",attribution:d,message:c})},logError:function(d,c,a){m.ueLogError&&m.ueLogError(a,
{logLevel:"ERROR",attribution:d,message:c})}},F={makeApplicationSushiPayloadBuilder:function(d,c){return function(a){var b={eventSource:c.eventSource,requestId:c.requestId,sessionId:c.sessionId,placementContext:c.placementContext,creativeId:c.creativeId||"",marketplaceId:c.marketplaceId,weblabIds:c.weblabIds,clientId:c.clientId,isInternal:c.isInternal.toString(),isRobot:c.isRobot.toString(),pageAsin:c.pageAsin,customerId:c.customerId,sessionType:c.sessionType||1,refMarkers:c.refMarkers,eventId:I(),
timestamp:new Date,userAgentData:navigator.userAgent,titleSessionId:0,videoAsin:0,pageUrl:null!==m.location.href?m.location.href.substring(0,500):"",videoAsinList:c.videoAsinList||"",rankingStrategy:""};return{events:[{data:d.$.extend(b,a)}]}}},makeApplicationNexusPayloadBuilder:function(d,c){return function(a){var b={eventSource:c.eventSource,placementContext:c.placementContext,userAgentData:navigator.userAgent,videoAsin:c.videoAsin||"",pageAsin:c.pageAsin||"",videoAsinList:c.videoAsinList||"",titleSessionId:"0",
stringPayload:"",intPayload:1,rankingStrategy:"",creativeId:c.creativeId||"",clientId:c.clientId,pageUrl:null!==m.location.href?m.location.href.substring(0,500):""};return{events:[{data:d.$.extend(b,a)}]}}},makeClickstreamNexusPayloadBuilder:function(d,c){return function(a){return d.$.extend({timestamp:new Date,actionType:c.actionType,eventOwner:c.producerId,eventType:c.eventType,productId:c.productId},a)}},extendWithNewField:function(d,c,a){return d&&d.events&&d.events[0]&&d.events[0].data?(d=d.events[0].data,
d[c]=a,{events:[{data:d}]}):d}},x={fetchLatestPageState:function(d,c){d.state.replace(c,JSON.parse(d.$("script[type\x3d'a-state'][data-a-state*\x3d"+c+"]").html()));return d.state(c)},isDefined:function(d){return"undefined"!==typeof d&&null!==d}},w={updateReftagParam:function(d,c){return w.updateQueryStringParameter(d,"ref_?","ref",c)},updateQueryStringParameter:function(d,c,a,b){c=new RegExp("([?\x26/])"+c+"\x3d.*?(\x26|$)","i");var g=-1!==d.indexOf("?")?"\x26":"?";return d.match(c)?d.replace(c,
"$1"+a+"\x3d"+b+"$2"):d+g+a+"\x3d"+b},generateUUID:function(){for(var d="",c=0;13>c;c++)d+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return d},decodeEntities:function(d){var c=document.createElement("textarea");c.innerHTML=d;return c.value},triggerShare:function(d,c,a,b){if(c){c=screen.width;var g=screen.height;a=a?a:.7*c;b=b?b:.7*g;m.open(d,"_blank","toolbar\x3d0,status\x3d0,width\x3d"+a+",height\x3d"+b+",top\x3d"+(g/2-b/2)+",left\x3d"+
(c/2-a/2))}else m.open(d,"_self")},getPageData:function(d){return"undefined"!==typeof d.pageLevelStateKey?A.state(d.pageLevelStateKey):d.pageLevelData},buildUrl:function(d,c){c=c||{};for(var a=m.navigator&&m.navigator.userAgent&&m.navigator.userAgent.match(/iPhone/i),b=Object.keys(c),g=0<b.length&&("sms:"!==d||!a)?"?":"",a=0;a<b.length;a++)"?"!==g&&(g+="\x26"),c[b[a]]&&(g+=b[a]+"\x3d"+encodeURIComponent(c[b[a]]));return d+g},generateReftags:function(d,c){var a,b;d=w.getPageData(d);"undefined"!==typeof d&&
(a=d.clientRef,b=d.deviceTypeRef);a=a?a:"un";b=b?b:"un";d=c?c:"un";c=w.generateUUID();d="cm_sw_"+d;a=a+"_"+b+"_"+c;return{returnReftag:d+"_r_"+a,clickReftag:d+"_c_"+a}}},ka={share:function(d,c){c={facebook:{shareEndpoint:"https://www.facebook.com/dialog/share",params:function(a){return{href:w.decodeEntities(a.url),display:"popup",quote:a.quote?w.decodeEntities(a.quote):"",app_id:"465632727431967"}},ref:"fb",height:450,width:700,isWebShare:!0},pinterest:{shareEndpoint:"https://www.pinterest.com/pin/create/button",
params:function(a){return{url:w.decodeEntities(a.url),media:w.decodeEntities(a.image),description:w.decodeEntities(a.description)}},ref:"pi",height:620,width:700,isWebShare:!0},twitter:{shareEndpoint:"https://twitter.com/intent/tweet",params:function(a){var c=w.decodeEntities(a.title);a=w.decodeEntities(a.url);if(c){var d=a?Math.min(a.length,20):-1;200<c.length+d+1&&(c=c.substring(0,200-(d+1+3))+"...")}return{text:c,url:a}},ref:"tw",height:470,width:670,isWebShare:!0},email:{shareEndpoint:"mailto:",
params:function(a){return{subject:w.decodeEntities(a.title),body:w.decodeEntities(a.description)+"\n"+w.decodeEntities(a.url)}},ref:"em",height:470,width:670,isWebShare:!1},sms:{shareEndpoint:"sms:",params:function(a){return{body:w.decodeEntities(a.title)+" "+w.decodeEntities(a.url)}},ref:"sm",height:470,width:670,isWebShare:!1},whatsapp:{shareEndpoint:"https://api.whatsapp.com/send",params:function(a){return{text:w.decodeEntities(a.description)+"\n"+w.decodeEntities(a.url)}},ref:"wa",height:470,
width:670,isWebShare:!1}}[c];var a=w.generateReftags(d,c.ref);d.url=w.updateReftagParam(d.url,a.returnReftag);d=w.buildUrl(c.shareEndpoint,c.params(d));w.triggerShare(d,c.isWebShare,c.width,c.height)}},y={sendRequest:function(d,c,a,b,g){d.ajax(c,{params:a,paramsFormat:"json",crossDomain:!0,method:"POST",withCredentials:!0,contentType:"application/json",success:b,error:g})}},la={sendRequest:function(d,c,a,b,g){d.ajax(c,{params:a,paramsFormat:"json",crossDomain:!0,method:"POST",withCredentials:!0,contentType:"application/json",
success:b,error:g})}},ma={getClosedCaptions:function(d,c){var a=[];if(!d.objectIsEmpty(c))for(d=c.split(","),c=0;c<d.length;c+=2)d[c+1]!==u&&a.push({locale:d[c],url:d[c+1]});return a}},G=function(){return function(d){this.message=d}}(),K=function(){function d(c,a){void 0===a&&(a={refTagRecorderEndPoint:"/gp/mobile/tag/?",retryLimit:3});this.A=c;this.config=a}d.prototype.emitRefTag=function(c,a){void 0===a&&(a=0);if(!(a>=this.config.retryLimit)){var b=this;this.A.get(this.config.refTagRecorderEndPoint+
"ref\x3d"+c,{error:function(){b.emitRefTag(c,++a)}})}};return d}(),na=u&&u.__assign||Object.assign||function(d){for(var c,a=1,b=arguments.length;a<b;a++){c=arguments[a];for(var g in c)Object.prototype.hasOwnProperty.call(c,g)&&(d[g]=c[g])}return d},oa=function(){function d(c){var a=this;this.config=c;this.log=function(b){if(a.videoEvent){var c=a.$container.closest("[data-csa-c-id]");0<c.length?(a.basePayload.parentElementId=c.data("csa-c-id"),a.videoEvent("setEntity",{video:na({},a.basePayload,b)}),
a.videoEvent("log",{schemaId:a.schemaId},{ent:"all"})):m.ue&&(m.ue.count(d.CANNOT_FIND_CSA_WIDGET,1),l.logError("ive-lucid-video-events","Cannot find CSA widget, container id: "+a.$container.attr("id")+", eventPayload: "+JSON.stringify(b),"Cannot find CSA widget, container id: "+a.$container.attr("id")+", eventPayload: "+JSON.stringify(b)))}else l.count("ive:csa:cannotCreateVideoEvent:noVideoEvent",1)};this.schemaId=c.schemaId;this.$container=c.$container;this.basePayload={player:"Brila",parentElementId:""};
m.csa?this.videoEvent=m.csa("Events",{producerId:c.producerId,lob:m.ue_lob?m.ue_lob:""}):l.count("ive:csa:cannotCreateVideoEvent:noCsaAvailable",1)}d.CANNOT_FIND_CSA_WIDGET="ive-cannot-find-csa-widget";return d}(),P=function(){function d(c,a,b,g,f){var k=this;this.player=a;this.A=b;this.isIvx=g;this.clientPrefix=f;this.secondsFromLastEvent=this.lastLoggedEventInterval=this.loggingInterval=this.initialLoggingDelay=0;this.aciContentId="";this.emitCarouselClickEvent=function(){k.logCSAEvent(k.secondsFromLastEvent,
"ENDED");k.isAutoplay=!1};this.attachPlayerEventListeners=function(){k.player.on("playbackStart",k._playbackStartHandler);k.player.on("playbackComplete",k._playbackCompleteHandler);k.player.on("fullscreenchange",k._playerModeChangeHandler);k.player.on("pause",k._playbackPauseHandler);k.player.on("mute",k._playbackMuteHandler);k.player.on("unmute",k._playbackUnmuteHandler);k.player.on("enableClosedCaptions",k._playbackEnableClosedCaptionsHandler);k.player.on("disableClosedCaptions",k._playbackDisableClosedCaptionsHandler);
k.A.on("vse:"+k.clientPrefix+":player:continuous:play",function(){k.isAutoplay=!0});k.A.on("vse:"+k.clientPrefix+":page:lightBoxClosed",function(){k.isAutoplay=!1})};this._playbackStartHandler=function(){k.aciContentId=k.getCurrentACIContentId();k.logCSAEvent(k.secondsFromLastEvent,"PLAYING");l.count(k.clientPrefix+":csa:startPlaying",1);k.removeCSAEventHandler();k.addCSAEventHandler()};this._playbackCompleteHandler=function(){k.logCSAEvent(k.secondsFromLastEvent,"ENDED");k.removeCSAEventHandler()};
this._playerModeChangeHandler=function(){k.logCSAEvent(k.secondsFromLastEvent,"MODE_CHANGED",k.currentPlayerMode);k.removeCSAEventHandler();k.addCSAEventHandler()};this._playbackPauseHandler=function(){k.logCSAEvent(k.secondsFromLastEvent,"STOPPED");k.removeCSAEventHandler()};this._playbackMuteHandler=function(){k.logCSAEvent(k.secondsFromLastEvent,"MUTED");k.removeCSAEventHandler();k.addCSAEventHandler()};this._playbackUnmuteHandler=function(){k.logCSAEvent(k.secondsFromLastEvent,"UNMUTED");k.removeCSAEventHandler();
k.addCSAEventHandler()};this._playbackEnableClosedCaptionsHandler=function(){k.logCSAEvent(k.secondsFromLastEvent,"CAPTIONS_ON");k.removeCSAEventHandler();k.addCSAEventHandler()};this._playbackDisableClosedCaptionsHandler=function(){k.logCSAEvent(k.secondsFromLastEvent,"CAPTIONS_OFF");k.removeCSAEventHandler();k.addCSAEventHandler()};this.addCSAEventHandler=function(){k.lastLoggedEventInterval=k.A.interval(function(){k.secondsFromLastEvent++},d.TIMERS.TIME_FROM_LAST_EVENT_MS);k.initialLoggingDelay=
k.A.delay(function(){k.logCSAEvent(k.secondsFromLastEvent,"PLAYING");k.loggingInterval=k.A.interval(function(){k.logCSAEvent(k.secondsFromLastEvent,"NONE")},d.TIMERS.SUBSEQUENT_INTERVAL_MS)},d.TIMERS.INITIAL_DELAY_MS)};this.removeCSAEventHandler=function(){clearInterval(k.lastLoggedEventInterval);clearInterval(k.loggingInterval);clearTimeout(k.initialLoggingDelay);k.secondsFromLastEvent=0;k.loggingInterval=0;k.initialLoggingDelay=0};this.logCSAEvent=function(a,b,c){""!==k.aciContentId?(k.currentPlayerMode=
k.getCurrentPlayerMode(),a={contentId:k.aciContentId,viewDuration:a.toString(),playerMode:c||k.currentPlayerMode,isAutoPlayed:k.isAutoplay.toString(),isCaptionOn:k.player.isCaptionOn().toString(),isAudioOn:(!k.player.isMuted()).toString(),videoRequestId:k.player.getTitleSessionId().toString(),eventName:b},k.csa.log(a),k.secondsFromLastEvent=0):l.count(k.clientPrefix+":csa:noContentIdPresented",1)};this.csa=new oa(c);this.player=a;this.currentPlayerMode=this.getCurrentPlayerMode();this.isAutoplay=
this.player.isAutoplayed();this.attachPlayerEventListeners()}d.prototype.getCurrentPlayerMode=function(){return this.isIvx?"IMMERSIVE_VIEW":this.player.isFullscreen()?"FULL_SCREEN":"MODAL"};d.prototype.getCurrentACIContentId=function(){return this.player.getCurrent().aciContentId||""};d.TIMERS={INITIAL_DELAY_MS:2E3,SUBSEQUENT_INTERVAL_MS:3E4,TIME_FROM_LAST_EVENT_MS:1E3};return d}(),Q=function(){return function(d){var c=this;this.A=d;this.buildTag=function(a){if(!a.href)return"";var b="tag\x3d"+a.vendorTrackingId,
g=a.asin;c.A.objectIsEmpty(g)||(g="\x26creativeASIN\x3d"+g);var d="linkCode\x3d",d=c.A.objectIsEmpty(a.linkCode)?d+"vse":d+a.linkCode,f=a.aciContentId,h="";c.A.objectIsEmpty(a.aciContentId)||(h="\x26asc_contentid\x3d"+f);b=b+"\x26"+d+g+h;b=0>a.href.indexOf("?")?"?"+b:"\x26"+b;return a.href+b}}}(),R={queueComplete:!0},S=function(){function d(c,a,b){var g=this;this.player=c;this.frame=a;this.assets=[];this.currentIndex=0;this.eventEmitter=new b.EventEmitter;this.player.on("playbackComplete",function(){g.currentIndex++;
g.doPlay()})}d.prototype.play=function(c){c?this.player.play(c):this.player.play();return this};d.prototype.getCurrentTime=function(){return this.player.getCurrentTime()};d.prototype.setCurrentTime=function(c){this.player.setCurrentTime(c);return this};d.prototype.getMediaDuration=function(){return this.player.getMediaDuration()};d.prototype.mute=function(){this.player.mute();return this};d.prototype.unmute=function(){this.player.unmute();return this};d.prototype.isMuted=function(){return this.player.isMuted()};
d.prototype.resume=function(c){this.player.resume(c);return this};d.prototype.pause=function(c){this.player.pause(c);return this};d.prototype.next=function(){this.player.stop();this.currentIndex++;this.doPlay();return this};d.prototype.previous=function(){this.player.stop();this.currentIndex--;this.doPlay();return this};d.prototype.seek=function(c){this.player.seek(c);return this};d.prototype.enqueue=function(c,a){void 0===a&&(a=this.assets.length);c instanceof Array?(c=c.slice(),c.splice(0,0,this.assets),
Array.prototype.splice.apply(this.assets,c)):this.assets.splice(a,0,c);return this};d.prototype.dequeue=function(c){var a=this,b;if("number"===typeof c)b=[c];else if(c instanceof Array){var g=c.map(function(a){return a.contentId});b=this.assets.map(function(a){return g.indexOf(a.contentId)}).filter(function(a){-1!=a})}else b=[this.assets.map(function(a,b){return b}).filter(function(b){a.assets[b].contentId==c.contentId})[0]];for(var d=0,f=b.length;d<f;d++)this.assets.splice(b[d],1);return this};d.prototype.on=
function(c,a){if(R.hasOwnProperty(c))this.eventEmitter.on(c,a);else this.player.on(c,a);return this};d.prototype.off=function(c,a){R.hasOwnProperty(c)?this.eventEmitter.off(c,a):this.player.off(c,a);return this};d.prototype.ready=function(c){this.player.ready(c);return this};d.prototype.readyState=function(){return this.player.readyState()};d.prototype.load=function(){this.player.load();return this};d.prototype.getAssets=function(){return this.assets};d.prototype.getCurrentAssetIndex=function(){return this.currentIndex-
1};d.prototype.getPosition=function(){return this.player.getPosition()};d.prototype.isPlaying=function(){return this.player.isPlaying()};d.prototype.isPaused=function(){return this.player.isPaused()};d.prototype.getVersion=function(){return this.player.getVersion()};d.prototype.destroy=function(){this.player.destroy()};d.prototype.addChild=function(c,a){this.player.addChild(c,a);return this};d.prototype.removeChild=function(c){this.player.removeChild(c);return this};d.prototype.loadNextVideoPoster=
function(c){this.player.loadNextVideoPoster(c);return this};d.prototype.blur=function(){this.player.blur();return this};d.prototype.requestFullscreen=function(){this.player.requestFullscreen();return this};d.prototype.exitFullscreen=function(){this.player.exitFullscreen();return this};d.prototype.isFullscreen=function(){return this.player.isFullscreen()};d.prototype.fluid=function(c){this.player.fluid(c);return this};d.prototype.aspectRatio=function(c){this.player.aspectRatio(c);return this};d.prototype.enableCurrentTextTrack=
function(c){void 0===c&&(c="en");this.player.enableCurrentTextTrack(c);return this};d.prototype.disableCurrentTextTrack=function(c){void 0===c&&(c="en");this.player.disableCurrentTextTrack(c);return this};d.prototype.updateTextTrack=function(c){this.player.updateTextTrack(c);return this};d.prototype.removeCurrentTextTracks=function(){this.player.removeCurrentTextTracks();return this};d.prototype.setInitialData=function(c){var a=document.getElementsByClassName("vse-player-container");this.player.setInitialData(c);
c&&c.aciContentId&&0<a.length&&(a[0].hasAttribute("data-csa-c-content-id")||""===a[0].getAttribute("data-csa-c-content-id"))&&a[0].setAttribute("data-csa-c-content-id",c.aciContentId);return this};d.prototype.showPoster=function(c){this.player.showPoster(c);return this};d.prototype.getCurrent=function(){return this.player.getCurrent()};d.prototype.isCaptionOn=function(){return this.player.isCaptionOn()};d.prototype.isAutoplayed=function(){return this.player.isAutoplayed()};d.prototype.getTitleSessionId=
function(){return this.player.getTitleSessionId()};d.prototype.requestPictureInPicture=function(){this.player.requestPictureInPicture();return this};d.prototype.exitPictureInPicture=function(){this.player.exitPictureInPicture();return this};d.prototype.setPlayerMode=function(c){this.player.setPlayerMode(c);return this};d.prototype.doPlay=function(){var c=this.player.getCurrent();c&&this.assets[this.currentIndex]?this.assets[this.currentIndex].contentId==c.contentId?this.player.play():this.player.play(this.assets[this.currentIndex]):
this.assets[this.currentIndex]&&this.player.play(this.assets[this.currentIndex])};return d}(),pa=function(){function d(c,a){var b=this;this.isMshop=this.isReportWidgetClosed=this.mouseOverVideoPlayer=!1;this.DISCLOSURE_SELECTOR=".ive-video-disclosure-container-wrapper";this.INFLUENCER_DISCLOSURE_SELECTOR=".ive-aip-link";this.PUBLISHER_DISCLOSURE_SELECTOR=".ive-osp-link";this.HIDDEN_CSS_CLASS="aok-hidden";this.REPORT_COPYRIGHT_SELECTOR=".vse-fb-copyright";this.REPORT_SHOWN_METRIC="ive:player:report:shown";
this.REPORT_SUBMITTED_METRIC="ive:player:report:submit";this.REPORT_HIDDEN_METRIC="ive:player:report:hidden";this.update=function(a){b.report&&b.report.setActiveVideoAndSource(a.contentId,a.vendorCode,a.aciContentId);if(!0===b.config.includeEarnsComissionDisclosure&&b.$disclosureContainer){var c=b.$disclosureContainer.find(b.INFLUENCER_DISCLOSURE_SELECTOR),d=b.$disclosureContainer.find(b.PUBLISHER_DISCLOSURE_SELECTOR),f="Influencer"===a.creatorType;a="3P"===a.creatorType;c.toggleClass(b.HIDDEN_CSS_CLASS,
!f);d.toggleClass(b.HIDDEN_CSS_CLASS,f);b.$disclosureContainer.toggleClass(b.HIDDEN_CSS_CLASS,!(f||a))}};this.destroy=function(){b.report&&b.$reportContainer.remove();b.$disclosureContainer&&b.$disclosureContainer.remove()};this.deRegisterReport=function(){b.A.off("vse:"+b.reportId+":feedback:shown");b.A.off("vse:"+b.reportId+":feedback:hidden");b.A.off("vse:"+b.reportId+":feedback:submitted:success")};this.addReportHandlers=function(){b.A.on("vse:"+b.reportId+":feedback:shown",function(){l.count(b.REPORT_SHOWN_METRIC,
1);b.playerShim&&b.playerShim.isPlaying()&&b.playerShim.pause();b.isReportWidgetClosed=!1;b.$reportContainer.find(b.REPORT_COPYRIGHT_SELECTOR).click(function(a){b.isMshop&&(a.preventDefault(),b.report.showInfringementNotSupport())})});b.A.on("vse:"+b.reportId+":feedback:hidden",function(){l.count(b.REPORT_HIDDEN_METRIC,1);b.isReportWidgetClosed=!0;b.mouseOverVideoPlayer||b.hideReportWidget();b.$reportContainer.find(b.REPORT_COPYRIGHT_SELECTOR).unbind("click")});b.A.on("vse:"+b.reportId+":feedback:submitted:success",
function(){l.count(b.REPORT_SUBMITTED_METRIC,1)})};this.showReportWidget=function(){b.$reportContainer.css({display:"inline-block"});b.toggleDimVideoPlayer(!0)};this.hideReportWidget=function(){b.$reportContainer.css({display:"none"});b.toggleDimVideoPlayer(!1)};this.toggleDimVideoPlayer=function(a){b.$playerContainer.find("video").toggleClass("dim-video-player",a)};this.mouseLeaveHandler=function(){b.isReportWidgetClosed&&b.hideReportWidget();b.mouseOverVideoPlayer=!1};this.config=c;this.playerShim=
a}d.prototype.initialize=function(c){var a=this;v.when("A","a-button","ready").execute("IVECreateBasicComponentsForPlayer",function(b,g){a.A=b;a.isMshop=b.capabilities.mobile&&b.capabilities.isAmazonApp;a.$playerContainer=a.A.$("#"+a.config.parentId);a.deRegisterReport();var d=b.state(a.config.reportPageStateName);a.reportId=d.id;b=new a.config.feedbackFactory({A:b,buttonApi:g});a.report=b.create(a.reportId,a.config.reportPageStateName,!1);a.addReportHandlers();a.$disclosureContainer=a.$playerContainer.parent().find(a.DISCLOSURE_SELECTOR);
a.$playerContainer.append(a.$disclosureContainer);a.update(c);a.$reportContainer=a.$playerContainer.parent().find(".ive-"+a.config.clientPrefix+"-report-container");a.isReportWidgetClosed=!0;a.$reportContainer.removeClass(a.HIDDEN_CSS_CLASS);a.$playerContainer.append(a.$reportContainer);b="report-overlays-player-"+a.reportId;a.A.declarative.create(a.$playerContainer,b,{});a.A.declarative(b,"mouseenter touchstart focus",function(){a.isReportWidgetClosed&&a.showReportWidget();a.mouseOverVideoPlayer=
!0;a.A.capabilities.touch&&a.A.delay(a.mouseLeaveHandler,3E3)});a.A.declarative(b,"mouseleave",a.mouseLeaveHandler)})};return d}(),qa=u&&u.__assign||Object.assign||function(d){for(var c,a=1,b=arguments.length;a<b;a++){c=arguments[a];for(var g in c)Object.prototype.hasOwnProperty.call(c,g)&&(d[g]=c[g])}return d},T=function(){function d(c,a,b,g){var d=this;this.config=a;this.libs=g;this.VSE_CC_KEY="vse_brila_cc_status";this.eventEmitter=new g.EventEmitter;this.currentAsset=b;this.initHandlers();b=a.parentId+
"-element";var f;a.isReactFactory||(f=document.getElementById(a.parentId),this.videoElement=document.createElement("video"),this.videoElement.id=b,this.videoElement.className=a.isVideoImmersivePlayer?"video-js brila-vip-vjs":"video-js brila-video-js",this.currentAsset&&this.currentAsset.videoTitle&&this.videoElement.setAttribute("aria-label",this.currentAsset.videoTitle),this.videoElement.setAttribute("playsinline","true"),this.videoElement.setAttribute("disablepictureinpicture","true"),a.shouldDisableControls||
a.isChromelessPlayer||this.videoElement.setAttribute("controls","true"),a.shouldAutoplay&&this.videoElement.setAttribute("autoplay","true"),(a.shouldStartMuted||a.isChromelessPlayer)&&this.videoElement.setAttribute("muted","true"),a.shouldPreload||this.videoElement.setAttribute("preload","none"),f.appendChild(this.videoElement));g=this.getDefaultLanguageForPlayer();var h={player:{playsinline:!0,autoplay:a.shouldAutoplay,loop:a.shouldLoop,muted:a.shouldStartMuted||a.isChromelessPlayer,preload:a.shouldPreload?
"auto":"none",techOrder:["html5"],textTrackSettings:!1,html5:{hls:{overrideNative:c.overrideNativePlayer()},nativeAudioTracks:!1,nativeVideoTracks:!1,nativeTextTracks:!1},controlBar:{pictureInPictureToggle:!1},language:g},hotkeys:{skipInitialFocus:a.skipInitialFocus,enableInactiveFocus:a.enableInactiveFocus}};!0===a.allowCrossOrigin&&(h.player.crossorigin="anonymous");a.closedCaptionsConfig&&(h.languages=(t={},t[g]=qa({"captions off":a.closedCaptionsConfig.captionsOffText,"subtitles off":a.closedCaptionsConfig.captionsOffText},
a.closedCaptionsConfig.languageToLabelTexts),t));a.isChromelessPlayer&&(h.player.children=["MediaLoader"],h.player.controls=!1);a.isVideoImmersivePlayer&&(h.player.bigPlayButton=!1,h.player.posterImage=a.posterSource,h.player.controlBar={playToggle:!1,volumePanel:!1,currentTimeDisplay:!0,remainingTimeDisplay:!0,fullscreenToggle:!1});this.videoJS=t=c.embed(b,a,h);b=document.getElementById(b);b.setAttribute("style","width:100%; height:100%;");!1!==a.showPosterImage&&this.videoJS.poster(a.posterSource);
(g=b.querySelector(".vjs-volume-bar.vjs-slider-bar"))&&g.setAttribute("title",a.volumeSliderTitle||"Volume Slider");a.shouldPreload&&this.videoJS.src({src:a.videoUrl,type:a.mimeType});this.vseMetrics=c.metrics(this.videoJS);this.vseMetrics.updateMuteMetrics(this.eventEmitter);if(a.isVideoImmersivePlayer)this.videoJS.on("click",function(){d.eventEmitter.emit("playerClick")}),this.videoJS.on("touchstart",function(){d.eventEmitter.emit("playerClick")});else{this.videoJS.aspectRatio("16:9");if(c=b.querySelector(".vjs-play-control"))g=
c.getAttribute("title"),null!=g&&c.setAttribute("aria-label",g);if(c=b.querySelector(".vjs-mute-control"))g=c.getAttribute("title"),null!=g&&c.setAttribute("aria-label",g);if(c=b.querySelector(".vjs-fullscreen-control"))b=c.getAttribute("title"),null!=b&&c.setAttribute("aria-label",b)}this.videoJS.on("ended",function(){d.eventHandlers.onPlaybackComplete()});this.videoJS.on("playing",function(){d.eventHandlers.onPlaybackStart();d.config.useAutoplayFallback&&(d.eventEmitter.emit("autoplaySucceeded"),
d.config.useAutoplayFallback=!1)});this.videoJS.on("cancelContinuousPlay",function(){d.eventHandlers.onCancelContinuousPlay()});this.videoJS.on("playUpNext",function(){d.eventHandlers.onPlayUpNext()});var p=this;t.ready(function(){p.eventEmitter.emit("playerLoaded");f&&f.children[0]&&(f.children[0].removeAttribute("role"),f.children[0].removeAttribute("aria-label"))});if(a.feedbackFactory!==u||a.includeEarnsComissionDisclosure)this.basicComponents=new pa(a,this),this.basicComponents.initialize(this.currentAsset);
var t}d.prototype.play=function(c){var a=this;this.vseMetrics.setPlayCommandInvokeTimestamp(Date.now());if(this.isDPXDesktopFullScreenRequest(c))this.vseMetrics.setPageLoadStartTimestamp(Date.now()),this.videoJS.play();else if(this.setInitialData(c),this.config.useAutoplayFallback)c=this.videoJS.play(),c!==u&&c.then(function(a){}).catch(function(b){a.eventEmitter.emit("autoplayFailed")});else return this.videoJS.play()};d.prototype.setInitialData=function(c){var a=this.getTextTrackMode("en");c&&c.rankingStrategy&&
1===Object.keys(c).length?this.vseMetrics.setRankingStrategy(c.rankingStrategy):!c||1===Object.keys(c).length&&"rankingStrategy"in c||(this.currentAsset&&c.contentId===this.currentAsset.contentId?this.config.shouldPreload||this.videoJS.src({src:c.videoUrl,type:c.mimeType}):(this.videoJS.poster(c.imageUrl),this.videoJS.posterImage.show(),this.vseMetrics.setContentId&&this.vseMetrics.setContentId(c.contentId),this.vseMetrics.setAciContentId(c.aciContentId),this.vseMetrics.setRefTag&&this.vseMetrics.setRefTag(c.refTag?
c.refTag:""),this.vseMetrics.setOspAttribution&&this.vseMetrics.setOspAttribution({vendorTrackingId:c.vendorTrackingId?c.vendorTrackingId:"",videoReferenceId:c.videoReferenceId?c.videoReferenceId:"",productAsin:c.productAsin?c.productAsin:""}),this.videoJS.src({src:c.videoUrl,type:c.mimeType}),this.currentAsset=c),this.setSeekTimeForInitialData(c),this.vseMetrics.setRankingStrategy(c.rankingStrategy),this.vseMetrics.setCreatorType&&this.vseMetrics.setCreatorType(c.creatorType),this.basicComponents!==
u&&this.basicComponents.update(c),c.title&&this.videoElement.setAttribute("aria-label",c.title));this.removeCurrentTextTracks();var b=[];this.currentAsset&&this.currentAsset.closedCaptions&&(b=this.currentAsset.closedCaptions);c&&c.closedCaptions&&(b=c.closedCaptions);this.updateTextTrack(b);this.vseMetrics.updateTextTrackMetrics(this.eventEmitter);"showing"===a&&this.enableCurrentTextTrack();c=c&&c.eventTimestamp?c.eventTimestamp:Date.now();this.vseMetrics.setPageLoadStartTimestamp(c)};d.prototype.setSeekTimeForInitialData=
function(c){c&&c.seekTime&&this.videoJS.currentTime(c.seekTime);return this};d.prototype.showPoster=function(c){this.videoJS.poster(c);this.videoJS.posterImage.show();return this};d.prototype.updateTextTrack=function(c){var a=this,b=this.videoJS.textTracks();c.forEach(function(c){var g=!1;if(b)for(var d=0;d<b.length;d++){var f=b[d];"subtitles"===f.kind&&f.language===c.locale&&(g=!0)}g||a.videoJS.addRemoteTextTrack({src:c.url,kind:"subtitles",srclang:c.locale,label:a.config.closedCaptionsConfig.captionsOnTexts[c.locale],
"default":!1},!1)});var g;try{m.localStorage.setItem("foo","bar"),m.localStorage.removeItem("foo"),g=!0}catch(d){g=!1}if(g){c=localStorage.getItem(this.VSE_CC_KEY);var f=this.videoJS.remoteTextTracks();if(null===c)localStorage.setItem(this.VSE_CC_KEY,"disabled");else if("disabled"!==c){if(b)for(c=0;c<b.length;++c)if("subtitles"===b[c].kind){b[c].mode="showing";this.eventEmitter.emit("texttrackenable",b[c]);break}if(f)for(c=0;c<f.length;++c)if("subtitles"===f[c].kind){f[c].mode="showing";this.eventEmitter.emit("texttrackenable",
f[c]);break}}if(f)for(g=function(b){var c=f[b];c.on("modechange",function(){"showing"===c.mode?localStorage.setItem(a.VSE_CC_KEY,"showing"):localStorage.setItem(a.VSE_CC_KEY,"disabled")})},c=0;c<f.length;++c)g(c);if(b)for(g=function(c){var g=b[c];g.on("modechange",function(){"showing"===g.mode?localStorage.setItem(a.VSE_CC_KEY,"showing"):localStorage.setItem(a.VSE_CC_KEY,"disabled")})},c=0;c<b.length;++c)g(c)}return this};d.prototype.enableCurrentTextTrack=function(c){void 0===c&&(c="en");this.changeTextTrackMode(c,
"showing");return this};d.prototype.disableCurrentTextTrack=function(c){void 0===c&&(c="en");this.changeTextTrackMode(c,"disabled");return this};d.prototype.muted=function(c){return this.videoJS.muted(c)};d.prototype.mute=function(){this.videoJS.muted(!0);return this};d.prototype.unmute=function(){this.videoJS.muted(!1);return this};d.prototype.isMuted=function(){return this.videoJS.muted()};d.prototype.getCurrentTime=function(){return this.videoJS.currentTime()};d.prototype.setCurrentTime=function(c){this.videoJS.currentTime(c);
return this};d.prototype.getMediaDuration=function(){return isNaN(this.videoJS.duration())?0:this.videoJS.duration()};d.prototype.pause=function(c){this.videoJS.pause(c);return this};d.prototype.resume=function(c){this.videoJS.play();return this};d.prototype.seek=function(c){this.videoJS.currentTime(c);return this};d.prototype.stop=function(){this.videoJS.pause();this.currentAsset=u;return this};d.prototype.on=function(c,a){this.eventEmitter.on(c,a);this.videoJS.on(c,a);return this};d.prototype.off=
function(c,a){return this};d.prototype.ready=function(c){this.videoJS.ready(c);return this};d.prototype.readyState=function(){return this.videoJS.readyState()};d.prototype.load=function(){this.videoJS.load();return this};d.prototype.getCurrent=function(){return this.currentAsset};d.prototype.getPosition=function(){return this.videoJS.currentTime()};d.prototype.isPlaying=function(){return!this.videoJS.paused()};d.prototype.isPaused=function(){return this.videoJS.paused()};d.prototype.getVersion=function(){return"VJS"};
d.prototype.destroy=function(){this.vseMetrics.publishBeforeDispose();this.videoJS.off("ended",this.eventHandlers.onPlaybackComplete);this.videoJS.dispose();this.videoJS=null;this.basicComponents!==u&&this.basicComponents.destroy()};d.prototype.addChild=function(c,a){this.videoJS.addChild(c,a);return this};d.prototype.removeChild=function(c){this.videoJS.removeChild(c);return this};d.prototype.loadNextVideoPoster=function(c){this.videoJS.poster(c);this.videoJS.posterImage.show();return this};d.prototype.aspectRatio=
function(c){this.videoJS.aspectRatio(c);return this};d.prototype.requestFullscreen=function(){this.videoJS.requestFullscreen();return this};d.prototype.exitFullscreen=function(){this.videoJS.exitFullscreen();return this};d.prototype.isFullscreen=function(){return this.videoJS.isFullscreen()};d.prototype.fluid=function(c){this.videoJS.fluid(c);return this};d.prototype.blur=function(){this.videoJS.blur();return this};d.prototype.isCaptionOn=function(){var c=!1,a=this.videoJS.remoteTextTracks();if(a)for(var b=
0;b<a.length;++b)if("showing"===a[b].mode){c=!0;break}if(a=this.videoJS.textTracks())for(b=0;b<a.length;++b)if("showing"===a[b].mode){c=!0;break}return c};d.prototype.isAutoplayed=function(){return this.videoJS.options()&&this.videoJS.options().autoplay?this.videoJS.options().autoplay:!1};d.prototype.getTitleSessionId=function(){return this.vseMetrics.getTitleSessionId()};d.prototype.requestPictureInPicture=function(){this.videoJS.requestPictureInPicture();return this};d.prototype.exitPictureInPicture=
function(){this.videoJS.exitPictureInPicture();return this};d.prototype.setPlayerMode=function(c){this.vseMetrics.updatePlacementContext(c);return this};d.prototype.initHandlers=function(){var c=this;this.eventHandlers={onPlaybackComplete:function(){return c.player_onPlaybackComplete()},onPlaybackStart:function(){return c.player_onPlaybackStart()},onCancelContinuousPlay:function(){return c.player_onCancelContinuousPlay()},onPlayUpNext:function(){return c.player_onPlayUpNext()}}};d.prototype.player_onPlaybackComplete=
function(){var c=this.currentAsset;if(this.previousAsset=this.currentAsset)this.previousAsset.eventTimestamp=Date.now();this.eventEmitter.emit("playbackComplete",c)};d.prototype.player_onCancelContinuousPlay=function(){this.currentAsset=this.previousAsset;this.eventEmitter.emit("cancelContinuousPlay",this.previousAsset)};d.prototype.player_onPlayUpNext=function(){this.eventEmitter.emit("playUpNext",this.previousAsset)};d.prototype.player_onPlaybackStart=function(){this.currentAsset&&(this.currentAsset.eventTimestamp=
Date.now());this.eventEmitter.emit("playbackStart",this.currentAsset)};d.prototype.isDPXDesktopFullScreenRequest=function(c){return this.config.sushiMetricsConfig&&this.config.sushiMetricsConfig.placementContext&&-1!==this.config.sushiMetricsConfig.placementContext.indexOf("desktop_web.ImageBlock")&&c&&!c.hasOwnProperty("refTag")&&this.currentAsset&&c.contentId!==this.currentAsset.contentId};d.prototype.changeTextTrackMode=function(c,a){var b=this.videoJS.remoteTextTracks();if(b)for(var g=0;g<b.length;g++){var d=
b[g];"subtitles"===d.kind&&d.language===c&&(d.mode=a)}if(b=this.videoJS.textTracks())for(g=0;g<b.length;g++)d=b[g],"subtitles"===d.kind&&d.language===c&&(d.mode=a)};d.prototype.getTextTrackMode=function(c){var a=this.videoJS.remoteTextTracks();if(a)for(var b=0;b<a.length;b++){var g=a[b];if("subtitles"===g.kind&&g.language===c)return g.mode}if(a=this.videoJS.textTracks())for(b=0;b<a.length;b++)if(g=a[b],"subtitles"===g.kind&&g.language===c)return g.mode;return"disabled"};d.prototype.removeCurrentTextTracks=
function(){var c=this.videoJS.remoteTextTracks();if(c)for(var a=0;a<c.length;a++)this.videoJS.removeRemoteTextTrack(c[a])};d.prototype.getDefaultLanguageForPlayer=function(){return this.config.languageCode?this.config.languageCode.toString():"en"};return d}(),U=function(){function d(c,a){var b=this;this.libs=a;this.commands=[];c.then(function(a){b.playerInstance=a;b.executeCommands()})}d.prototype.executeCommands=function(){for(var c=0;c<this.commands.length;c++)if(this.playerInstance)this.commands[c](this.playerInstance)};
d.prototype.play=function(c){var a=this;this.playerInstance?this._play(c,this.playerInstance):this.commands.push(function(){for(var b=[],g=0;g<arguments.length;g++)b[g]=arguments[g];return a._play(c,b[0])});return this};d.prototype.mute=function(){var c=this;this.playerInstance?this._mute(this.playerInstance):this.commands.push(function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return c._mute(a[0])});return this};d.prototype.unmute=function(){var c=this;this.playerInstance?this._unmute(this.playerInstance):
this.commands.push(function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return c._unmute(a[0])});return this};d.prototype.isMuted=function(){var c=this;if(this.playerInstance)return this._isMuted(this.playerInstance);this.commands.push(function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return c._isMuted(a[0])});return!0};d.prototype.getCurrentTime=function(){var c=this;if(this.playerInstance)return this._getCurrentTime(this.playerInstance);this.commands.push(function(){for(var a=
[],b=0;b<arguments.length;b++)a[b]=arguments[b];return c._getCurrentTime(a[0])});return 0};d.prototype.setCurrentTime=function(c){var a=this;this.playerInstance?this._setCurrentTime(c,this.playerInstance):this.commands.push(function(){for(var b=[],g=0;g<arguments.length;g++)b[g]=arguments[g];return a._setCurrentTime(c,b[0])})};d.prototype.getMediaDuration=function(){var c=this;if(this.playerInstance)return this._getMediaDuration(this.playerInstance);this.commands.push(function(){for(var a=[],b=0;b<
arguments.length;b++)a[b]=arguments[b];return c._getMediaDuration(a[0])});return 0};d.prototype.pause=function(c){var a=this;this.playerInstance?this._pause(c,this.playerInstance):this.commands.push(function(){for(var b=[],g=0;g<arguments.length;g++)b[g]=arguments[g];return a._pause(c,b[0])});return this};d.prototype.resume=function(c){var a=this;this.playerInstance?this._resume(c,this.playerInstance):this.commands.push(function(){for(var b=[],g=0;g<arguments.length;g++)b[g]=arguments[g];return a._resume(c,
b[0])});return this};d.prototype.stop=function(){var c=this;this.playerInstance?this._stop(this.playerInstance):this.commands.push(function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return c._stop(a[0])});return this};d.prototype.seek=function(c){var a=this;this.playerInstance?this._seek(c,this.playerInstance):this.commands.push(function(){for(var b=[],g=0;g<arguments.length;g++)b[g]=arguments[g];return a._seek(c,b[0])});return this};d.prototype.on=function(c,a){var b=this;this.playerInstance?
this._on(c,a,this.playerInstance):this.commands.push(function(){for(var g=[],d=0;d<arguments.length;d++)g[d]=arguments[d];return b._on(c,a,g[0])});return this};d.prototype.off=function(c,a){var b=this;this.playerInstance?this._off(c,a,this.playerInstance):this.commands.push(function(){for(var g=[],d=0;d<arguments.length;d++)g[d]=arguments[d];return b._off(c,a,g[0])});return this};d.prototype.ready=function(c){var a=this;this.playerInstance?this._ready(c,this.playerInstance):this.commands.push(function(){for(var b=
[],g=0;g<arguments.length;g++)b[g]=arguments[g];return a._ready(c,b[0])});return this};d.prototype.load=function(){var c=this;this.playerInstance?this._load(this.playerInstance):this.commands.push(function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return c._load(a[0])});return this};d.prototype.readyState=function(){return this.playerInstance?this.playerInstance.readyState():0};d.prototype.aspectRatio=function(c){var a=this;this.playerInstance?this._aspectRatio(c,this.playerInstance):
this.commands.push(function(){for(var b=[],g=0;g<arguments.length;g++)b[g]=arguments[g];return a._aspectRatio(c,b[0])});return this};d.prototype.getCurrent=function(){if(this.playerInstance)return this.playerInstance.getCurrent()};d.prototype.getPosition=function(){return this.playerInstance?this.playerInstance.getPosition():0};d.prototype.isPlaying=function(){return this.playerInstance?this.playerInstance.isPlaying():!1};d.prototype.isPaused=function(){return this.playerInstance?this.playerInstance.isPaused():
!1};d.prototype.getVersion=function(){return this.playerInstance?this.playerInstance.getVersion():""};d.prototype.destroy=function(){var c=this;this.playerInstance?this._destroy(this.playerInstance):this.commands.push(function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return c._destroy(a[0])})};d.prototype.addChild=function(c,a){this.playerInstance&&this.playerInstance.addChild(c,a);return this};d.prototype.removeChild=function(c){this.playerInstance&&this.playerInstance.removeChild(c);
return this};d.prototype.loadNextVideoPoster=function(c){this.playerInstance&&this.playerInstance.loadNextVideoPoster(c);return this};d.prototype.setInitialData=function(c){this.playerInstance&&this.playerInstance.setInitialData(c);return this};d.prototype.updateTextTrack=function(c){this.playerInstance&&this.playerInstance.updateTextTrack(c);return this};d.prototype.removeCurrentTextTracks=function(){this.playerInstance&&this.playerInstance.removeCurrentTextTracks();return this};d.prototype.showPoster=
function(c){this.playerInstance&&this.playerInstance.showPoster(c);return this};d.prototype.blur=function(){this.playerInstance&&this.playerInstance.blur();return this};d.prototype.requestFullscreen=function(){var c=this;this.playerInstance?this._requestFullscreen(this.playerInstance):this.commands.push(function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return c._requestFullscreen(a[0])});return this};d.prototype.exitFullscreen=function(){this.playerInstance&&this.playerInstance.exitFullscreen();
return this};d.prototype.isFullscreen=function(){return this.playerInstance?this.playerInstance.isFullscreen():!1};d.prototype.fluid=function(c){this.playerInstance&&this.playerInstance.fluid(c);return this};d.prototype.enableCurrentTextTrack=function(c){void 0===c&&(c="en");this.playerInstance&&this.playerInstance.enableCurrentTextTrack(c)};d.prototype.disableCurrentTextTrack=function(c){void 0===c&&(c="en");this.playerInstance&&this.playerInstance.disableCurrentTextTrack(c)};d.prototype.isCaptionOn=
function(){return this.playerInstance?this.playerInstance.isCaptionOn():!1};d.prototype.isAutoplayed=function(){return this.playerInstance?this.playerInstance.isAutoplayed():!1};d.prototype.getTitleSessionId=function(){return this.playerInstance?this.playerInstance.getTitleSessionId():""};d.prototype.requestPictureInPicture=function(){var c=this;this.playerInstance?this._requestPictureInPicture(this.playerInstance):this.commands.push(function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];
c._requestPictureInPicture(a[0])});return this};d.prototype.exitPictureInPicture=function(){var c=this;this.playerInstance?this._exitPictureInPicture(this.playerInstance):this.commands.push(function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];c._exitPictureInPicture(a[0])});return this};d.prototype.setPlayerMode=function(c){var a=this;this.playerInstance?this._setPlayerMode(c,this.playerInstance):this.commands.push(function(){for(var b=[],g=0;g<arguments.length;g++)b[g]=arguments[g];
return a._setPlayerMode(c,b[0])});return this};d.prototype._setPlayerMode=function(c,a){a.setPlayerMode(c)};d.prototype._play=function(c,a){c?a.play(c):a.play()};d.prototype._mute=function(c){c.mute()};d.prototype._unmute=function(c){c.unmute()};d.prototype._isMuted=function(c){return c.isMuted()};d.prototype._getCurrentTime=function(c){return c.getCurrentTime()};d.prototype._setCurrentTime=function(c,a){a.setCurrentTime(c)};d.prototype._getMediaDuration=function(c){return c.getMediaDuration()};d.prototype._pause=
function(c,a){a.pause(c)};d.prototype._stop=function(c){c.stop()};d.prototype._requestFullscreen=function(c){c.requestFullscreen()};d.prototype._resume=function(c,a){a.resume(c)};d.prototype._seek=function(c,a){a.seek(c)};d.prototype._on=function(c,a,b){b.on(c,a)};d.prototype._off=function(c,a,b){b.off(c,a)};d.prototype._ready=function(c,a){a.ready(c)};d.prototype._load=function(c){c.load()};d.prototype._destroy=function(c){c.destroy();this.playerInstance=null};d.prototype._aspectRatio=function(c,
a){a.aspectRatio(c)};d.prototype._requestPictureInPicture=function(c){c.requestPictureInPicture()};d.prototype._exitPictureInPicture=function(c){c.exitPictureInPicture()};return d}(),ra=function(){function d(){}d.prototype.create=function(c,a,b){b=b?b:c.initialVideo;a={contentId:""+b.contentId,customerId:c.customerId,isForesterTrackingDisabled:c.sushiMetricsConfig.isRobot,foresterMetadataParams:{client:c.requestMetadata.clientId,marketplaceId:c.requestMetadata.marketplaceId,method:c.requestMetadata.method,
requestId:c.requestMetadata.requestId,session:c.requestMetadata.sessionId},videoUrl:b.videoUrl,posterSource:b.imageUrl,pageAsin:c.requestMetadata.pageAsin,parentId:a,vendorCode:b.vendorCode,videoTitle:b.videoTitle,shouldStartMuted:c.shouldStartMuted||!1,shouldAutoplay:c.shouldAutoplay||!1,shouldPreload:"undefined"===typeof c.shouldPreload?!0:c.shouldPreload,shouldOverrideBackground:c.shouldOverrideBackground||!1,useAutoplayFallback:c.useAutoplayFallback,shouldDisableControls:c.shouldDisableControls||
!1,useCarousel:c.useCarousel,useBuyBox:c.useBuyBox,languagePreferenceStrings:c.languagePreferenceStrings,metricsEmissionMethod:c.metricsEmissionMethod,enableClickBasedAttribution:c.enableClickBasedAttribution,sushiMetricsConfig:{eventSource:c.sushiMetricsConfig.eventSource,endpoint:c.sushiMetricsConfig.endpoint,requestId:c.sushiMetricsConfig.requestId,sessionId:c.sushiMetricsConfig.sessionId,customerId:c.sushiMetricsConfig.customerId,refMarkers:c.sushiMetricsConfig.refMarkers,sessionType:c.sushiMetricsConfig.sessionType,
placementContext:c.sushiMetricsConfig.placementContext,marketplaceId:c.sushiMetricsConfig.marketplaceId,weblabIds:c.sushiMetricsConfig.weblabIds,pageAsin:c.sushiMetricsConfig.pageAsin,isInternal:c.sushiMetricsConfig.isInternal,isRobot:c.sushiMetricsConfig.isRobot,clientId:c.sushiMetricsConfig.clientId,creativeId:c.sushiMetricsConfig.creativeId||""},refTag:c.refTag,ospData:{vendorTrackingId:b.vendorTrackingId,videoReferenceId:b.videoReferenceId,productAsin:b.productAsin},useUpNextComponent:c.useUpNextComponent,
isVideoImmersivePlayer:c.isVideoImmersivePlayer,ospLinkCode:c.ospLinkCode,clientPrefix:c.clientPrefix,languageCode:c.languageCode,isChromelessPlayer:c.isChromelessPlayer,enableDelphiAttribution:c.enableDelphiAttribution,aciContentId:b.aciContentId,mimeType:b.mimeType,isReactFactory:c.isReactFactory,version:c.version,shouldLoop:c.shouldLoop||!1,skipInitialFocus:c.skipInitialFocus||!1,enableInactiveFocus:!1!==c.enableInactiveFocus,closedCaptionsConfig:c.closedCaptionsConfig,alwaysSetInitialVideo:c.alwaysSetInitialVideo,
showPosterImage:c.showPosterImage,volumeSliderTitle:c.volumeSliderTitle,allowCrossOrigin:c.allowCrossOrigin};c.eventTimestamp&&(a.eventTimestamp=c.eventTimestamp);c.nexusMetricsConfig&&(a.nexusMetricsConfig={eventSource:c.nexusMetricsConfig.eventSource,isInternal:c.nexusMetricsConfig.isInternal,playerTSMMetricsSchemaId:c.nexusMetricsConfig.playerTSMMetricsSchemaId,widgetMetricsSchemaId:c.nexusMetricsConfig.widgetMetricsSchemaId,producerId:c.nexusMetricsConfig.producerId,refMarkers:c.nexusMetricsConfig.refMarkers,
placementContext:c.nexusMetricsConfig.placementContext,weblabIds:c.nexusMetricsConfig.weblabIds,pageAsin:c.nexusMetricsConfig.pageAsin,clientId:c.nexusMetricsConfig.clientId,creativeId:c.nexusMetricsConfig.creativeId,videoAsin:c.nexusMetricsConfig.videoAsin,videoAsinList:c.nexusMetricsConfig.videoAsinList});c.clickstreamNexusMetricsConfig&&(a.clickstreamNexusMetricsConfig={actionType:c.clickstreamNexusMetricsConfig.actionType,eventOwner:c.clickstreamNexusMetricsConfig.eventOwner,eventType:c.clickstreamNexusMetricsConfig.eventType,
productId:c.clickstreamNexusMetricsConfig.productId,producerId:c.clickstreamNexusMetricsConfig.producerId,schemaId:c.clickstreamNexusMetricsConfig.schemaId});c.feedbackFactory&&(a.feedbackFactory=c.feedbackFactory,a.reportPageStateName=c.reportPageStateName);c.includeEarnsComissionDisclosure&&(a.includeEarnsComissionDisclosure=c.includeEarnsComissionDisclosure);return a};return d}(),V=function(){function d(c){this.deps=c}d.prototype.create=function(c){var a=this,b=I(),g=new this.deps.promise(function(a,
c){m[b]={resolve:a,reject:c}});v.when("brila").execute("construct-player",function(a){m[b].resolve(a)});var d=document.getElementById(c.containerId),f=c.containerId+"-container";d.innerHTML='\x3cdiv id\x3d"'+f+'" style\x3d"width:100%; height:100%"\x3e\x3c/div\x3e';d=(new this.deps.promise(function(b,d){g.then(function(g){var e=new T(g,(new ra).create(c,f),c.initialVideo,a.deps);e.on("playerLoaded",function(){b(e)})})})).then(function(a){return a});return new S(new U(d,this.deps),document.getElementById(f),
this.deps)};return d}(),L=function(d,c){return c={exports:{}},d(c,c.exports),c.exports}(function(d){function c(){}function a(a,b,c){this.fn=a;this.context=b;this.once=c||!1}function b(){this._events=new c;this._eventsCount=0}var g=Object.prototype.hasOwnProperty,f="~";Object.create&&(c.prototype=Object.create(null),(new c).__proto__||(f=!1));b.prototype.eventNames=function(){var a=[],b,c;if(0===this._eventsCount)return a;for(c in b=this._events)g.call(b,c)&&a.push(f?c.slice(1):c);return Object.getOwnPropertySymbols?
a.concat(Object.getOwnPropertySymbols(b)):a};b.prototype.listeners=function(a,b){a=this._events[f?f+a:a];if(b)return!!a;if(!a)return[];if(a.fn)return[a.fn];b=0;for(var c=a.length,g=Array(c);b<c;b++)g[b]=a[b].fn;return g};b.prototype.emit=function(a,b,c,g,e,d){var q=f?f+a:a;if(!this._events[q])return!1;var q=this._events[q],E=arguments.length,m,l;if(q.fn){q.once&&this.removeListener(a,q.fn,u,!0);switch(E){case 1:return q.fn.call(q.context),!0;case 2:return q.fn.call(q.context,b),!0;case 3:return q.fn.call(q.context,
b,c),!0;case 4:return q.fn.call(q.context,b,c,g),!0;case 5:return q.fn.call(q.context,b,c,g,e),!0;case 6:return q.fn.call(q.context,b,c,g,e,d),!0}l=1;for(m=Array(E-1);l<E;l++)m[l-1]=arguments[l];q.fn.apply(q.context,m)}else{var n=q.length,B;for(l=0;l<n;l++)switch(q[l].once&&this.removeListener(a,q[l].fn,u,!0),E){case 1:q[l].fn.call(q[l].context);break;case 2:q[l].fn.call(q[l].context,b);break;case 3:q[l].fn.call(q[l].context,b,c);break;case 4:q[l].fn.call(q[l].context,b,c,g);break;default:if(!m)for(B=
1,m=Array(E-1);B<E;B++)m[B-1]=arguments[B];q[l].fn.apply(q[l].context,m)}}return!0};b.prototype.on=function(b,c,g){c=new a(c,g||this);b=f?f+b:b;this._events[b]?this._events[b].fn?this._events[b]=[this._events[b],c]:this._events[b].push(c):(this._events[b]=c,this._eventsCount++);return this};b.prototype.once=function(b,c,g){c=new a(c,g||this,!0);b=f?f+b:b;this._events[b]?this._events[b].fn?this._events[b]=[this._events[b],c]:this._events[b].push(c):(this._events[b]=c,this._eventsCount++);return this};
b.prototype.removeListener=function(a,b,g,d){a=f?f+a:a;if(!this._events[a])return this;if(!b)return 0===--this._eventsCount?this._events=new c:delete this._events[a],this;var e=this._events[a];if(e.fn)e.fn!==b||d&&!e.once||g&&e.context!==g||(0===--this._eventsCount?this._events=new c:delete this._events[a]);else{for(var C=0,q=[],l=e.length;C<l;C++)(e[C].fn!==b||d&&!e[C].once||g&&e[C].context!==g)&&q.push(e[C]);q.length?this._events[a]=1===q.length?q[0]:q:0===--this._eventsCount?this._events=new c:
delete this._events[a]}return this};b.prototype.removeAllListeners=function(a){a?(a=f?f+a:a,this._events[a]&&(0===--this._eventsCount?this._events=new c:delete this._events[a])):(this._events=new c,this._eventsCount=0);return this};b.prototype.off=b.prototype.removeListener;b.prototype.addListener=b.prototype.on;b.prototype.setMaxListeners=function(){return this};b.prefixed=f;b.EventEmitter=b;"undefined"!==typeof d&&(d.exports=b)}).EventEmitter,X=u,Y=u;v.when("a-sheet").execute(function(d){X=d});
v.when("a-popover").execute(function(d){Y=d});var Z={getBottomSheet:function(){return X},getPopoverFactory:function(){return Y}},sa=function(){function d(c,a){var b=this;this.config=c;this._showMoreMenuExperience=a;this.activeVideoACI=this.activeVideoSource=this.activeVideo="VIDEO_NOT_SELECTED";this.ivxReportCloseIconClass="ivx-report-close";this.ivxAmazonAppClass="ivx-amazon-app";this.reportCloseIconSelector=".a-sheet-close";this.showMoreMenuExperience=this.registered=!1;this._submitErrorCallback=
function(a){b.A.trigger("vse:"+b.id+":feedback:submitted:error")};this._submitSuccessCallback=function(a){b.A.trigger("vse:"+b.id+":feedback:submitted:success")};this.A=c.A;this.pageStateName=c.pageStateName;this.buttonApi=c.buttonApi;this.id=this.config.id;this.showMoreMenuExperience=this._showMoreMenuExperience;c=x.fetchLatestPageState(this.A,this.pageStateName);this.moreMenuSheet=this.A.$("#"+this.id+"-more-menu");this.feedbackForm=this.A.$("#"+this.id+"-form");this.thankYouSection=this.A.$("#"+
this.id+"-ty-container");this.InfringementNotSupportSection=this.A.$("#"+this.id+"-infringement-container");this.submitButton=this.buttonApi("#"+this.id+"-btn-submit");this.reportIllegalContentLinkSelector=this.A.$(".vse-fb-report-illegal-content");this.feedbackContainerSelector=this.A.$("#"+this.id);c&&this.validateFormElements()&&(this.isMobile=c.isMobile,this.endpoint=c.feedbackEndpoint,this.marketplaceId=c.marketplaceId,this.pageAsin=c.pageAsin,this.customerId=c.customerId,this.slateToken=c.slateToken,
this.bottomSheetFactory=Z.getBottomSheet(),this.popoverFactory=Z.getPopoverFactory(),this.registered||(this.A.declarative(this.id+"-btn-close","click",function(){return b.closeFeedbackForm()}),this.A.declarative(this.id+"-btn-submit","click",function(){return b.submitFeedback()}),this.showMoreMenuExperience&&this.A.declarative(this.id+"-report-btn","click",function(){return b.moreMenuToFeedbackForm()}),this.A.on("a:sheet:afterShow:"+this.id+"-sheet",function(a){b.showFeedbackForm?(b.A.trigger("vse:"+
b.id+":feedback:shown"),b.updateBottomSheetHeight(),b.A.capabilities.isAmazonApp&&b.isMobile&&a.sheet.$container.addClass(b.ivxAmazonAppClass),a.sheet.$contentContainer.siblings(b.reportCloseIconSelector).addClass(b.ivxReportCloseIconClass)):(b.showFeedbackForm(),b.updateBottomSheetHeight())}),this.A.on("a:sheet:afterHide:"+this.id+"-sheet",function(a){b.showMoreMenuExperience?(b.feedbackForm.addClass("aok-hidden").fadeIn(10),b.hideThankYou(),b.hideInfringementNotSupport(),b.resetMoreMenuSheet(),
b.showMoreMenuSheet()):(b.hideThankYou(),b.hideInfringementNotSupport());b.A.capabilities.isAmazonApp&&b.isMobile&&a.sheet.$container.removeClass(b.ivxAmazonAppClass);a.sheet.$contentContainer.siblings(b.reportCloseIconSelector).removeClass(b.ivxReportCloseIconClass);b.A.trigger("vse:"+b.id+":feedback:hidden")}),this.A.on("a:popover:afterShow:"+this.id+"-popover",function(a){b.showFeedbackForm()}),this.A.on("a:popover:afterHide:"+this.id+"-popover",function(a){b.hideFeedbackForm()}),this.registered=
!0))}d.prototype.resetMoreMenuSheet=function(){this.showMoreMenuExperience&&this.updateBottomSheetHeight(1)};d.prototype.moreMenuToFeedbackForm=function(){this.moreMenuSheet.addClass("aok-hidden").fadeOut(10);this.showFeedbackForm();this.updateBottomSheetHeight();return this};d.prototype.showMoreMenuSheet=function(){this.moreMenuSheet.removeClass("aok-hidden").fadeIn(400)};d.prototype.showFeedbackForm=function(c){this.hideThankYou();this.showMoreMenuExperience&&this.feedbackForm.removeClass("aok-hidden").fadeIn(400);
this.A.trigger("vse:"+this.id+":feedback:shown");return this};d.prototype.hideFeedbackForm=function(){this.isMobile?this.getAndSetBottomSheetInstance()&&(this.bottomSheetInstance.hide(),this.resetMoreMenuSheet()):this.getAndSetPopoverInstance()&&this.popoverInstance.hide();this.A.trigger("vse:"+this.id+":feedback:hidden");return this};d.prototype.setActiveVideoAndSource=function(c,a,b){this.activeVideo=c;this.activeVideoSource=a;this.activeVideoACI=b};d.prototype.submitFeedback=function(){var c=this.createLwisRequest();
this.A.$.ajax(c);this.A.trigger("vse:"+this.id+":feedback:submitted");this.showThankYou();this.updateBottomSheetHeight(this.thankYouSection.scrollHeight()+this.getFeedbackFormVerticalPadding())};d.prototype.getFeedbackFormVerticalPadding=function(){var c=parseInt(this.feedbackContainerSelector.css("padding-top"),10),a=parseInt(this.feedbackContainerSelector.css("padding-bottom"),10);return c+a};d.prototype.createLwisPayload=function(){return{videoId:this.activeVideo,customerId:this.customerId,marketplaceId:this.marketplaceId,
slateToken:this.slateToken}};d.prototype.createLwisRequest=function(){return{url:this.endpoint,data:JSON.stringify(this.createLwisPayload()),type:"POST",contentType:"application/json; charset\x3dutf-8",crossDomain:!0,headers:{Authorization:"allow","X-Amzn-Slate-Token":this.slateToken},error:this._submitErrorCallback,success:this._submitSuccessCallback}};d.prototype.closeFeedbackForm=function(){this.hideFeedbackForm();this.A.trigger("vse:"+this.id+":feedback:closed")};d.prototype.updateReportIllegalContentLink=
function(){var c=encodeURIComponent(""+m.location.origin+m.location.pathname);this.reportIllegalContentLinkSelector.attr("href",m.location.origin+"/manage-content/report/illegal?mediaAci\x3d"+this.activeVideoACI+"\x26referer\x3d"+c)};d.prototype.showInfringementNotSupport=function(){this.feedbackForm.fadeOut(200);this.InfringementNotSupportSection.removeClass("aok-hidden").fadeIn(400);this.updateBottomSheetHeight(this.InfringementNotSupportSection.height()+this.getFeedbackFormVerticalPadding());return this};
d.prototype.hideInfringementNotSupport=function(){this.feedbackForm.fadeIn(10);this.InfringementNotSupportSection.addClass("aok-hidden").fadeOut(10);return this};d.prototype.showThankYou=function(){var c=this;this.feedbackForm.fadeOut(200,function(){c.thankYouSection.removeClass("aok-hidden").fadeIn(400);c.A.trigger("vse:"+c.id+":thank-you:shown")});return this};d.prototype.hideThankYou=function(){this.feedbackForm.fadeIn(10);this.thankYouSection.addClass("aok-hidden").fadeOut(10);this.A.trigger("vse:"+
this.id+":thank-you:hidden");return this};d.prototype.validateFormElements=function(){return this.thankYouSection.length&&this.submitButton.size()&&this.feedbackForm.length};d.prototype.getAndSetBottomSheetInstance=function(){return this.bottomSheetFactory?this.bottomSheetInstance?this.bottomSheetInstance:this.bottomSheetInstance=this.bottomSheetFactory.get(this.id+"-sheet"):u};d.prototype.getAndSetPopoverInstance=function(){return this.popoverFactory?this.popoverInstance?this.popoverInstance:this.popoverInstance=
this.popoverFactory.get(this.id+"-popover"):u};d.prototype.updateBottomSheetHeight=function(c){c=c||this.feedbackContainerSelector.outerHeight();this.isMobile&&this.getAndSetBottomSheetInstance()&&this.bottomSheetInstance.changeHeight({height:c,duration:.1})};return d}(),ta=function(){function d(c){this.config=c;this.feedbackWidgets={}}d.prototype.create=function(c,a,b){void 0===b&&(b=!1);a=this.feedbackWidgets[c]||new sa({id:c,pageStateName:a,A:this.config.A,buttonApi:this.config.buttonApi},b);return this.feedbackWidgets[c]=
a};d.prototype.get=function(c){return this.feedbackWidgets[c]};return d}(),n=function(){function d(){}d.POSITIVE_VOTE="positive";d.NEGATIVE_VOTE="negative";d.NONE_VOTE="none";d.VOTE_STATUS="status";d.EMPTY_STRING="";d.DEFAULT_MIN_GUTTER=24;d.DEFAULT_HEIGHT_ANIMATION_SPEED=200;d.CAROUSEL_PREV_BUTTON_CLASS=".a-carousel-goto-prevpage";d.CAROUSEL_NEXT_BUTTON_CLASS=".a-carousel-goto-nextpage";d.VSE_CAROUSEL_PAGINATION_DEACTIVATE_CLASSHIDDEN_CLASS="aok-hidden";d.VSE_CAROUSEL_PAGINATION_DEACTIVATE_CLASS=
"vse-carousel-goto-deactive-btn";d.ANIMATION_SPEED_400=400;d.ANIMATION_SPEED_100=100;d.BOUNCE_CAROUSEL_FACTOR=30;d.BOUNCE_SCROLL_BAR_FACTOR=6;d.SWING="swing";d.FIRST_PAGE="first-page";d.LAST_PAGE="last-page";d.$GROUP_1=".segment-title-G1";d.$GROUP_2=".segment-title-G2";d.$GROUP_3=".segment-title-G3";d.$GROUP_EXPVERNAC=".segment-title-EXPVERNAC";d.NO_GUTTER=0;d.TOLERANT=-.5;d.CURRENT_GUTTER="currentGutter";d.NUMBER_OF_CARDS_TO_LOAD_ADDITIONALLY=1;d.VIP_CAROUSEL_CSS_CLASS="vse-vip-lb-carousel";return d}(),
M=function(){function d(c,a){this.element=c;this.videoVoteConfig=a;this.countsFetched=!1;this.positiveVoteCount=0;this.showPositiveVotes=!1;this.negativeVoteCount=0;this.showNegativeVotes=!1;this.prompt=c.find(".vse-vote-helpful-text");this.positiveVoteText=c.find(".vse-vote-positive");this.positiveVoteIcon=c.find(".vse-vote-positive-icon");this.negativeVoteText=c.find(".vse-vote-negative");this.negativeVoteIcon=c.find(".vse-vote-negative-icon");this.previousVote=n.EMPTY_STRING}d.prototype.getVoteCount=
function(c){return c===n.POSITIVE_VOTE?this.positiveVoteCount:c===n.NEGATIVE_VOTE?this.negativeVoteCount:0};d.prototype.setVoteCount=function(c,a){0>a&&(a=0);c===n.POSITIVE_VOTE?(this.positiveVoteCount=a,this.positiveVoteText.html(String(a))):c===n.NEGATIVE_VOTE&&(this.negativeVoteCount=a,this.negativeVoteText.html(String(a)));this.element.addClass("updated")};d.prototype.getPreviousVote=function(){return this.previousVote};d.prototype.setPreviousVote=function(c){var a=this;if(c===n.POSITIVE_VOTE)this.positiveVoteIcon.addClass("hasvoted"),
this.negativeVoteIcon.removeClass("hasvoted"),0>=this.getVoteCount(n.POSITIVE_VOTE)&&this.setVoteCount(n.POSITIVE_VOTE,1),setTimeout(function(){a.positiveVoteIcon.attr("aria-label","Click to remove your vote. Total vote count: "+a.getVoteCount(n.POSITIVE_VOTE))},100);else if(c===n.NEGATIVE_VOTE)this.negativeVoteIcon.addClass("hasvoted"),this.positiveVoteIcon.removeClass("hasvoted"),0>=this.getVoteCount(n.NEGATIVE_VOTE)&&this.setVoteCount(n.NEGATIVE_VOTE,1);else if(c===n.NONE_VOTE)this.negativeVoteIcon.removeClass("hasvoted"),
this.positiveVoteIcon.removeClass("hasvoted"),setTimeout(function(){a.positiveVoteIcon.attr("aria-label","Click to vote positive. Total vote count: "+a.getVoteCount(n.POSITIVE_VOTE))},100);else return;this.previousVote=c};d.prototype.setContentId=function(c){this.contentId=c};d.prototype.getContentId=function(){return this.contentId};d.prototype.showOrHide=function(c,a,b,g){this.showPositiveVotes=c;this.showNegativeVotes=a;this.showPrompt=b;c?(this.positiveVoteText.addClass("vse-show"),this.positiveVoteIcon.addClass("vse-show")):
(this.positiveVoteText.removeClass("vse-show"),this.positiveVoteIcon.removeClass("vse-show"));a?(this.negativeVoteText.addClass("vse-show"),this.negativeVoteIcon.addClass("vse-show")):(this.negativeVoteText.removeClass("vse-show"),this.negativeVoteIcon.removeClass("vse-show"));b?this.prompt.addClass("vse-show"):this.prompt.removeClass("vse-show");g?this.element.addClass("vse-show"):this.element.removeClass("vse-show")};d.prototype.updateWithNewVote=function(c){if(c===n.POSITIVE_VOTE||c===n.NEGATIVE_VOTE){var a=
c==n.POSITIVE_VOTE?n.NEGATIVE_VOTE:n.POSITIVE_VOTE,b=this.getVoteCount(c),g=this.getVoteCount(a);c===this.getPreviousVote()?(this.setPreviousVote(n.NONE_VOTE),this.setVoteCount(c,b-1)):this.getPreviousVote()!==n.EMPTY_STRING&&this.getPreviousVote()!==n.NONE_VOTE?(this.setVoteCount(a,g-1),this.setVoteCount(c,b+1),this.setPreviousVote(c)):(this.setPreviousVote(c),this.setVoteCount(c,b+1))}};return d}(),ua=function(){return function(d,c,a){this.contentId=d;this.positiveVoteCount=c;this.negativeVoteCount=
a}}(),va=function(){return function(d,c,a){this.contentId=d;this.positiveVoteCount=c;this.voteStatus=a}}(),N=function(){function d(c,a){this.A=c;this.videoVoteConfig=a}d.prototype.createFromContent=function(c,a){c=this.A.$("#"+c).find('[.vse-video-votes][data-contentid\x3d"'+a+'"]');return new M(c,this.videoVoteConfig)};d.prototype.createFromSelector=function(c){var a=this.A.$(""+c);if(!a)throw new G("VideoVoteContainerFactory can not find selector by the name of "+c+".");return new M(a,this.videoVoteConfig)};
d.prototype.sendVoteToRemote=function(c,a,b){var g=this,d=this.getBasicPayload(this.videoVoteConfig),f=this.A.$.extend(d,{contentId:b,positive:c,negative:a});return new this.videoVoteConfig.dependencies.promise(function(a,b){la.sendRequest(g.A,"/vap/ew/subcomponent/votes/writing",f,function(b,c,g){null!==g.http.responseURL&&g.http.responseURL!==u&&g.http.responseURL.includes("signin")&&(c=g.http.responseURL,g=encodeURIComponent(m.location.href),c=c.replace(/return_to=.*?&/,"return_to\x3d"+g+"\x26"),
m.location.href=c);a(b)},function(a){l.count("vse:votecast:failed",1);b(a)})})};d.prototype.fetchVoteCountAndStatus=function(c){var a=this,b=this.getVoteCountAndStatusBasicPayload(this.videoVoteConfig),g=this.A.$.extend(b,{contentId:c});return new this.videoVoteConfig.dependencies.promise(function(b,c){y.sendRequest(a.A,"/vap/ew/subcomponent/votes/countandstatus",g,function(g){g=a.convertPayloadToVoteCountAndStatusData(g);null!=g&&b(g);c(g)},function(a){l.count("vse:votegetcountsandstatus:failed",
1);c(a)})})};d.prototype.fetchVoteHistory=function(c){var a=this,b=this.getBasicPayload(this.videoVoteConfig),g=this.A.$.extend(b,{contentId:c});return new this.videoVoteConfig.dependencies.promise(function(b,c){y.sendRequest(a.A,"/vap/ew/subcomponent/votes/status",g,function(a){b(a)},function(a){l.count("vse:votehistory:failed",1);c(a)})})};d.prototype.convertPayloadToVoteData=function(c){var a=[],b;for(b in c)c.hasOwnProperty(b)&&a.push(new ua(b,c[b].positive,c[b].negative));return a};d.prototype.convertPayloadToVoteCountAndStatusData=
function(c){var a=null;if(null===c||0===Object.keys(c).length)return null;var b=Object.keys(c)[0];c.hasOwnProperty(b)&&(a=new va(b,c[b].positive,c[b].status));return a};d.prototype.fetchVoteCounts=function(c){var a=this,b=this.getBasicPayload(this.videoVoteConfig),g=this.A.$.extend(b,{contentIds:c});return new this.videoVoteConfig.dependencies.promise(function(b,c){y.sendRequest(a.A,"/vap/ew/subcomponent/votes",g,function(g){g=a.convertPayloadToVoteData(g);0<g.length&&b(g);c(g)},function(a){l.count("vse:votegetcounts:failed",
1);c(a)})})};d.prototype.getBasicPayload=function(c){return{placement:c.placementContext,requestId:c.requestId,sessionId:c.sessionId,page:c.page,bypassLogin:c.forceTreatment||!1}};d.prototype.getVoteCountAndStatusBasicPayload=function(c){return{placement:c.placementContext,page:c.page}};return d}(),aa=function(){function d(c){this.config=c;this.additionalPaddingTop=0;this.$stickies=null;this.$container=this.config.A.$(this.config.stickyHeaderContainer);this.$lbContainer=this.config.A.$(this.config.stickyHeaderLBContainer);
this.lbModalContainer=this.config.lbModalContainer;this.gutter=this.$container.offset().top;this.topPosition=this.$container.offset().top-this.$lbContainer.closest(this.lbModalContainer).offset().top}d.prototype.load=function(c){if("object"===typeof c&&0<c.length){var a=this;this.$stickies=c.each(function(b){b=a.config.A.$(this).parents(".vse-follow-wrap").length?a.config.A.$(this):a.config.A.$(this).wrap('\x3cdiv class\x3d"vse-follow-wrap" /\x3e');if(!a.config.A.objectIsEmpty(a.$lbContainer.data("css-class"))){var c=
-1!==a.$lbContainer.data("css-class").indexOf("vse-lb-v2");a.additionalPaddingTop=c?parseInt(b.css("padding-top")):0}b.data("originalPosition",b.offset().top+a.$container.scrollTop()-a.gutter-a.additionalPaddingTop).data("originalHeight",b.outerHeight()).parent().height(b.outerHeight(!0))});this.$container.unbind("scroll");this.$container.bind("scroll",function(){a._whenScrolling()});this.$container.scroll()}};d.prototype.recalculateStickyHeaderPositions=function(c,a,b){var g=this;void 0===c&&(c=
0);void 0===a&&(a=0);void 0===b&&(b=0);this.$stickies&&this.$stickies.each(function(d,f){f=g.config.A.$(f);d>=c&&f.data("originalPosition",f.data("originalPosition")+a-b)})};d.prototype._whenScrolling=function(){var c=this;this.$stickies.each(function(a){a=c.config.A.$(this);var b=a.data("originalPosition"),g=c.$container.scrollTop();b<=g?a.addClass("vse-absolute").css({top:g}):a.removeClass("vse-absolute").removeAttr("style")})};return d}(),wa=function(){return function(d){var c=this;this.config=
d;this.getTabs=function(){return c.tabs};this.updateSegmentTabForVideo=function(a){c.config.A.$(""+c.segmentTabCssClassSelectorName).removeClass("vse-tab-active vse-tab-no-border");for(var b=0;b<c.tabs.length&&a>=c.tabs[b].startIndex;++b);c.config.A.$(c.segmentTabCssClassSelectorName+".tab-"+(0<b?b-1:0)).addClass("vse-tab-active vse-tab-with-border")};this.updateSegmentTabOnClick=function(a){c.config.A.$(""+c.segmentTabCssClassSelectorName).removeClass("vse-tab-with-border").addClass("vse-tab-no-border");
c.config.A.$(c.segmentTabCssClassSelectorName+"."+a.cssClassName).addClass("vse-tab-with-border")};this.tabs=d.segmentTabs||[];this.segmentTabCssClassSelectorName=this.config.segmentTabCssClassSelectorName}}(),xa=function(){function d(c,a,b,g,d,f){var h=this;this.carouselFramework=a;this.carouselConstants=b;this.A=g;this.contentCarouselConfig=d;this.deps=f;this.vseAssets=[];this.vseAssetIndex={};this.voteContainerIndex={};this.carouselPageSize=this.carouselTotalPages=0;this.carouselPageNumber=1;this.totalVideosLoaded=
{};this.showSeeMoreButton=!1;this.loadImagesManually=function(a,b){for(var c=a.getAttr(h.carouselConstants.PAGE_SIZE),g=b=(b-1)*c+1;g<b+c+n.NUMBER_OF_CARDS_TO_LOAD_ADDITIONALLY;g++){var e=h.A.$(a.dom.$container.find(".vse-video-card:nth-child("+g+")"));e.addClass("vse-img-manually-loaded");h.A.loadDescendantImagesManually(e)}};this.getplaylist=function(){return h.vseAssets.slice()};this.getActiveAsset=function(){return h.activeAsset};this.scrollTo=function(){if(h.contentCarouselConfig.hasStickyHeaders){var a=
h.A.$("#"+h.contentCarouselConfig.carouselName).closest(".vse-lb-right"),b=0;0===h.activeCard.find(".vse-vc-header.first-item").length&&(b=h.A.$(".vse-follow-wrap").first().height()-2);a&&a.animate({scrollTop:h.activeCard.offset().top-a.offset().top+a.scrollTop()-b})}else h.A.$("#"+h.contentCarouselConfig.carouselName).animate({scrollTop:h.activeCard.offset().top-h.A.$("#"+h.contentCarouselConfig.carouselName).offset().top+h.A.$("#"+h.contentCarouselConfig.carouselName).scrollTop()})};this.rotateTo=
function(a){h.useMultiCarousel?h.rotateToMultiCarousel(a):(h.markPlaying(a),h.contentCarouselConfig.isVerticalScroll&&h.scrollTo(),0!==h.carouselPageSize&&(a=h.findIndex(a),-1!==a&&(a=Math.floor(a/h.carouselPageSize)+1,h.carouselPageNumber!=a&&("none"==h.auiCarousel.getAttr("transitionStrategy")?h.animateCarousel(a-1):h.auiCarousel.gotoPage(a)))))};this.rotateToMultiCarousel=function(a){h.markPlaying(a);0===h.carouselPageSize&&(h.carouselPageSize=1);a=h.findIndex(a);-1!==a&&(a=(a+1<h.vseAssets.length?
a+1:a)+1,h.carouselPageNumber!=a&&("none"==h.auiCarousel.getAttr("transitionStrategy")?h.animateCarousel(a-1):h.auiCarousel.gotoPage(a)))};this.markPlaying=function(a){h.activeAsset=a;h.activeCard.removeClass("active");h.vseAssetIndex[a.contentId]&&(h.activeCard=h.vseAssetIndex[a.contentId].$el.closest("li").addClass("active"))};this.findIndex=function(a){return h.vseAssets.indexOf(h.vseAssetIndex[a.contentId])};this.emitRefTag=function(a,b,c){0<h.listOffset&&(a=(a-h.listOffset+h.vseAssets.length)%
h.vseAssets.length);h.refTagRecorder.emitRefTag(b+a+c)};this.destroy=function(){h.A.$("#"+h.contentCarouselConfig.carouselName+" .a-carousel-card.active").removeClass("active")};this.updateVotingElements=function(a,b){h.A.each(a,function(a){var c=h.vseAssetIndex[a.contentId].videoVoteContainer;c.setVoteCount(n.POSITIVE_VOTE,a.positiveVoteCount);c.setVoteCount(n.NEGATIVE_VOTE,a.negativeVoteCount);c.countsFetched=!0;c.showOrHide(b,b,!1,b)})};this.updateVotingElementsForCountAndStatus=function(a,b){var c=
h.vseAssetIndex[a.contentId].videoVoteContainer;c.setVoteCount(n.POSITIVE_VOTE,a.positiveVoteCount);c.countsFetched=!0;c.setPreviousVote(1===a.voteStatus?n.POSITIVE_VOTE:n.NONE_VOTE);c.showOrHide(b,b,!1,b)};this.attachStickyHeader=function(a){h.stickyHeaders=new aa(a);h.stickyHeaders.load(h.A.$(a.stickyHeaderContainer+" .vse-vc-header.first-item"))};this.initializeSegmentTabs=function(a){h.segmentTabsModule=new wa(a);h.segmentTabs=h.segmentTabsModule.getTabs();h.attachTabClickHandlers();h.attachTabChangeHandlerOnCarouselScroll();
h.showCreatorProfiles(".vse-video-customer-profile",".vse-video-labels")};this.showCreatorProfiles=function(a,b){var c="#"+h.contentCarouselConfig.carouselName+"."+n.VIP_CAROUSEL_CSS_CLASS+" .vse-video-card";h.A.$(c).each(function(c,g){c=h.A.$(g).find(a);var e=h.A.$(g).find(b);0<c.length&&0<e.length&&(e.html(c.removeClass("vse-hidden aok-hidden").detach().get(0).outerHTML),h.A.$(g).addClass("vse-video-card-has-profile"))});h.A.$(c+" .vse-profile").click(function(a){h.disableCreatorClicksOnMshop&&
a.preventDefault();a.stopPropagation();a.stopImmediatePropagation()})};this.attachTabClickHandlers=function(){h.segmentTabs.forEach(function(a){var b=h.A.$(h.segmentTabsModule.segmentTabCssClassSelectorName+"."+a.cssClassName);b.click(function(){h.animateCarousel(a.startIndex);b.hasClass("vse-tab-active")||h.segmentTabsModule.updateSegmentTabOnClick(a)})})};this.attachTabChangeHandlerOnCarouselScroll=function(){h.A.$("#"+h.contentCarouselConfig.carouselName+"."+n.VIP_CAROUSEL_CSS_CLASS+" .a-carousel-viewport").scroll(function(){h.A.$("#"+
h.contentCarouselConfig.carouselName+"."+n.VIP_CAROUSEL_CSS_CLASS+" .vse-video-card").each(function(a,b){h.orientationConfig.getCardInViewOffset(h.A.$(b))<=h.orientationConfig.getOffsetPointForTabUpdate()&&h.segmentTabsModule.updateSegmentTabForVideo(a)})})};this.animateCarousel=function(a){h.A.objectIsEmpty(h.orientationConfig)||(a*=h.orientationConfig.animatedCarouselDimensionValue(),h.useMultiCarousel&&h.resizeCarousel(a),h.auiCarousel.dom.$viewport.animate(h.orientationConfig.getCarouselPropertyToAnimate(a),
500))};this.resizeCarousel=function(a){var b=h.auiCarousel.dom.$viewport[0].scrollWidth-h.auiCarousel.dom.$viewport[0].clientWidth;if(b<a){var c=h.auiCarousel.dom.$carousel.css("width").slice(0,-2);h.auiCarousel.dom.$carousel.css("width",parseInt(c)+(a-b)+"px")}};this.scrollToActiveVideo=function(a){a=h.findIndex(a);h.animateCarousel(a)};this.updateSegmentTabForActiveVideo=function(a){a=h.findIndex(a);h.segmentTabsModule.updateSegmentTabForVideo(a)};this.setOrientationConfig=function(a){h.orientationConfig=
a};this.getAssetSpec=function(a,b,c,g){var e=a.data(),d=a.find(".vse-video-image").data("img"),d=d.replace("SR160,90_BG0,0,0_PKvse-overlay-play2","").replace("SR320,180_BG0,0,0_PKvse-overlay-play2",""),f=[];if(e.closedCaptions)for(var J=e.closedCaptions.split(","),k=0;k<J.length-1;k+=2)f.push({locale:J[k],url:J[k+1]});a={index:b,contentId:a.attr("data-asin"),title:e.title,vendorName:e.vendorName,vendorCode:e.vendorCode,entityId:e.entityId,entityType:e.entityType,referenceUrl:e.referenceUrl,referenceLinkTitle:e.referenceTitle,
videoUrl:e.videoUrl,$el:a,duration:e.duration,imageUrl:d,sponsored:e.sponsored,videoVoteContainer:h.voteContainerIndex[e.asin],productAsin:e.productAsin,refTag:c+b+g,continuousPlayRefTag:c+b+g+"_auto_play",relatedProducts:e.relatedProducts,vendorTrackingId:e.vendorTrackingId,videoReferenceId:e.videoRefId,groupType:e.groupType,impressionRecorded:!1,closedCaptions:f,creatorType:e.creatorType,videoAge:e.videoAge,rankingStrategy:e.rankingStrategy,aciContentId:e.aciContentId,mimeType:e.mimeType,isSponsoredBrandVideo:!1,
sponsoredBrandVideoMetadata:{},showHotspots:e.showHotspots,labelDetails:{}};h.isUndefinedOrEmpty(e.adFeedbackUrl)||h.isUndefinedOrEmpty(e.clickTrackerUrl)||h.isUndefinedOrEmpty(e.instrumentationPixelUrl)||h.isUndefinedOrEmpty(e.trackingPixelUrl)||(a.sponsoredBrandVideoMetadata={adFeedbackUrl:e.adFeedbackUrl,clickTrackerUrl:e.clickTrackerUrl,instrumentationPixelUrl:e.instrumentationPixelUrl,trackingPixelUrl:e.trackingPixelUrl,linkUrl:e.linkUrl},a.isSponsoredBrandVideo=!0);h.isUndefinedOrEmpty(e.labelName)||
h.isUndefinedOrEmpty(e.labelType)||h.isUndefinedOrEmpty(e.labelWeblabName)||(a.labelDetails={labelName:e.labelName,labelType:e.labelType,labelWeblabName:e.labelWeblabName,showLabel:e.showLabel,tooltipSelector:e.labelTooltipSelector});return a};this.isUndefinedOrEmpty=function(a){return h.A.objectIsEmpty(a)||""===a};this.displayOrHideCarouselButtons=function(a){var b=a.getAttr(h.carouselConstants.PAGE_NUMBER),c=a.getAttr(h.carouselConstants.TOTAL_PAGES),e=a.dom.$container.find(n.CAROUSEL_PREV_BUTTON_CLASS);
a=a.dom.$container.find(n.CAROUSEL_NEXT_BUTTON_CLASS);e.toggleClass(n.VSE_CAROUSEL_PAGINATION_DEACTIVATE_CLASS,1===b||1===c);a.toggleClass(n.VSE_CAROUSEL_PAGINATION_DEACTIVATE_CLASS,b===c||1===c)};this.removeActive=function(){h.activeAsset=u;h.activeCard.removeClass("active")};var p=g.$;this.activeCard=p([]);var t=this;this.auiCarousel=c;this.refTagRecorder=new K(g);this.showSeeMoreButton=d.seeMoreFunctionality.showSeeMoreButton;this.useMultiCarousel=d.useMultiCarousel;this.disableCreatorClicksOnMshop=
d.disableCreatorClicksOnMshop;p("#"+d.carouselName).find(".a-carousel-heading").after(p("#"+d.carouselName).find(".vse-upload-link").removeClass("aok-hidden"));p("#"+d.carouselName+" .vse-video-item").each(function(a){a=t.getAssetSpec(p(this),a,t.contentCarouselConfig.refTagPrefix,t.contentCarouselConfig.celQueryStringParam);t.vseAssets.push(a);t.vseAssetIndex[a.contentId]=a});d.showVideoVotes&&d.videoVoteConfig&&(this.videoVoteContainerFactory=new N(g,d.videoVoteConfig),g.each(this.vseAssetIndex,
function(a){h.voteContainerIndex[a.contentId]=h.videoVoteContainerFactory.createFromContent(h.contentCarouselConfig.carouselName,a.contentId);a.videoVoteContainer=h.voteContainerIndex[a.contentId]}));p("#"+d.carouselName+" .vse-video-card").find(n.$GROUP_1).first().addClass("first-item");p("#"+d.carouselName+" .vse-video-card").find(n.$GROUP_2).first().addClass("first-item");p("#"+d.carouselName+" .vse-video-card").find(n.$GROUP_3).first().addClass("first-item");p("#"+d.carouselName+" .vse-video-card").find(n.$GROUP_EXPVERNAC).first().addClass("first-item");
(c=d.useMShopVDPFallback&&g.capabilities.isAmazonApp&&g.capabilities.android&&0===g.capabilities.androidVersion.indexOf("8"))||p("#"+d.carouselName).delegate(".a-carousel-card a","click",function(a){if(!(0<p(this).closest(".vse-sm-expander").length))if(p(this).closest("li").hasClass("active"))a.preventDefault();else{var b=t.vseAssetIndex[p(this).closest("li").find(".vse-video-item").data("asin")];t.markPlaying(b);b.eventTimestamp=Date.now();g.trigger("vse:contentCarousel:"+d.carouselName+":click",
b);b=t.findIndex(b);t.emitRefTag(b,t.contentCarouselConfig.refTagPrefix,t.contentCarouselConfig.celQueryStringParam);d.isPreventDefault&&a.preventDefault()}});var e=c?t.contentCarouselConfig.refTagPrefix+"_mshop_fallback":t.contentCarouselConfig.refTagPrefix;p("#"+d.carouselName+" .vse-carousel-item").each(function(a){var b=p(this);b.attr("href",b.data("redirect-url")+"?ref\x3d"+e+a+t.contentCarouselConfig.celQueryStringParam)});g.off("a:carousel:"+d.carouselName+":change:pageSize");g.off("a:carousel:"+
d.carouselName+":change:pageNumber");g.on("a:carousel:"+d.carouselName+":change:pageSize",function(){h.carouselPageSize=h.auiCarousel.getAttr("pageSize");h.activeAsset&&h.rotateTo(h.activeAsset)});g.trigger("a:carousel:"+d.carouselName+":change:pageSize");g.on("a:carousel:"+d.carouselName+":change:pageNumber",function(a){a.carousel.getAttr("totalPages");h.carouselPageNumber=h.auiCarousel.getAttr("pageNumber");g.trigger("a:carousel:"+d.carouselName+":scrollCarousel",h.carouselPageNumber,h.carouselPageSize)});
g.trigger("a:carousel:"+d.carouselName+":updatePageIndex",this.carouselPageNumber,this.carouselPageSize);g.declarative(d.carouselName+"-sm-link","click touch",function(a){p("#"+d.carouselName+" .vse-video-item .vse-carousel-item").first().click()});d.showCreatorProfiles&&this.showCreatorProfiles(".vse-creator-profile",".vse-thumbn-cp-placeholder");this.showSeeMoreButton&&this.initializeTotalVideosLoaded();g.declarative(this.contentCarouselConfig.carouselName+"-seeMoreRelatedVideosButtonClick","click touch",
function(a){h.handleSeeMoreClick(a)});this.carouselFramework.onInit(""+this.contentCarouselConfig.carouselName,function(a){h.contentCarouselConfig.useCustomButtons&&(g.declarative.create(g.$("#"+d.carouselName),h.contentCarouselConfig.carouselName+"-declarative",{}),g.declarative(h.contentCarouselConfig.carouselName+"-declarative","mouseenter touchstart focus",function(){1!==a.getAttr(h.carouselConstants.TOTAL_PAGES)&&(g.$("#"+d.carouselName).addClass("vse-carousel-show-btn"),g.$("#"+d.carouselName+
" .vse-carousel-button").stop(!0,!0).fadeIn({duration:300,queue:!1}))}),g.declarative(h.contentCarouselConfig.carouselName+"-declarative","mouseleave",function(){1!==a.getAttr(h.carouselConstants.TOTAL_PAGES)&&(g.$("#"+d.carouselName).removeClass("vse-carousel-show-btn"),g.$("#"+d.carouselName+" .vse-carousel-button").stop(!0,!0).fadeOut({duration:300,queue:!1}))}),h.displayOrHideCarouselButtons(a));h.contentCarouselConfig.loadImagesManually&&h.loadImagesManually(a,1);g.on("a:carousel:"+h.contentCarouselConfig.carouselName+
":change:pageNumber",function(a){h.contentCarouselConfig.loadImagesManually&&(h.displayOrHideCarouselButtons(a.carousel),h.loadImagesManually(a.carousel,a.newValue))});g.on("a:carousel:"+h.contentCarouselConfig.carouselName+":change:pageSize",function(a){h.contentCarouselConfig.loadImagesManually&&(h.displayOrHideCarouselButtons(a.carousel),h.loadImagesManually(a.carousel,a.newValue))});h.useMultiCarousel&&h.activeAsset&&h.rotateToMultiCarousel(h.activeAsset)})}d.prototype.changeStartingCardTo=function(c){var a=
this;this.listOffset=this.findIndex(c);var b=this;this.A.$("#"+this.contentCarouselConfig.carouselName+" .vse-carousel-item").each(function(a){var c=b.A.$(this);a=(a-b.listOffset+b.vseAssets.length)%b.vseAssets.length;c.attr("href",c.data("redirect-url")+"?ref\x3d"+b.contentCarouselConfig.refTagPrefix+a)});this.contentCarouselConfig.isVerticalScroll||(this.carouselFramework.initializeAll(),this.carouselFramework.onInit(""+this.contentCarouselConfig.carouselName,function(){a.rotateTo(c)}))};d.prototype.initializeTotalVideosLoaded=
function(){for(var c=this.contentCarouselConfig.seeMoreFunctionality.segmentTypeToCountMap,a=0,b=Object.keys(c);a<b.length;a++){var g=b[a];this.totalVideosLoaded[g]=Math.min(this.contentCarouselConfig.seeMoreFunctionality.initialVisibleVideoCount,c[g])}};d.prototype.handleSeeMoreClick=function(c){c=c.$currentTarget.get()[0];c=this.A.$(c).find("[data-segment-id]").attr("data-segment-id");this.loadMoreVideos(c)};d.prototype.loadMoreVideos=function(c){for(var a=this.A.$("#"+this.contentCarouselConfig.carouselName+
" #vse-sm-link-"+c),b=a.closest(".vse-video-card").outerHeight(!0),g=this.contentCarouselConfig.seeMoreFunctionality.newVisibleVideoCount,d=this.contentCarouselConfig.seeMoreFunctionality.segmentTypeToCountMap[c],f=this.getTotalVideosLoadedForSegment(c),g=Math.min(f+g,d),h=f;h<g;h++){var p=this.A.$("#"+this.contentCarouselConfig.carouselName+" #vse-video-element-"+c+"-"+h);p.closest("div.vse-hidden.vse-show-more").removeClass("vse-hidden vse-show-more");p.closest("li.vse-sm-no-padding").removeClass("vse-sm-no-padding")}this.setTotalVideosLoadedForSegment(c,
g);g>=d&&a.addClass("vse-hidden vse-show-more");a=this.getSeeMoreIndex(c);c=this.A.$("#"+this.contentCarouselConfig.carouselName+" #vse-video-element-"+c+"-"+(f-1)).closest(".vse-video-card").outerHeight(!0);this.stickyHeaders.recalculateStickyHeaderPositions(a,(g-f)*c,g>=d?b:0)};d.prototype.getSeeMoreIndex=function(c){c=c.replace(/.*_G(.)/,"$1");return parseInt(c)};d.prototype.getTotalVideosLoadedForSegment=function(c){return this.totalVideosLoaded[c]||0};d.prototype.setTotalVideosLoadedForSegment=
function(c,a){this.totalVideosLoaded[c]=a};d.prototype.resetVideosStateOnLightboxReopen=function(){var c=this;if(this.showSeeMoreButton){var a=this.A.$("#"+this.contentCarouselConfig.carouselName+" li.vse-video-card"),b=this.contentCarouselConfig.seeMoreFunctionality.segmentTypeToCountMap,g=0;a.each(function(a,d){a=c.getSegmentTypeFromElement(c.A.$(d));var f=b[a];g<Math.min(f,c.contentCarouselConfig.seeMoreFunctionality.initialVisibleVideoCount)?c.setTotalVideosLoadedForSegment(a,g+1):g<f&&(c.A.$(d).addClass("vse-sm-no-padding"),
c.A.$(d).children(".vse-video-item").addClass("vse-hidden vse-show-more"));g+=1;g==f&&(g>c.contentCarouselConfig.seeMoreFunctionality.initialVisibleVideoCount&&c.A.$(d).find("#vse-sm-link-"+a).removeClass("vse-hidden vse-show-more"),g=0)})}};d.prototype.getSegmentTypeFromElement=function(c){return(c=c.find(".vse-vc-header").attr("class").match(/segment-title-(.+)/))&&c[1]?c[1].split(" ")[0]:n.EMPTY_STRING};return d}(),O=function(){function d(c,a,b,g){this.carouselFramework=c;this.carouselConstants=
a;this.A=b;this.deps=g}d.prototype.create=function(c){var a=this.carouselFramework.getCarousel(this.A.$("#"+c.carouselName));if(!a)throw new G("Carousel framework can not find carousel by the name of "+c.carouselName+".");return new xa(a,this.carouselFramework,this.carouselConstants,this.A,c,this.deps)};return d}(),ba=function(){function d(c,a){var b=this;this.A=c;this.constants=a;this.repaint=function(a){var c=a.getDimensions().viewport.width,d=a.dom.$carousel.children("li").get(0).getBoundingClientRect(),
d=d.width?d.width:d.right-d.left,f=b.updateVisibleItems(a,c,d);b.updateCarouselDimensions(a,c,d);a.gotoIndex(f,{animationDuration:0,ignorePause:!0});a.triggerEvent("repaint")};this.resize=function(a,c){c.viewport&&c.viewport.width!==u&&b.repaint(a)};this.init=function(a){var c=a.getAttr(b.constants.FIRST_VISIBLE_ITEM);a.setAttr(b.constants.MIN_GUTTER,n.NO_GUTTER);a.setAttr(n.CURRENT_GUTTER,n.NO_GUTTER);b.repaint(a);1<c&&(c=Math.ceil(c/a.getAttr(b.constants.PAGE_SIZE)),a.gotoPage(c));b.bindAttrChangeHandlers(a)}}
d.prototype.determinePageSize=function(c,a,b){c=0;if(0<b)for(;a>n.TOLERANT;)c++,a-=b;0>a&&c--;return this.A.isFiniteNumber(c)&&0<c?c:1};d.prototype.bindAttrChangeHandlers=function(c){var a=this;c.onChange(this.constants.PAGE_NUMBER,function(){c.getAttr(a.constants.HIDE_OFF_SCREEN)&&c.dom.$carousel.children("li").css("visibility","")});c.onChange(this.constants.ANIMATING,function(b){if(!b&&c.getAttr(a.constants.HIDE_OFF_SCREEN)){var g=c.getAttr(a.constants.FIRST_VISIBLE_ITEM)-1,d=g+c.getAttr(a.constants.PAGE_SIZE)-
1;c.dom.$carousel.children("li").each(function(b,c){b=b>=g&&b<=d;a.A.$(c).css("visibility",b?"":"hidden")})}})};d.prototype.updateCarouselDimensions=function(c,a,b){var g;g=c.dom.$carousel;var d=g.children("li");a=d.length;var f=d.first().outerWidth(!0),d=d.eq(1).outerWidth(!0),f=(a-1)*d+f;g.css("width",f+"px");f={carousel:{width:f,outerWidth:g.outerWidth()},items:[]};for(g=0;g<a;g++)f.items.push({width:b,outerWidth:d});c.updateDimensionsCache(f)};d.prototype.updateVisibleItems=function(c,a,b){var d=
c.getAttr(this.constants.TOTAL_PAGES),f=c.getAttr(this.constants.PAGE_NUMBER),k=c.getAttr(this.constants.HIDE_OFF_SCREEN),h=c.dom.$carousel.children("li"),p=c.getAttr(this.constants.FIRST_VISIBLE_ITEM);a=this.determinePageSize(c,a,b);var t=(f-1)*a+1;c.setAttr(this.constants.PAGE_SIZE,a);f>d?(p=(d-1)*a+1,c.setAttr(this.constants.PAGE_NUMBER,d),c.setAttr(this.constants.FIRST_VISIBLE_ITEM,p)):p!==t&&(d=Math.ceil(p/a),p=(d-1)*a+1,c.setAttr(this.constants.PAGE_NUMBER,d),c.setAttr(this.constants.FIRST_VISIBLE_ITEM,
p));var e=p-1,l=e+a-1;h.each(function(a,c){c.style.visibility=!k||a>=e&&a<=l+n.NUMBER_OF_CARDS_TO_LOAD_ADDITIONALLY?"":"hidden";c.style.width=b+"px"});return p};return d}(),ca=function(){function d(c,a,b){var d=this;this.A=c;this.constants=a;this.slideTransition=b;this.carouselLeft=0;this.token=!1;this.init=function(a){d.$scrollBar=a.dom.$container.find(".vse-carousel-scrollbar-thumb");d.carouselLeft=-1*parseInt(a.dom.$carousel.css("left"),10);d.slideTransition.init(a)};this.gotoNextPage=function(a,
b){return d.slideTransition.gotoNextPage(a,b)};this.gotoPrevPage=function(a,b){return d.slideTransition.gotoPrevPage(a,b)};this.gotoPage=function(a,b,c){if(!d.locked()){d.lock();var f=b,t=a.getAttr(d.constants.TOTAL_PAGES),e=a.getAttr(d.constants.PAGE_SIZE),l=a.getAttr(d.constants.SET_SIZE);0<b&&b<=t&&a.setAttr(d.constants.PAGE_NUMBER,b);1>b?b=1:b>t&&(b=t);var q=e*(b-1)+1;b===t&&(q=Math.min(q,l-e+1));1>f||f>t?(d.bounce(a.dom.$carousel,n.BOUNCE_CAROUSEL_FACTOR*(1>f?1:-1)),d.bounce(d.$scrollBar,1*n.BOUNCE_SCROLL_BAR_FACTOR)):
d.gotoIndex(a,q,c)}};this.gotoIndex=function(a,b,c){var f=a.getDimensions();c=f.carousel.outerWidth;var f=f.viewport.outerWidth,t=c-f;b=Math.max(Math.min(a.getItemOffset(b),t),0);c=f/c;f=Math.min(c*f,f);d.$scrollBar=a.dom.$container.find(".vse-carousel-scrollbar-thumb");d.$scrollBar.width(f);d.$scrollBar.animate({left:c*b},n.ANIMATION_SPEED_400,n.SWING);a.dom.$carousel.animate({left:-b},n.ANIMATION_SPEED_400,n.SWING,function(){d.carouselLeft=a.dom.$carousel.css("left");d.unlock()})};this.lock=function(){d.token=
!0};this.unlock=function(){d.token=!1};this.locked=function(){return d.token};this.vseTransitionStrategy=c.copy(b);this.vseTransitionStrategy.init=function(a){return d.init(a)};this.vseTransitionStrategy.gotoPage=function(a,b,c){return d.gotoPage(a,b,c)};this.vseTransitionStrategy.gotoIndex=function(a,b,c){return d.gotoIndex(a,b,c)}}d.prototype.get=function(){return this.vseTransitionStrategy};d.prototype.bounce=function(c,a){var b=this;c.each(function(c,d){var f=b.A.$(d);f.animate({marginLeft:a},
n.ANIMATION_SPEED_400,n.SWING,function(){f.animate({marginLeft:0},n.ANIMATION_SPEED_100,n.SWING,b.unlock)})})};return d}(),r=function(){function d(){}d.IVE_CSS_CLASS_PREFIX="ive-";d.ATTRIBUTION_NAME="ive-inline-player";d.PLAYER_WRAPPER_SELECTOR=".ive-video-player-wrapper";d.LB_PLAYER_PLACEHOLDER_SELECTOR=".ive-inline-lb-player-placeholder";d.CLOSE_BUTTON_SELECTOR=".ive-inline-player-close-button";d.AUDIO_TOGGLE_BUTTON_SELECTOR=".ive-inline-player-audio-toggle";d.PLAY_TOGGLE_BUTTON_SELECTOR=".ive-inline-player-play-toggle";
d.EXPAND_BUTTON_SELECTOR=".ive-inline-player-expand";d.OSP_LINK_SELECTOR=".ive-inline-player-osp-link";d.REMAINING_TIME_SELECTOR=".ive-inline-player-remaining-time";d.PLAYER_CONTAINER_SELECTOR=".vse-player-container";d.MUTE_CSS_CLASS="ive-inline-player-mute";d.UNMUTE_CSS_CLASS="ive-inline-player-unmute";d.PLAY_CSS_CLASS="play";d.REPLAY_CSS_CLASS="replay";d.PAUSE_CSS_CLASS="pause";d.INLINE_PLAYER_MODE="inline";d.IVX_PLAYER_MODE="ivx";d.LB_PLAYER_MODE="lb";d.INLINE_PLAYER_EXPAND_BUTTON_CLICK="inline:expand:click";
d.INLINE_PLAYER_CLOSE_BUTTON_CLICK="inline:close:click";d.MUTED_AUDIO_PREF="muted";d.UNMUTED_AUDIO_PREF="unmuted";return d}(),da=function(){return function(d,c,a){var b=this;this.openLightbox=function(a,c,d,f){var p=b.vars.sharedUtils.getModalFactory();b.vars.callback=f;(f=p&&p.get(b.vars.A.$("#"+b.vars.popoverTriggerId)))?(b.vars.$ingressPlaceholder=a,b.vars.clickedVideo&&(b.vars.previouslyClickedVideo=c),b.vars.clickedVideo=c,f.show(),b.movePlayerToLightbox(a,c),d.preventDefault(),d.stopPropagation()):
b.handleError("cannotOpenLightbox","Cannot find Lightbox popover for popoverTriggerId: "+b.vars.popoverTriggerId)};this.movePlayerToLightbox=function(a,c){b.vars.ingressAssetSpec=c;var d=b.vars.A.$("#"+b.vars.sharedUtils.vars.templateId).find(r.LB_PLAYER_PLACEHOLDER_SELECTOR);0<a.length&&0<d.length&&(c=function(){a.find(r.PLAYER_WRAPPER_SELECTOR).detach().appendTo(d)},b.vars.isMobile?setTimeout(c,500):c(),b.changePlayerMode(b.vars.isMobile?r.IVX_PLAYER_MODE:r.LB_PLAYER_MODE))};this.movePlayerToIngress=
function(a){b.setCurrentIngressPlaceholder(a);var c=b.vars.sharedUtils.dom.$wrapper.find(r.LB_PLAYER_PLACEHOLDER_SELECTOR);0<a.length&&0<c.length&&(c.find(r.PLAYER_WRAPPER_SELECTOR).detach().appendTo(a),b.changePlayerMode(r.INLINE_PLAYER_MODE),a.find(r.AUDIO_TOGGLE_BUTTON_SELECTOR).toggleClass(r.UNMUTE_CSS_CLASS,b.player.isMuted()).toggleClass(r.MUTE_CSS_CLASS,!b.player.isMuted()),b.setAudioPreferences())};this.addPlayerLoadedHandler=function(){b.player.on("loadeddata",function(){if(!b.vars.sharedUtils.inlinePlayerInitialized){var a=
"."+b.vars.clientPrefix+".ive-inline-player-controls",c="."+b.vars.clientPrefix+" .ive-inline-player-time",d="."+b.vars.clientPrefix+" .ive-scrubber-bar-fill",f=0<b.vars.A.$(a).length,p=a+" .ive-inline-player-play-toggle",t=b.vars.shouldLoop;b.listenToMuteUnmuteEvents(b.player);b.player.on("timeupdate",function(a){b.vars.mediaEnded&&b.resetMediaEndedState(p);f?(b.vars.sharedUtils.vars.vipVideoDuration=b.player.getMediaDuration(),b.vars.sharedUtils.updateProgressBarAndTimeDisplay(a,c,d)):b.updateTimeDisplay()});
t||b.listenToMediaEndedEvent(b.player,p);f&&(b.listenToPlayPauseEvents(b.player,p),b.vars.sharedUtils.initializeProgressBarTouchEvents(a,".ive-scrubber-container",!0));b.vars.sharedUtils.inlinePlayerInitialized=!0}})};this.resetMediaEndedState=function(a){b.vars.mediaEnded=!1;b.vars.A.$(a).removeClass(""+r.REPLAY_CSS_CLASS);b.player.player.playerInstance.videoJS.hasStarted(!0)};this.listenToPlayPauseEvents=function(a,c){var d=b.vars.A.$(r.PLAYER_CONTAINER_SELECTOR).find(c);a.on("play",function(){d.removeClass(r.PLAY_CSS_CLASS+
" "+r.REPLAY_CSS_CLASS)});a.on("pause",function(){d.addClass(""+r.PLAY_CSS_CLASS)})};this.listenToMuteUnmuteEvents=function(a){b.toggleMuteButtonBasedOnPlayerState(a);a.on("volumechange",function(){b.toggleMuteButtonBasedOnPlayerState(a)})};this.toggleMuteButtonBasedOnPlayerState=function(a){b.vars.A.$(r.PLAYER_CONTAINER_SELECTOR).find(r.AUDIO_TOGGLE_BUTTON_SELECTOR).toggleClass(r.UNMUTE_CSS_CLASS,a.isMuted()).toggleClass(r.MUTE_CSS_CLASS,!a.isMuted())};this.listenToMediaEndedEvent=function(a,c){a.on("ended",
function(){b.vars.A.$(c).addClass(""+r.REPLAY_CSS_CLASS);b.player.player.playerInstance.videoJS.hasStarted(!1);b.vars.mediaEnded=!0})};this.addLightboxAfterShowAndBeforeHideEvents=function(){b.vars.A.off("a:popover:afterShow:"+b.vars.popoverId);b.vars.A.on("a:popover:afterShow:"+b.vars.popoverId,function(a){try{var c=void 0;if(b.vars.lightboxOpenedFirstTime){var d=b.vars.A.$(a.popover.$popover).find("[data-css-class]");d.length&&b.vars.A.$(a.popover.$popover).addClass(d.attr("data-css-class"));b.vars.lightboxOpenedFirstTime=
!1;c=b.vars.clickedVideo.productAsin}else c=b.vars.clickedVideo.contentId!==b.vars.previouslyClickedVideo.contentId?b.vars.clickedVideo.productAsin:u;b.triggerLightboxOpenEvent(b.vars.clickedVideo,c)}catch(f){b.handleError("cannotOpenLightbox",f)}});b.vars.A.off("a:popover:beforeHide:"+b.vars.popoverId);b.vars.A.on("a:popover:beforeHide:"+b.vars.popoverId,function(){b.closeLightbox()})};this.initializePlayerOverlayComponents=function(a){a.closest(r.PLAYER_CONTAINER_SELECTOR).delegate(r.CLOSE_BUTTON_SELECTOR,
"click touchend",function(a){a.preventDefault();a.stopPropagation();b.player.pause();b.vars.sharedUtils.emitMetric(b.vars.clientPrefix+":"+r.INLINE_PLAYER_CLOSE_BUTTON_CLICK);b.vars.A.trigger("vse:ns:inlinePlayer:"+b.vars.clientPrefix+":closeButton:click");l.count("vse:ns:inlinePlayer:closeButton:click",1)});a.closest(r.PLAYER_CONTAINER_SELECTOR).delegate(r.AUDIO_TOGGLE_BUTTON_SELECTOR,"click touchend",function(a){a.preventDefault();a.stopPropagation();b.player.isMuted()?b.player.unmute():b.player.mute();
b.setAudioPreferences();b.vars.A.trigger("vse:ns:inlinePlayer:"+b.vars.clientPrefix+":audioToggle:click");l.count("vse:ns:inlinePlayer:audioToggle:click",1)});a.closest(r.PLAYER_CONTAINER_SELECTOR).delegate(r.PLAY_TOGGLE_BUTTON_SELECTOR,"click touchend",function(a){a.preventDefault();a.stopPropagation();b.player.isPaused()?b.player.play():b.player.pause();b.vars.A.trigger("vse:ns:inlinePlayer:"+b.vars.clientPrefix+":playToggle:click");l.count("vse:ns:inlinePlayer:playToggle:click",1)});a.closest(r.PLAYER_CONTAINER_SELECTOR).delegate(r.EXPAND_BUTTON_SELECTOR,
"click touchend",function(a){b.vars.sharedUtils.emitMetric(b.vars.clientPrefix+":"+r.INLINE_PLAYER_EXPAND_BUTTON_CLICK);b.vars.A.trigger("vse:ns:inlinePlayer:"+b.vars.clientPrefix+":expandButton:click");l.count("vse:ns:inlinePlayer:expandButton:click",1)})};this.startPlaying=function(a,c){b.setCurrentIngressPlaceholder(c);b.changePlayerMode(r.INLINE_PLAYER_MODE);b.vars.$ingressPlaceholder.find(r.OSP_LINK_SELECTOR).toggleClass("aok-hidden",!a||b.vars.A.objectIsEmpty(a.vendorTrackingId));b.vars.$ingressPlaceholder.find(r.REMAINING_TIME_SELECTOR).addClass("aok-hidden");
b.player.play(a);setTimeout(function(){b.vars.$ingressPlaceholder.find(r.REMAINING_TIME_SELECTOR).removeClass("aok-hidden")},600);b.updateAudioToggle(c)};this.changePlayerMode=function(a){b.player.setPlayerMode(a);b.vars.currentPlayerMode!==a&&b.vars.$ingressPlaceholder.find(r.PLAYER_WRAPPER_SELECTOR).removeClass(r.IVE_CSS_CLASS_PREFIX+b.vars.currentPlayerMode).addClass(r.IVE_CSS_CLASS_PREFIX+a);b.vars.isMobile&&(b.vars.sharedUtils.vars.isVideoImmersivePlayer=a===r.IVX_PLAYER_MODE);b.vars.sharedUtils.vars.currentPlayerMode=
a;b.vars.currentPlayerMode=a};this.updateAudioToggle=function(a){var c=m.iveAudioPref;(c===r.MUTED_AUDIO_PREF&&!b.player.isMuted()||c===r.UNMUTED_AUDIO_PREF&&b.player.isMuted())&&a.find(r.AUDIO_TOGGLE_BUTTON_SELECTOR).click()};this.setAudioPreferences=function(){m.iveAudioPref=b.player.isMuted()?r.MUTED_AUDIO_PREF:r.UNMUTED_AUDIO_PREF};this.setCurrentIngressPlaceholder=function(a){b.vars.$ingressPlaceholder=a};this.triggerLightboxOpenEvent=function(a,c){b.vars.A.trigger("vse:"+b.vars.clientPrefix+
":page:lightBoxOpened",{lightBoxId:b.vars.popoverId,lazyLoadProductAsin:c,assetSpec:a})};this.closeLightbox=function(){b.vars.A.trigger("vse:"+b.vars.clientPrefix+":page:lightBoxClosed");setTimeout(function(){b.movePlayerToIngress(b.vars.$ingressPlaceholder);b.player.play()},50);b.vars.callback&&b.vars.callback()};this.updateTimeDisplay=function(){var a=b.vars.$ingressPlaceholder.find(r.REMAINING_TIME_SELECTOR);if(a.length){var c=b.player.getMediaDuration();if(!isNaN(c)){var d=Math.min(b.player.getCurrentTime(),
c),f=c-d,c=Math.floor(f/3600),d=Math.floor(f/60%60),f=Math.floor(f%60);a.text((0<c?c+":":"")+(0<c&&10>d?"0"+d+":":d+":")+(10>f?"0"+f:f))}}};this.handleError=function(a,c){l.count("vse:ns:inlinePlayer:"+b.vars.clientPrefix+":"+a,1);l.logError(r.ATTRIBUTION_NAME,"Fallback for inline player "+b.vars.clientPrefix,c);b.vars.A.trigger("vse:ns:inlinePlayer:"+b.vars.clientPrefix+":"+a)};this.vars={A:d,sharedUtils:c,clientPrefix:c.vars.clientPrefix,popoverTriggerId:a.popoverTriggerId,popoverId:a.popoverId,
isMobile:c.vars.isMobile,lightboxOpenedFirstTime:!0,clickedVideo:null,previouslyClickedVideo:null,ingressAssetSpec:null,$ingressPlaceholder:null,mediaEnded:!1,callback:null};this.player=c.vars.player}}(),H=function(){function d(c,a,b,d){var f=this;this.onIntersectionObserved=function(a,b){a.forEach(function(a){if(b){var c=a.target,d=f.getElementUniqueKey(c);if(0<a.intersectionRatio)a=m.setTimeout(function(){var a=f.childElems.indexOf(c);f.callback(a);delete f.viewTimeout[d]},1E3),f.viewTimeout[d]=
a;else if(a=f.viewTimeout[d])m.clearTimeout(a),delete f.viewTimeout[d]}else 0<a.intersectionRatio&&(a=f.childElems.indexOf(a.target),f.callback(a))})};c===u&&(c=null);this.callback=b;this.parentEle=c;if(this.itemsToBeObserved=a)this.childElems=Array.prototype.slice.call(a),this.options={root:this.parentEle,rootMargin:"0px",threshold:.5},this.viewTimeout={},this.intersectionObserver=new IntersectionObserver(function(a){return f.onIntersectionObserved(a,d)},this.options),this.childElems.forEach(function(a){f.intersectionObserver.observe(a)})}
d.prototype.getElementUniqueKey=function(c){return c.id||c.outerHTML};return d}(),f=function(){function d(){}d.PLAYER_INITIALIZED="vse-player-initialized";d.LB_OPENED="vse-lb-opened";d.PLAYER_PAGE_STATE_NOT_FOUND_ERROR_KEY="vse-player-failed-to-render-no-pagestate";d.LAZY_LOAD_PAGE_STATE_NOT_FOUND_ERROR_KEY="vse-lazyload-failed-to-render-no-pagestate";d.RV_PAGE_STATE_NOT_FOUND_ERROR_KEY="vse-rv-failed-to-render-no-pagestate";d.INGRESS_RV_PAGE_STATE_NOT_FOUND_ERROR_KEY="vse-ingress-failed-to-render-no-pagestate";
d.FEEDBACK_PAGE_STATE_NOT_FOUND_ERROR_KEY="vse-feedback-failed-to-render-no-pagestate";d.METADATA_PAGE_STATE_NOT_FOUND_ERROR_KEY="vse-metadata-failed-to-render-no-pagestate";d.SOCIAL_SHARE_STATE_NOT_FOUND_ERROR_KEY="vse-social-share-failed-to-render-no-pagestate";d.RELATED_PRODUCT_PAGE_STATE_NOT_FOUND_ERROR_KEY="vse-related-product-failed-to-render-no-pagestate";d.LB_POPOVER_NOT_FOUND_ERROR_KEY="vse-lb-failed-to-render-no-popover";d.VISIBLE_DIV_NARROW_PREFIX="vse-pc-visible-narrow-";d.PC_HIDDEN_CACHE_DIV_PREFIX=
"vse-pc-hidden-cache-";d.AJAX_MAX_RETRY_COUNT=3;d.CLICK_ATTRIBUTION_INITIAL_DELAY=2;d.VAP_EW="/vap/ew/";d.RELATED_PRODUCTS_ENDPOINT="subcomponent/relatedproducts/";d.PUI_RELATED_PRODUCTS_ENDPOINT="subcomponent/puirelatedproducts/";d.WEBLAB_TRIGGER_ENDPOINT="weblabtrigger/";d.EMPTY_STRING="";d.PORTRAIT="portrait";d.LANDSCAPE="landscape";d.SQUARE="square";d.PORTRAIT_ASPECT_RATIO="9:16";d.LANDSCAPE_ASPECT_RATIO="16:9";d.SQUARE_ASPECT_RATIO="1:1";d.IS_VIDEO_IMMERSIVE_PLAYER_KEY="isVideoImmersivePlayer";
d.SHOW_CONTENT_CAROUSEL="showContentCarousel";d.COMMA=",";d.SEMICOLON=";";d.INGRESS_CAROUSEL_SUFFIX="-vse-related-videos";d.ENGLISH="english";d.HINDI="hindi";d.videoInformationContainer=".vse-lb-video-metadata";d.videoTitle=d.videoInformationContainer+" .vse-content-title";d.vendorName=d.videoInformationContainer+" .vse-video-author";d.videoAge=d.videoInformationContainer+" .ive-video-age";d.followButton=".vse-follow-button .amazon-follow";d.vseFollowClass=".vse-follow-button";d.sbvLabel=".vse-sbv-label";
d.hasSBVideoCssClass="vse-has-sb-video";d.creatorAndDisclosure=".vse-creator-name-and-disclosure";d.ibVideoOspDisclosure=d.videoInformationContainer+" .vse-oap-disclosure-container";d.ibVideoAiDisclosure=d.videoInformationContainer+" .vse-aip-disclosure-container";d.verifiedPurchaseLabel=".ive-verified-purchase-label";d.verifiedPurchaseLabelDivider=".ive-verified-label-name-divider";d.socialShareClickMetricName="vseSocialShareClickImageBlock";d.relatedEnglishVideosContainer="vse-related-english-videos-carousel-container";
d.relatedHindiVideosContainer="vse-related-hindi-videos-carousel-container";d.vernacLanguageRadioBlockSelector=".vse-carousel-vernac-language-radio-button-container";d.RELATED_PRODUCTS_INNER_CONTAINER=".vse-rp-container";d.RELATED_PRODUCTS_INNER_CLASS_NAME="vse-rp-container";d.CACHE_RP_PAYLOAD_HIDDEN_DIV_CONTAINER=".vse-related-products-cache-hidden";d.RELATED_PRODUCTS_CONTAINER_SELECTOR=".vse-related-products-narrow";d.RELATED_PRODUCTS_ITEM_SELECTOR=".vse-product-item";d.ATTRIBUTION_NAME="vse-component-assets";
d.LB_CAROUSEL_CONFIG='div[class^\x3d"div-"][class$\x3d"-vip-relatedvideos"]';d.LB_CLOSE_BUTTON_ON_PLAYER_CLASS_NAME="vse-close-button-on-player";d.TABLET_LIGHTBOX_CLASS_NAME="vse-tablet-popover";d.ATTR_ORIGINAL_HREF="data-og-href";d.AUI_POPOVER_INNER=".a-popover-inner";d.VIPSelector=".vse-vip";d.VIPLightboxSelector=".vse-vip-lightbox";d.LightboxWrapperSelector=".vse-lightbox-wrapper";d.PlayerContainerSelector=".vse-player-container";d.VIPOverlaySelector=".vse-vip-overlay";d.VIPActionOverlaySelector=
".vse-vip-actions-overlay";d.VIPLbTabsAndCarouselOverlaySelector=".vse-vip-lb-tabs-carousel-container-overlay";d.VIPLbCarouselSelector=".vse-vip-lb-carousel-container";d.VIPProductCarouselOverlaySelector=".vse-pc-container-overlay";d.VIPLbTabsAndCarouselContainerSelector=".vse-vip-lb-tabs-carousel-container";d.VIPProductCarouselOverlayContainerSelector=".vse-pc-container";d.VIPShopIconBlockSelector=".vse-vip-shop";d.VIPShopIconSelector=".vse-vip-shop-icon";d.VIPWatchIconSelector=".vse-vip-watch-icon";
d.VIPWatchIconBlockSelector=".vse-vip-watch";d.VIPShareIconBlockSelector=".vse-vip-share";d.VIPShareIconSelector=".vse-vip-share-icon";d.VIPActionIconSelector=".vse-vip-action-icon";d.VIPEmptyRelatedProductsContainerSelector=".vse-related-products-mobile-empty";d.VIPLbTabsContainerSelector=".vse-vip-lb-tabs";d.VIPLbCarouselViewportSelector=".vse-vip-lb-carousel .a-carousel-viewport";d.VerticalCarouselScrollableElement=".vse-lb-right";d.VIPSkipBackButtonSelector=".vse-vip-skip-backward-button";d.VIPSkipForwardButtonSelector=
".vse-vip-skip-forward-button";d.VIPPlayPauseToggleSelector=".vse-vip-play-pause-toggle";d.VIPProgressBarSelector=".vse-vip-scrubber-bar";d.VIPProgressBarFillSelector=".vse-vip-scrubber-bar-fill";d.VIPTimeRemainingSelector=".vse-vip-time-remaining-display";d.VIPProductCarouselViewportSelector=".vse-pc-container .a-carousel-viewport";d.VIPSeeMoreBlockSelector=".vse-vip-see-more";d.VIPSeeMoreLinkSelector=".vse-vip-see-more-link";d.VIPSeeMoreTextSelector=".vse-vip-see-more-text";d.VIPCloseButton=".vse-close-button";
d.VIPSearchButtonSelector=".ive-search-button";d.VIPSearchButtonHideText="hide-text";d.VisualSearchMetricPrefix="ive:visual:search:";d.VisualSearchOverlaySelector=".hotspots-overlay-container";d.VisualSearchPFOSheetSelector=".ive-bottom-sheet-pfo-grid";d.VisualSearchPFOArrowSelector=".ive-pfo-sheet-arrow-wrapper";d.VisualSearchPFOHandleSelector=".ive-pfo-sheet-handle";d.VisualSearchPFOFindingProductsText=".ive-pfo-bottom-sheet-finding-text";d.VisualSearchPFOFailureMessageSection=".ive-pfo-failure-section";
d.VisualSearchPFOSingleHotSpotFailureInstructionText=".ive-pfo-single-hotspot-failure-instruction-text";d.VisualSearchPFOAllHotSpotsFailureInstructionText=".ive-pfo-all-hotspots-failure-instruction-text";d.VisualSearchPFOFoundProductsText=".ive-pfo-bottom-sheet-found-text";d.VisualSearchPFOFindProductsContent=".ive-bottom-sheet-content";d.VisualSearchPFOCloseSheetArrow=".ive-pfo-sheet-arrow";d.VisualSearchAmazonLensLogo=".ive-amazon-lens-logo-container";d.VisualSearchBackButton=".ive-back-button";
d.VisualSearchBBXCanvasSelector=".bbx-canvas";d.VisualSearchTooltipText=".ive-search-tooltip-text";d.productAsinAttributeSelector="data-csa-c-item-id";d.addToCartMetricSuffix="addToCart";d.seeMoreMetricSuffix="seeOptions";d.productAsinMetricSuffix="productAsin";d.addToCartClickSelector=".puis-atcb-add-container";d.seeOptionsClickSelector=".puis-see-details-content";d.productAsinClickSelector='span[data-csa-c-func-deps\x3d"aui-da-detail-page-link-tap"]';d.detailPageLinkJsonKey="detailPageLink";d.VIPCCButtonSelector=
".vse-vip-custom-cc-button";d.VIPCCTooltipSelector=".vse-vip-cc-tooltip";d.VIPCCTooltipTextSelector=".vse-vip-cc-tooltip-text";d.VIPCCTextTrackSelector=".vjs-text-track-display";d.defaultPlayerCCButtonTitleSelector=".vjs-subs-caps-button.vjs-menu-button \x3e button";d.LabelNameSelector=".ive-player-label-name";d.LabelTooltipSelector=".ive-player-label-tooltip";d.VIPMuteUnmuteSelector=".ive-vip-custom-mute_unmute-button";d.VIPVideoTitleSelector=".vse-video-title-ellipsis-wrapper";d.VIPReviewsAuthorProfileImageSelector=
".vse-reviews-author-profile-image";d.VIPReviewsAuthorStarBadgesSelector=".vse-reviews-author-star-badges";d.VIPReviewsExpandableContentSelector=".vse-reviews-content-expand-container";d.VIPReviewsMetadataSelectors=[d.VIPVideoTitleSelector,d.VIPReviewsAuthorProfileImageSelector,d.VIPReviewsAuthorStarBadgesSelector,d.VIPReviewsExpandableContentSelector];d.VIPFeedbackContainer=".vse-fb-trigger-container";d.VIPMultiCarouselWrapper=".vse-vip-lb-multi-carousel-container-wrapper";d.VIPMultiCarouselOverlay=
".vse-vip-lb-multi-carousel-container-overlay";d.VIPMultiCarouselOneContainer=".vse-vip-lb-first-carousel-container";d.VIPMultiCarouselTwoContainer=".vse-vip-lb-second-carousel-container";d.VIPMultiCarouselOneCarousel=".vse-vip-lb-first-carousel-container .a-carousel-viewport";d.VIPMultiCarouselTwoCarousel=".vse-vip-lb-second-carousel-container .a-carousel-viewport";d.VIPMultiCarouselExpandedClass="vse-vip-multi-carousel-expanded";d.G1="G1";d.G2="G2";d.VIPPlayIconClassName="vse-vip-play-icon";d.VIPPauseIconClassName=
"vse-vip-pause-icon";d.VIPLbOverlayShowCssClassName="vse-lb-tabs-overlay-show";d.VIPOverlayShowClassName="vse-overlay-show";d.VIPActionOverlayShowClassName="vse-vip-ao-show";d.VIPActionOverlayBgShadowClassName="vse-carousel-bg-animation";d.VIPMetadataClassName="vse-lb-video-metadata";d.VIPVideoInfoClassName="vse-video-info";d.VIPVideoAgeClassName="ive-video-age";d.VIPVideoHelpfulVotesClassName="vse-helpful-votes";d.VIPVideoTitleWrapperClassName="video-title-ellipsis-wrapper";d.VIPPlayPauseClassName=
"vse-vip-play-pause-forward-previous-btns-container";d.VIPScrubberClassName="vse-vip-controls";d.UpNextClassName="vse-up-next";d.UpNextVideoTitleClassName="vse-up-next-video-title";d.UpNextAuthorClassName="vse-up-next-author";d.UpNextCancelClassName="vse-up-next-cancel";d.UpNextElementClassName="vse-upn-element";d.UpNextElementShownClassName="vse-upn-element-shown";d.CarouselHeader=".vse-vc-header";d.VIPMuteIconClassName="ive-mute";d.VIPUnmuteIconClassName="ive-unmute";d.VIPCCButtonUnpressedClassName=
"vse-cc-unpressed";d.VIPCCButtonPressedClassName="vse-cc-pressed";d.VIPVideoCarouselOpenedClassName="vse-vip-video-carousel-opened";d.VIPProductCarouselOpenedClassName="vse-vip-product-carousel-opened";d.VIPReviewsOverlayVisibleClassName="vse-vip-reviews-overlay-visible";d.VIPLandscapeVideoClassName="vse-vip-landscape-video";d.METRIC_WIDGET_CLICK=":widget:click";d.METRIC_LIGHTBOX_OPEN="ive-lightbox-opened";d.METRIC_VIP_CLOSE="vip:close";d.METRIC_VIP_CLOSE_WITHOUT_PLAY="vip:close:without:play";d.METRIC_PLAY=
"vip:play:icon:click";d.METRIC_PORTRAIT_MODE="vip:portrait:mode:render";d.METRIC_LANDSCAPE_MODE="vip:landscape:mode:render";d.METRIC_PAUSE="vip:pause:icon:click";d.METRIC_SKIP_FORWARD="vip:skip:forward:icon:click";d.METRIC_SKIP_BACK="vip:skip:back:icon:click";d.METRIC_SHOP_ICON="vip:shop:icon:click";d.METRIC_PFO_CLICK="shop:pfo:click";d.METRIC_PFO_RENDER="shop:pfo:render";d.METRIC_PFO_IMPRESSION="shop:pfo:impression";d.METRIC_WATCH_ICON="vip:watch:icon:click";d.METRIC_WATCH_THUMBNAIL_CLICK="vip:watch:thumbnail:click";
d.METRIC_WATCH_THUMBNAIL_RENDER="vip:watch:thumbnail:render";d.METRIC_WATCH_THUMBNAIL_IMPRESSION="vip:watch:thumbnail:impression";d.METRIC_UPNEXT_THUMBNAIL_IMPRESSION="vip:watch:upNextThumbnail:impression";d.METRIC_SHARE_ICON="share:icon:click";d.METRIC_SHARE_SELECTION_CLICK="share:selection:click";d.AUTOPLAY_FALLBACK_EXECUTED="vse:autoplay:fallback";d.METRIC_REPORT_CLICK="report:icon:click";d.METRIC_REPORT_SUBMIT="report:icon:submit";d.METRIC_OPEN_LIGHTBOX_EVENT_EXECUTION="vse:lightbox:open:duration";
d.METRIC_LB_THUMBNAIL_CLICK="ive:lb:thumbnail:click";d.METRIC_LB_THUMBNAIL_IMPRESSION="ive:lb:thumbnail:impression";d.SINGLE_VIDEO_LB_CSS_CLASS="vse-single-video-lb";d.METRIC_LB_SHOW_MORE_BUTTON_CLICK="ive:lb:showMoreButton:click";d.METRIC_LB_SHOW_MORE_BUTTON_IMPRESSION="ive:lb:showMoreButton:impression";return d}(),ea=u&&u.__assign||Object.assign||function(d){for(var c,a=1,b=arguments.length;a<b;a++){c=arguments[a];for(var g in c)Object.prototype.hasOwnProperty.call(c,g)&&(d[g]=c[g])}return d},fa=
u&&u.__awaiter||function(d,c,a,b){return new (a||(a=Promise))(function(g,f){function k(a){try{p(b.next(a))}catch(c){f(c)}}function h(a){try{p(b["throw"](a))}catch(c){f(c)}}function p(b){b.done?g(b.value):(new a(function(a){a(b.value)})).then(k,h)}p((b=b.apply(d,c||[])).next())})},ga=u&&u.__generator||function(d,c){function a(a){return function(c){return b([a,c])}}function b(a){if(f)throw new TypeError("Generator is already executing.");for(;g;)try{if(f=1,k&&(h=k[a[0]&2?"return":a[0]?"throw":"next"])&&
!(h=h.call(k,a[1])).done)return h;if(k=0,h)a=[0,h.value];switch(a[0]){case 0:case 1:h=a;break;case 4:return g.label++,{value:a[1],done:!1};case 5:g.label++;k=a[1];a=[0];continue;case 7:a=g.ops.pop();g.trys.pop();continue;default:if(!(h=g.trys,h=0<h.length&&h[h.length-1])&&(6===a[0]||2===a[0])){g=0;continue}if(3===a[0]&&(!h||a[1]>h[0]&&a[1]<h[3]))g.label=a[1];else if(6===a[0]&&g.label<h[1])g.label=h[1],h=a;else if(h&&g.label<h[2])g.label=h[2],g.ops.push(a);else{h[2]&&g.ops.pop();g.trys.pop();continue}}a=
c.call(d,g)}catch(b){a=[6,b],k=0}finally{f=h=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}var g={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},f,k,h,p;return p={next:a(0),"throw":a(1),"return":a(2)},"function"===typeof Symbol&&(p[Symbol.iterator]=function(){return this}),p},ha=function(){function d(c,a){var b=this;this.config=a;this.currentBoundingBoxes=[];this.firstTimeInitialize=!0;this.isMshop=!1;this.BORDER_OFFSET_PX=4;this.LANDSCAPE_VIDEO_FRAME_PADDING_TOP_PX=
8;this.VIDEO_FRAME_VERTICAL_PADDING_PX=36;this.VIDEO_FRAME_HORIZONTAL_PADDING_PX=20;this.hideAfter=4E3;this.IVE_HOTSPOTS_COUNTER="ive_hotspots_counter";this.IVE_HOTSPOTS_TIMESTAMP="ive_hotspots_timestamp";this.SEARCH_BLINKING_STAR_ANIMATION=".ive-blinking-star-animation";this.SEARCH_TOOLTIP_TEXT_ID="#ive-search-tooltip-trigger";this.firstProductFaceoutCallForTheFrame=!0;this.handleSearchButtonInteractions=function(){try{b.$ivxWrapper=b.A.$("#"+b.templateId).closest(f.VIPSelector),b.config.A.$("#"+
b.templateId+" "+f.VIPSearchButtonSelector).unbind("click"),b.config.A.$("#"+b.templateId+" "+f.VIPSearchButtonSelector).click(function(a){a.stopPropagation();a.stopImmediatePropagation();b.pausedVideoIfPlaying();b.enterVisualSearchMode();b.currentVideoContentId=b.player.getCurrent().contentId;b.enableHotspotsForPausedFrame(b.currentVideoContentId);b.emitMetric(f.VisualSearchMetricPrefix+"searchButton:click")}),b.config.A.$("#"+b.templateId+" "+f.VisualSearchBackButton).unbind("click"),b.config.A.$("#"+
b.templateId+" "+f.VisualSearchBackButton).click(function(a){a.stopPropagation();a.stopImmediatePropagation();b.isHotspotDisplay()||b.emitMetric(f.VisualSearchMetricPrefix+"visualsearch:exit:before:hotspot");b.exitVisualSearchMode();b.emitMetric(f.VisualSearchMetricPrefix+"backButton:click")}),b.canvas=document.createElement("canvas"),b.A.$("#"+b.templateId+" video").length&&b.A.$("#"+b.templateId+" video").insertBefore(b.canvas),b.$bbXCanvas=b.A.$("#"+b.templateId+" "+f.VisualSearchBBXCanvasSelector),
b.addOrientationChangeHandler(),b.updateIVXWrapperProperties(),b.setupPFOClickHandlers(),b.addSwipeUpDownHandler(),b.emitMetric(f.VisualSearchMetricPrefix+"searchButton:rendered")}catch(a){l.logError(f.ATTRIBUTION_NAME,"Visual search has failed",a),b.emitMetric(f.VisualSearchMetricPrefix+"failure")}};this.isHotspotDisplay=function(){return 0<b.A.$("#"+b.templateId+" "+f.VisualSearchBBXCanvasSelector+' span[id^\x3d"bbx-"]').length};this.enableHotspotsForPausedFrame=function(a){var c=x.fetchLatestPageState(b.A,
b.clientPrefix+"-visual-search-ps");b.$blinkingStarAnimation=b.config.A.$("#"+b.templateId+" "+b.SEARCH_BLINKING_STAR_ANIMATION).detach();b.moveBlinkingStarAnimation("#"+b.templateId+" "+f.VisualSearchOverlaySelector);b.A.delay(function(){b.showElement(f.VisualSearchOverlaySelector+" "+b.SEARCH_BLINKING_STAR_ANIMATION)},100);b.firstProductFaceoutCallForTheFrame=!0;var d=b.getCurrentTime();a={contentId:a,timestamp:Math.ceil(1E3*b.player.getCurrentTime()),marketplaceId:c.marketplaceId};c={url:c.hotspotsEndpoint,
data:JSON.stringify(a),type:"POST",contentType:"application/json; charset\x3dutf-8",crossDomain:!0,headers:{Authorization:"allow","x-api-key":c.hotspotsEndpointKey},error:function(a){l.logError(f.ATTRIBUTION_NAME,"/getHotspots request has failed",a);b.showPFOSheetErrorMessage(!1);b.$bbXCanvas.addClass("aok-hidden");b.removeBlinkingStarAnimation();b.emitMetric(f.VisualSearchMetricPrefix+"gethotspots:request:failure")},success:function(a){b.sendLatencyMetric(d,"gethotspots:request:latency");b.emitMetric(f.VisualSearchMetricPrefix+
"gethotspots:request:success");null===a||null===a.results||0===a.results.length?(b.$bbXCanvas.addClass("aok-hidden"),b.removeBlinkingStarAnimation(),b.emitMetric(f.VisualSearchMetricPrefix+"gethotspots:response:empty"),b.showPFOSheetErrorMessage(!1)):(b.currentBoundingBoxes=[],a.results.forEach(function(a){b.currentBoundingBoxes.push({blx:a.bounding_box.bottom_left_x,bly:a.bounding_box.bottom_left_y,brx:a.bounding_box.bottom_right_x,bry:a.bounding_box.bottom_right_y,imh:a.bounding_box.image_height,
imw:a.bounding_box.image_width,tlx:a.bounding_box.top_left_x,tly:a.bounding_box.top_left_y,trx:a.bounding_box.top_right_x,try:a.bounding_box.top_right_y,asins:a.asins,pfoHtml:a.pfoHtml,$bbX:a.$bbX})}),b.hidePFOSheetErrorMessage(),b.cleanupPreviousHotspots(),b.showHotspots())}};b.A.$.ajax(c)};this.sendLatencyMetric=function(a,c){l.count(f.VisualSearchMetricPrefix+c,b.getCurrentTime()-a)};this.getCurrentTime=function(){return performance?performance.now():Date.now()};this.moveBlinkingStarAnimation=
function(a){b.$blinkingStarAnimation&&0<b.$blinkingStarAnimation.length&&b.$blinkingStarAnimation.appendTo(a)};this.removeBlinkingStarAnimation=function(){b.hideElement(f.VisualSearchOverlaySelector+" "+b.SEARCH_BLINKING_STAR_ANIMATION);b.moveBlinkingStarAnimation("#"+b.templateId+" "+f.VIPOverlaySelector)};this.showHotspots=function(){var a=b.calculateVideoDimensions(b.player.player.playerInstance.videoJS);if(b.getDeviceOrientation()==f.LANDSCAPE)b.$bbXCanvas.css({width:a.width+"px",height:a.height+
"px",left:(b.A.$(m).width()-a.width)/2+"px",top:b.LANDSCAPE_VIDEO_FRAME_PADDING_TOP_PX+"px"});else{var c=b.A.$("#"+b.templateId+" "+f.VisualSearchBackButton),c=parseFloat(c.css("top"))+c.outerHeight(),d=parseFloat(b.$pfoSheet.css("max-height")),h=parseFloat(b.A.$("#"+b.templateId).closest(".vse-vip-lb-mshop.vse-ivx-ios").css("padding-top"))||0;b.$bbXCanvas.css({width:a.width+"px",height:a.height+"px",left:(b.A.$(m).width()-a.width)/2+"px",top:(m.innerHeight-h-d-a.height+c)/2+"px"})}b.captureVideoFrame(a).then(function(c){var d=
{height:a.height,width:a.width,ratio:1};b.getBoundingBoxCoordinates(d).map(function(a,e){var g=b.$bbXCanvas.find("#placeholder-bbx"),f=g.clone();f.attr("id","bbx-"+e);0===b.$bbXCanvas.find("#"+f.attr("id")).length&&(b.appendHotspotsToFrame(a,f),b.addHotspotClickHandler(a,f,d,c));b.currentBoundingBoxes[e].$bbX=f;g.addClass("aok-hidden")});var e=b.$currentlyClickedbbX===u||null===b.$currentlyClickedbbX?0:b.currentBoundingBoxes.map(function(a){return a.$bbX.attr("id")}).indexOf(b.$currentlyClickedbbX.attr("id"));
b.currentBoundingBoxes[e].$bbX.trigger("click",["forceClick"])})};this.showPFOSheet=function(){b.firstTimeInitialize&&(b.$pfoSheet=b.A.$("#"+b.templateId+" "+f.VisualSearchPFOSheetSelector),b.$ivxWrapper.append(b.$pfoSheet),b.$pfoSheetContainer=b.$ivxWrapper.find(f.VisualSearchPFOSheetSelector),b.$ivxWrapper.delegate(f.VisualSearchPFOSheetSelector+".open","transitionend",function(){b.toggleFixedArrowClass(!0)}));b.$pfoSheet.addClass("loading");b.$pfoSheetContainer.find(f.VisualSearchPFOFindingProductsText).removeClass("aok-hidden");
b.$pfoSheetContainer.find(f.VisualSearchPFOFoundProductsText).addClass("aok-hidden");b.$pfoSheetContainer.find(f.VisualSearchPFOFindProductsContent).addClass("aok-hidden");b.$pfoSheetContainer.removeClass("aok-hidden");b.firstTimeInitialize=!1};this.hidePFOSheet=function(){b.$pfoSheetContainer=b.$ivxWrapper.find(f.VisualSearchPFOSheetSelector);b.$pfoSheetContainer.addClass("aok-hidden");b.$ivxWrapper.find(f.VisualSearchPFOHandleSelector).addClass("aok-hidden")};this.handlePFOClickMetric=function(a,
c,d,h){void 0===h&&(h=!1);b.$ivxWrapper.delegate(a,"click",function(a){if(a=b.A.$(a.target).closest("["+d+"]").attr(d)){var g=a;h&&(g=(a=a.match(/amzn1\.asin\.([A-Z0-9]{10})/))?a[1]:"");b.emitMetric(""+f.VisualSearchMetricPrefix+c+":click",g)}})};this.setupPFOClickHandlers=function(){b.handlePFOClickMetric(f.addToCartClickSelector,f.addToCartMetricSuffix,f.productAsinAttributeSelector);b.handlePFOClickMetric(f.seeOptionsClickSelector,f.seeMoreMetricSuffix,f.productAsinAttributeSelector);b.handlePFOClickMetric(f.productAsinClickSelector,
f.productAsinMetricSuffix,f.productAsinAttributeSelector,!0);b.handlePFODetailPageRedirect()};this.handlePFODetailPageRedirect=function(){b.$ivxWrapper.delegate(f.productAsinClickSelector,"click",function(a){b.isPfoSheetOpened()?b.isMshop||(a.preventDefault(),a.stopPropagation(),a.stopImmediatePropagation(),(a=b.A.$(a.target).closest("a").attr("href"))&&m.open(a,"_blank")):(b.openPfoSheet(),a.preventDefault(),a.stopPropagation(),a.stopImmediatePropagation())})};this.findSimilarProducts=function(a){var c=
b.getCurrentTime(),d=function(d){b.sendLatencyMetric(c,"getpuirelatedproducts:request:latency");b.findSimilarProductsSuccessCallback(a,d);!0===b.firstProductFaceoutCallForTheFrame&&b.removeBlinkingStarAnimation();b.firstProductFaceoutCallForTheFrame=!1},h={productList:a.asins,metadata:{layout:"grid"}},p=3,l=function(a){(0===a.http.status||500<=a.http.status&&599>=a.http.status)&&0<p?(y.sendRequest(b.A,""+f.VAP_EW+f.PUI_RELATED_PRODUCTS_ENDPOINT,h,d,l),p--):(b.showPFOSheetErrorMessage(!0),b.removeBlinkingStarAnimation(),
b.emitMetric(f.VisualSearchMetricPrefix+"getpuirelatedproducts:request:failure"))};b.showPFOSheet();y.sendRequest(b.A,""+f.VAP_EW+f.PUI_RELATED_PRODUCTS_ENDPOINT,h,d,l)};this.findSimilarProductsSuccessCallback=function(a,c){var d=b.$pfoSheetContainer.find(f.VisualSearchPFOFindProductsContent);d.toggleClass("aok-hidden",!1);d.animate({left:"-100%"},300,function(){d.html(c);d.css({left:"100%"});d.animate({left:"0%"},300)});a.pfoHtml=c;a.$bbX&&(b.currentBoundingBoxes.filter(function(b){return b.$bbX[0].id==
a.$bbX[0].id})[0].pfoHtml=c);b.hidePFOSheetErrorMessage();b.$pfoSheetContainer.find(f.VisualSearchPFOFindingProductsText).toggleClass("aok-hidden",!0);b.$pfoSheetContainer.find(f.VisualSearchPFOFoundProductsText).removeClass("aok-hidden");b.$pfoHandle=b.$pfoSheetContainer.find(f.VisualSearchPFOHandleSelector);b.$pfoHandle.length?b.$ivxWrapper.append(b.$pfoHandle):b.$pfoHandle=b.$ivxWrapper.find(f.VisualSearchPFOHandleSelector);b.isInVisualSearchMode()?(b.$pfoHandle.removeClass("aok-hidden"),b.$pfoHandle.unbind("click"),
b.$pfoSheet.removeClass("loading"),b.$pfoHandle.click(b.openPfoSheetIfClosed),b.$pfoSheet.unbind("click"),b.$pfoSheet.click(function(a){b.A.$(a.target).closest(f.productAsinClickSelector).length||b.openPfoSheetIfClosed()})):b.emitMetric(f.VisualSearchMetricPrefix+"visualsearch:exit:before:pfo")};this.openPfoSheetIfClosed=function(){b.isPfoSheetOpened()||b.openPfoSheet()};this.isPfoSheetOpened=function(){return b.$pfoSheetContainer.hasClass("open")};this.addSwipeUpDownHandler=function(){b.$ivxWrapper.undelegate(f.VisualSearchPFOSheetSelector,
"touchend");b.$ivxWrapper.delegate(f.VisualSearchPFOSheetSelector,"touchstart",function(a){var c=a.originalEvent.touches[0].clientY;b.$ivxWrapper.delegate(f.VisualSearchPFOSheetSelector,"touchmove",function(a){a=c-a.originalEvent.touches[0].clientY;b.$ivxWrapper.undelegate(f.VisualSearchPFOSheetSelector,"touchmove");1<Math.abs(a)&&(0<a?b.openPfoSheetIfClosed():(a=b.A.$(f.VisualSearchPFOFindProductsContent).offset().top,b.isPfoSheetOpened()&&a>(b.isMshop?100:50)&&a<(b.isMshop?200:100)&&b.closePfoSheet()))});
b.$ivxWrapper.delegate(f.VisualSearchPFOSheetSelector,"touchend",function(){b.$ivxWrapper.undelegate(f.VisualSearchPFOSheetSelector,"touchmove touchend")})})};this.openPfoSheet=function(){b.$pfoHandle.length&&b.$pfoHandle.addClass("aok-hidden");b.$pfoSheetContainer.addClass("open");var a=b.$pfoSheetContainer.find(f.VisualSearchPFOCloseSheetArrow);a.unbind("click");a.click(function(a){a.preventDefault();a.stopPropagation();b.closePfoSheet()});b.emitMetric(f.VisualSearchMetricPrefix+"pfoSheet:open")};
this.closePfoSheet=function(){b.$pfoSheetContainer.removeClass("open");b.toggleFixedArrowClass(!1);b.$pfoHandle.removeClass("aok-hidden")};this.showPFOSheetErrorMessage=function(a){b.$pfoSheetContainer=b.$ivxWrapper.find(f.VisualSearchPFOSheetSelector);var c=b.$pfoSheetContainer.find(f.VisualSearchPFOFailureMessageSection),d=b.$pfoSheetContainer.find(f.VisualSearchPFOSingleHotSpotFailureInstructionText),h=b.$pfoSheetContainer.find(f.VisualSearchPFOAllHotSpotsFailureInstructionText),p=b.$pfoSheetContainer.find(f.VisualSearchPFOFindingProductsText),
l=b.$pfoSheetContainer.find(f.VisualSearchPFOFoundProductsText),e=b.$pfoSheetContainer.find(f.VisualSearchPFOFindProductsContent);c.toggleClass("aok-hidden",!1);p.toggleClass("aok-hidden",!0);a?(d.toggleClass("aok-hidden",!1),l.toggleClass("aok-hidden",!0),e.toggleClass("aok-hidden",!0)):(b.$pfoSheetContainer.toggleClass("loading",!1),b.$pfoSheetContainer.toggleClass("no-hotspot-error",!0),h.toggleClass("aok-hidden",!1))};this.hidePFOSheetErrorMessage=function(){b.$pfoSheetContainer=b.$ivxWrapper.find(f.VisualSearchPFOSheetSelector);
var a=b.$pfoSheetContainer.find(f.VisualSearchPFOFailureMessageSection),c=b.$pfoSheetContainer.find(f.VisualSearchPFOSingleHotSpotFailureInstructionText),d=b.$pfoSheetContainer.find(f.VisualSearchPFOAllHotSpotsFailureInstructionText);a.toggleClass("aok-hidden",!0);c.toggleClass("aok-hidden",!0);d.toggleClass("aok-hidden",!0);b.$pfoSheetContainer.toggleClass("no-hotspot-error",!1)};this.cleanupPreviousHotspots=function(){if(b.$bbXCanvas){var a=b.$bbXCanvas.find('span[id^\x3d"bbx-"]');a.length&&a.remove()}};
this.showCanvas=function(){b.$bbXCanvas.removeClass("aok-hidden")};this.pausedVideoIfPlaying=function(){b.player.isPlaying()&&b.config.A.$("#"+b.templateId+" "+f.VIPPlayPauseToggleSelector).click()};this.enterVisualSearchMode=function(){b.config.A.$("#"+b.templateId+" ."+f.VIPPlayPauseClassName).addClass("aok-hidden");b.A.$("#"+b.templateId+" "+f.VIPOverlaySelector).addClass("aok-hidden");b.A.$("#"+b.templateId+" "+f.VIPActionOverlaySelector).addClass("aok-hidden");b.A.$("#"+b.templateId).closest(".a-popover-inner").css({"background-color":"black"});
b.A.$("#"+b.templateId+" "+f.VIPSearchButtonSelector).addClass("aok-hidden");b.config.A.$("#"+b.templateId).closest(".vse-vip-lightbox").addClass("ive-visual-search");b.A.$("#"+b.templateId+" "+f.VIPCloseButton).addClass("aok-hidden");b.A.$("#"+b.templateId+" "+f.VisualSearchBackButton).removeClass("aok-hidden");b.A.$("#"+b.templateId+" "+f.VIPCCTextTrackSelector).toggleClass("aok-hidden",!0);b.$bbXCanvas.removeClass("aok-hidden");b.getDeviceOrientation()==f.PORTRAIT&&b.A.$("#"+b.templateId+" "+f.VisualSearchAmazonLensLogo).removeClass("aok-hidden");
b.showPFOSheet();b.shrinkVideoFrame()};this.exitVisualSearchMode=function(){b.config.A.$("#"+b.templateId).removeClass("ive-visual-search");b.A.$("#"+b.templateId+" "+f.VisualSearchAmazonLensLogo).toggleClass("aok-hidden",!0);b.A.$("#"+b.templateId+" "+f.VisualSearchBackButton).addClass("aok-hidden");b.config.A.$("#"+b.templateId+" ."+f.VIPPlayPauseClassName).removeClass("aok-hidden");b.A.$("#"+b.templateId+" "+f.VIPOverlaySelector).removeClass("aok-hidden");b.A.$("#"+b.templateId+" "+f.VIPOverlaySelector).toggleClass(f.VIPOverlayShowClassName,
!0);b.A.$("#"+b.templateId+" "+f.VIPActionOverlaySelector).removeClass("aok-hidden");b.A.$("#"+b.templateId+" "+f.VIPSearchButtonSelector).removeClass("aok-hidden");b.A.$("#"+b.templateId+" "+f.VIPSearchButtonSelector).toggleClass(f.VIPSearchButtonHideText,!1);b.config.A.$("#"+b.templateId).closest(".vse-vip-lightbox").removeClass("ive-visual-search");b.A.$("#"+b.templateId+" "+f.VIPCloseButton).removeClass("aok-hidden");b.$bbXCanvas.addClass("aok-hidden");b.A.$("#"+b.templateId+" "+f.VIPCCTextTrackSelector).toggleClass("aok-hidden",
!1);b.hidePFOSheet();b.restoreVideoFrame();b.cleanupPreviousHotspots();b.$pfoSheetContainer.removeClass("open");b.toggleFixedArrowClass(!1);b.removeBlinkingStarAnimation();b.$currentlyClickedbbX=null};this.shrinkVideoFrame=function(){var a=b.A.$("#"+b.templateId+" "+f.VisualSearchBackButton),c=b.A.$("#"+b.templateId+" "+f.PlayerContainerSelector),d=parseFloat(b.$pfoSheet.css("max-height"));if(b.getDeviceOrientation()==f.LANDSCAPE)c.css({"padding-top":b.LANDSCAPE_VIDEO_FRAME_PADDING_TOP_PX+"px","padding-bottom":d+
b.VIDEO_FRAME_VERTICAL_PADDING_PX+"px","padding-left":0,"padding-right":0});else{var a=a.offset().top+a.outerHeight(),h=b.A.$("#"+b.templateId+" .vse-vip-action-tray").outerHeight();c.css({"padding-top":a+b.VIDEO_FRAME_VERTICAL_PADDING_PX+"px","padding-bottom":d+b.VIDEO_FRAME_VERTICAL_PADDING_PX-h+"px","padding-left":b.VIDEO_FRAME_HORIZONTAL_PADDING_PX+"px","padding-right":b.VIDEO_FRAME_HORIZONTAL_PADDING_PX+"px"})}};this.restoreVideoFrame=function(){var a=b.A.$("#"+b.templateId+" "+f.PlayerContainerSelector);
if(b.getDeviceOrientation()==f.LANDSCAPE){var c=b.A.$("#"+b.templateId+" "+f.VIPActionIconSelector).outerWidth();a.css({"padding-top":0,"padding-bottom":0,"padding-left":0,"padding-right":c+"px"})}else a.css({padding:0})};this.appendHotspotsToFrame=function(a,c){c.removeClass("aok-hidden");b.$bbXCanvas.append(c);c.find(".bbx-dot").css({left:a.x+"px",top:a.y+"px",display:"inline-block"})};this.addHotspotClickHandler=function(a,c,d,h){c.click(function(p,l){b.$currentlyClickedbbX=c;"none"!==c.find(".bbx-dot").css("display")&&
(b.currentBoundingBoxes.map(function(a){return a.$bbX}).forEach(function(a){a.find(".bbx-dot").show()}),c.find(".bbx-dot").hide(),b.currentBoundingBoxes.map(function(a){return a.$bbX}).forEach(function(a){a.find(".bbx-canvas-image").addClass("aok-hidden");a.find(".bbx-canvas-image-border").addClass("aok-hidden")}),p=ea({},a,{top:a.top+b.BORDER_OFFSET_PX,bottom:a.bottom+b.BORDER_OFFSET_PX,left:a.left+b.BORDER_OFFSET_PX,right:a.right+b.BORDER_OFFSET_PX}),p=b.createClipStyle({bbx:p,imageDimensions:d,
videoFrameUrl:h,borderRadiusPx:9}),b.applyClipPathProperties(c.find(".bbx-canvas-image"),p,!1),p=b.createClipStyle({bbx:a,imageDimensions:d,videoFrameUrl:h,borderRadiusPx:12}),b.applyClipPathProperties(c.find(".bbx-canvas-image-border"),p,!0),a.pfoHtml===u||null===a.pfoHtml?b.findSimilarProducts(a):b.findSimilarProductsSuccessCallback(a,a.pfoHtml),l===u&&b.emitMetric(f.VisualSearchMetricPrefix+"hotspot:click"))})};this.applyClipPathProperties=function(a,b,c){a.removeClass("aok-hidden").css({left:b.left+
"px",top:0,"clip-path":b.clipPath,"-webkit-clip-path":b.clipPath,height:b.height+"px",width:b.width+"px","transform-origin":b.transformOrigin,"-webkit-transform-origin":b.transformOrigin,"background-image":c?"":b.backgroundImage,"background-color":"#FFFFFF"})};this.captureVideoFrame=function(a){return fa(b,void 0,void 0,function(){var b,c,d;return ga(this,function(f){switch(f.label){case 0:return this.canvas.width=a.width,this.canvas.height=a.height,b=this.canvas.getContext("2d"),c=document.getElementById(this.A.$("#"+
this.templateId+" video").attr("id")),b.drawImage(c,0,0,a.width,a.height),[4,this.getImageUrl(this.canvas)];case 1:return d=f.sent(),[2,d]}})})};this.getImageUrl=function(a){return fa(b,void 0,void 0,function(){return ga(this,function(b){return[2,new Promise(function(b,c){a.toBlob(function(a){a?(a=URL.createObjectURL(a),b(a)):(this.emitMetric(f.VisualSearchMetricPrefix+"capture:frame:failure"),c("Cannot create image url from video frame"))},"image/png")})]})})};this.createClipStyle=function(a){var b=
a.bbx,c=a.imageDimensions;return{left:0,top:0,clipPath:"inset("+b.top+"px "+b.right+"px "+b.bottom+"px "+b.left+"px round "+a.borderRadiusPx+"px)",height:c.height*c.ratio,width:c.width*c.ratio,backgroundImage:"url("+a.videoFrameUrl+")",transformOrigin:b.x+"px "+b.y+"px"}};this.getBoundingBoxCoordinates=function(a){var c=[],d=a.height,f=a.width,p=a.ratio;b.currentBoundingBoxes.forEach(function(a){var b=a.tlx/a.imw*f,g=a.trx/a.imw*f,q=a.tly/a.imh*d,l=a.bly/a.imh*d;a={x:p*((g-b)/2+b),y:p*((l-q)/2+q),
h:p*(l-q),w:p*(g-b),sX:m.innerWidth/2-p*f/2+p*b,sY:p*q,asins:a.asins,pfoHtml:a.pfoHtml,$bbX:a.$bbX};c.push(ea({},a,{top:a.sY,bottom:p*d-a.sY-a.h,left:p*b,right:p*f-p*b-a.w}))});return c};this.calculateVideoDimensions=function(a){var c=b.A.$("#"+b.templateId+" "+f.PlayerContainerSelector),d=c.width(),c=c.height(),h=a.videoWidth();a=a.videoHeight();a=h/a;d/c>a?d=a*c:c=d/a;return{width:d,height:c,ratio:1}};this.emitMetric=function(a,c){l.count(a,1);a={eventName:b.clientPrefix+":"+a,stringPayload:c||
f.EMPTY_STRING,intPayload:1,videoAsin:b.currentVideoContentId,timestamp:(new Date).toISOString()};b.emitMetricToNexus(a)};this.addOrientationChangeHandler=function(){b.A.on.orientationchange(function(a){if(b.isInVisualSearchMode()){b.cleanupPreviousHotspots();b.A.$("#"+b.templateId+" "+f.VisualSearchAmazonLensLogo).toggleClass("aok-hidden",90===Math.abs(a.orientation));var c=function(){b.shrinkVideoFrame();b.showCanvas();b.showHotspots();b.updateIVXWrapperProperties()},d=function(){clearTimeout(h);
c();b.$pfoSheet.get(0).removeEventListener("transitionend",d)},h=setTimeout(function(){c()},300);b.$pfoSheet.get(0).addEventListener("transitionend",d)}else b.restoreVideoFrame()})};this.updateIVXWrapperProperties=function(){b.$ivxWrapper.css({"max-width":b.getDeviceOrientation()==f.LANDSCAPE?"unset":"100%",bottom:0})};this.executeTooltipForSearchButton=function(){v.now("a-tooltip").execute("ive-tooltip-registration",function(a){b.$trigger=b.A.$("#"+b.templateId+" "+b.SEARCH_TOOLTIP_TEXT_ID);b.tooltip=
a;var c={name:"ive-tooltip-search-button",inlineContent:b.A.$("#"+b.templateId+" "+f.VisualSearchTooltipText).text(),dataStrategy:"preload"};b.instance=a.create(b.$trigger,c);b.A.delay(function(){b.instance.show()},300);b.hideSearchTooltip(!1)})};this.hideSearchTooltip=function(a){b.instance&&(a?b.A.delay(function(){b.instance.hide();b.tooltip.remove(b.$trigger)},300):b.A.delay(function(){b.instance.hide();b.tooltip.remove(b.$trigger)},b.hideAfter))};this.toggleFixedArrowClass=function(a){b.A.$(f.VisualSearchPFOArrowSelector+
", "+f.VisualSearchPFOFoundProductsText).toggleClass("ive-fixed-arrow",a)};this.vipControlsShouldPause=c.vars.vipControlsShouldPause;this.templateId=a.templateId;this.player=c.vars.player;this.A=a.A;this.emitMetricToNexus=c.emitMetricToNexus;this.clientPrefix=c.vars.clientPrefix;this.getDeviceOrientation=c.getDeviceOrientation;this.isMshop=c.vars.isMshop}d.prototype.addAnimationForHotspotsVideo=function(){var c=parseInt(localStorage.getItem(this.IVE_HOTSPOTS_COUNTER))||0,a=parseInt(localStorage.getItem(this.IVE_HOTSPOTS_TIMESTAMP))||
0;this.shouldShowTooltipForSearchButton(c,a)&&this.executeTooltipForSearchButton()};d.prototype.shouldShowTooltipForSearchButton=function(c,a){return 1===c||this.isDifferenceGreaterThan24Hours(Date.now(),a)&&5>=c};d.prototype.updateEducationalRules=function(){var c=localStorage.getItem(this.IVE_HOTSPOTS_COUNTER);if(null===c)localStorage.setItem(this.IVE_HOTSPOTS_COUNTER,"1"),localStorage.setItem(this.IVE_HOTSPOTS_TIMESTAMP,Date.now().toString()),this.executeTooltipForSearchButton();else if(5>=parseInt(c)){var a=
localStorage.getItem(this.IVE_HOTSPOTS_TIMESTAMP),b=Date.now();localStorage.setItem(this.IVE_HOTSPOTS_COUNTER,(parseInt(c)+1).toString());a&&this.isDifferenceGreaterThan24Hours(b,parseInt(a))&&this.executeTooltipForSearchButton()}};d.prototype.isDifferenceGreaterThan24Hours=function(c,a){return 24<(c-a)/36E5};d.prototype.hideElement=function(c){(c=this.config.A.$("#"+this.templateId+" "+c))&&c.addClass("aok-hidden")};d.prototype.showElement=function(c){(c=this.config.A.$("#"+this.templateId+" "+c))&&
c.removeClass("aok-hidden")};d.prototype.isInVisualSearchMode=function(){return this.config.A.$("#"+this.templateId).closest(".vse-vip-lightbox").hasClass("ive-visual-search")};return d}(),ya={BrilaFactory:V,VSEPlayer:S,BrilaShim:T,PlayerPromiseShim:U,GatedP:D,PostMetric:l,AuiUtils:x,EventEmitter:L,VideoVoteContainer:M,VideoVoteContainerFactory:N,ContentCarouselFactory:O,InvalidArgumentsException:G,guid:I,StickyHeaders:aa,RefTagRecorder:K,VSEDisplayStrategy:ba,VSETransitionStrategy:ca,OnSiteAttributionMetrics:P,
DelphiAttribution:Q,MetricUtils:F,InlinePlayerComponent:da,VideoItemIntersectionObserver:H,VisualSearchComponent:ha,ajaxRequestUtil:y},za=function(){return function(d){var c=this;this.config=d;this.setOrientationConfig=function(a){c.orientationConfig=a};this.updateActiveVideoContentId=function(a){c.activeVideoContentId=a};this.triggerWatchIconInteractionOpen=function(){c.config.A.$("#"+c.templateId+" "+f.VIPWatchIconSelector+".vse-unpressed").click()};this.triggerShopIconInteractionOpen=function(){c.config.A.$("#"+
c.templateId+" "+f.VIPShopIconSelector+".vse-unpressed").click()};this.handleWatchIconInteractions=function(){c.config.A.$("#"+c.templateId+" "+f.VIPWatchIconSelector+".vse-unpressed").click(function(a){a.stopPropagation();a.stopImmediatePropagation();c.config.A.trigger("vse:"+c.templateId+":vip:vat:component:open");a=function(){c.config.A.$("#"+c.templateId+" "+f.VIPProductCarouselOverlaySelector).hide();c.config.A.$("#"+c.templateId+" "+f.VIPProductCarouselOverlayContainerSelector).addClass(f.VIPActionOverlayBgShadowClassName);
c.toggleIconsState(!0,f.VIPWatchIconSelector);c.toggleIconsState(!1,f.VIPShopIconSelector);m.innerWidth>m.innerHeight&&c.config.A.$("#"+c.templateId+" "+f.VIPLbCarouselViewportSelector).height(m.innerHeight-c.config.A.$("#"+c.templateId+" "+f.VIPLbTabsContainerSelector).outerHeight(!0));c.config.A.$("#"+c.templateId+" "+f.VIPLbTabsAndCarouselOverlaySelector).addClass(f.VIPLbOverlayShowCssClassName);c.config.A.$("#"+c.templateId+" "+f.VIPLbTabsAndCarouselContainerSelector).removeClass(f.VIPActionOverlayBgShadowClassName);
c.config.A.fadeIn(c.config.A.$("#"+c.templateId+" "+f.VIPLbTabsContainerSelector),300,"linear");c.config.A.$("#"+c.templateId+" "+f.VIPLbCarouselSelector).animate(c.orientationConfig.carouselAnimationType,300,function(){c.lightboxCarousel.scrollToActiveVideo(c.lightboxCarousel.getActiveAsset())});c.config.A.$("#"+c.templateId+" .vjs-text-track-display").addClass(f.VIPVideoCarouselOpenedClassName)};c.isDisplayed(f.RELATED_PRODUCTS_CONTAINER_SELECTOR)?c.closeProductCarousel(a):a()})};this.handleMoreVideosIconInteractions=
function(){c.config.A.$("#"+c.templateId+" "+f.VIPWatchIconSelector+".vse-unpressed").click(function(a){a.stopPropagation();a.stopImmediatePropagation();c.config.A.trigger("vse:"+c.templateId+":vip:vat:component:open");a=function(){c.config.A.$("#"+c.templateId+" "+f.VIPProductCarouselOverlaySelector).hide();c.config.A.$("#"+c.templateId+" "+f.VIPProductCarouselOverlayContainerSelector).addClass(f.VIPActionOverlayBgShadowClassName);c.toggleIconsState(!0,f.VIPWatchIconSelector);c.toggleIconsState(!1,
f.VIPShopIconSelector);c.config.A.$("#"+c.templateId+" "+f.VIPOverlaySelector).addClass(f.VIPOverlayShowClassName);c.config.A.trigger("vse:ns:partialcomponents:"+c.config.clientPrefix+":ivx:overlay:show")};c.isDisplayed(f.RELATED_PRODUCTS_CONTAINER_SELECTOR)?c.closeProductCarousel(a):a()})};this.handleShopIconInteractions=function(a){void 0===a&&(a=function(){});c.config.A.$("#"+c.templateId+" "+f.VIPShopIconSelector+".vse-unpressed").unbind("click");c.config.A.$("#"+c.templateId+" "+f.VIPShopIconSelector+
".vse-unpressed").click(function(b){b.stopPropagation();b.stopImmediatePropagation();c.config.A.trigger("vse:"+c.templateId+":vip:vat:component:open");b=function(){c.config.A.$("#"+c.templateId+" "+f.VIPLbTabsAndCarouselOverlaySelector).removeClass(f.VIPLbOverlayShowCssClassName);c.config.A.$("#"+c.templateId+" "+f.VIPLbTabsAndCarouselContainerSelector).addClass(f.VIPActionOverlayBgShadowClassName);c.toggleIconsState(!0,f.VIPShopIconSelector);c.toggleIconsState(!1,f.VIPWatchIconSelector);c.config.A.$("#"+
c.templateId+" "+f.RELATED_PRODUCTS_CONTAINER_SELECTOR).removeClass("aok-hidden");c.config.A.$("#"+c.templateId+" "+f.VIPProductCarouselOverlaySelector).show();c.config.A.$("#"+c.templateId+" "+f.VIPProductCarouselOverlayContainerSelector).removeClass(f.VIPActionOverlayBgShadowClassName);c.isDisplayed(f.RELATED_PRODUCTS_CONTAINER_SELECTOR)||c.config.A.$("#"+c.templateId+" "+f.RELATED_PRODUCTS_CONTAINER_SELECTOR).animate(c.orientationConfig.carouselAnimationType,300,a);c.config.A.$("#"+c.templateId+
" .vjs-text-track-display").addClass(f.VIPProductCarouselOpenedClassName)};c.isDisplayed(f.VIPLbCarouselSelector)?c.closeVideoCarousel(b):c.throttleActionIcon||(c.throttleActionIcon=!0,b(),setTimeout(function(){return c.throttleActionIcon=!1},600))})};this.toggleIconsState=function(a,b){a?(c.config.A.$("#"+c.templateId+" "+b+".vse-unpressed").addClass("aok-hidden"),c.config.A.$("#"+c.templateId+" "+b+".vse-pressed").removeClass("aok-hidden")):(c.config.A.$("#"+c.templateId+" "+b+".vse-unpressed").removeClass("aok-hidden"),
c.config.A.$("#"+c.templateId+" "+b+".vse-pressed").addClass("aok-hidden"))};this.handleVIPCarouselClose=function(){[f.VIPLbCarouselSelector,f.VIPLbTabsContainerSelector,f.RELATED_PRODUCTS_CONTAINER_SELECTOR].forEach(function(a){c.config.A.$(c.config.A.$("#"+c.templateId+" "+a)).click(function(a){c.config.A.$(a.target).closest(f.RELATED_PRODUCTS_ITEM_SELECTOR).length||(a.stopPropagation(),a.stopImmediatePropagation())})});c.config.A.$("#"+c.templateId+" "+f.VIPActionOverlaySelector).unbind("click");
c.config.A.$("#"+c.templateId+" "+f.VIPActionOverlaySelector).click(function(){c.reset();c.config.A.trigger("vse:"+c.templateId+":vip:vat:component:close")})};this.handleShareIconInteractions=function(){c.config.A.off("a:sheet:beforeShow:"+c.socialShareId+"-sheet");c.config.A.off("a:sheet:afterHide:"+c.socialShareId+"-sheet");c.config.A.on("a:sheet:beforeShow:"+c.socialShareId+"-sheet",function(){c.config.A.trigger("vse:"+c.templateId+":vip:vat:component:open");c.toggleIconsState(!0,f.VIPShareIconSelector)});
c.config.A.on("a:sheet:afterHide:"+c.socialShareId+"-sheet",function(){c.config.A.trigger("vse:"+c.templateId+":vip:vat:component:close");c.toggleIconsState(!1,f.VIPShareIconSelector)})};this.reset=function(){c.throttleActionIcon||(c.throttleActionIcon=!0,setTimeout(function(){return c.throttleActionIcon=!1},600),c.unpressAllActionIcons(),c.isDisplayed(f.VIPLbCarouselSelector)&&c.closeVideoCarousel(function(){c.config.A.$("#"+c.templateId+" "+f.VIPLbTabsAndCarouselContainerSelector).addClass(f.VIPActionOverlayBgShadowClassName);
c.config.A.delay(function(){c.config.A.$("#"+c.templateId+" "+f.VIPLbTabsAndCarouselOverlaySelector).removeClass(f.VIPLbOverlayShowCssClassName)},310)}),c.isDisplayed(f.RELATED_PRODUCTS_CONTAINER_SELECTOR)&&c.closeProductCarousel(function(){c.config.A.$("#"+c.templateId+" "+f.VIPProductCarouselOverlayContainerSelector).addClass(f.VIPActionOverlayBgShadowClassName);c.config.A.delay(function(){c.config.A.$("#"+c.templateId+" "+f.VIPProductCarouselOverlaySelector).hide()},310)}))};this.unpressAllActionIcons=
function(){c.config.A.$("#"+c.templateId+" "+f.VIPActionIconSelector+" .vse-pressed").addClass("aok-hidden");c.config.A.$("#"+c.templateId+" "+f.VIPActionIconSelector+" .vse-unpressed").removeClass("aok-hidden")};this.closeProductCarousel=function(a){c.config.A.$("#"+c.templateId+" "+f.RELATED_PRODUCTS_CONTAINER_SELECTOR).animate(c.orientationConfig.carouselAnimationType,300,a);c.config.A.$("#"+c.templateId+" .vjs-text-track-display").removeClass(f.VIPProductCarouselOpenedClassName)};this.closeVideoCarousel=
function(a){c.config.A.fadeOut(c.config.A.$("#"+c.templateId+" "+f.VIPLbTabsContainerSelector),300,"linear");c.config.A.$("#"+c.templateId+" "+f.VIPLbCarouselSelector).animate(c.orientationConfig.carouselAnimationType,300,a);c.config.A.$("#"+c.templateId+" .vjs-text-track-display").removeClass(f.VIPVideoCarouselOpenedClassName)};this.isDisplayed=function(a){return"block"==c.config.A.$("#"+c.templateId+" "+a).css("display")};this.lightboxCarousel=d.contentCarousel;this.socialShareId=d.socialShareId;
this.templateId=d.templateId}}(),ia=function(){function d(c){var a=this;this.A=c;this.makeApplicationNexusPayloadBuilder=function(a,c){return F.makeApplicationNexusPayloadBuilder(a,c)};this.getCurrentlyPlayingVideoInCarousel=function(b){return-1===b?a.vars.currentAssetSpec:a.getCombinedPlaylist()[b]};this.getCurrentlyPlayingVideoInCarouselMarkAsPlaying=function(b){b=a.getCurrentlyPlayingVideoInCarousel(b);a.markPlaying(b);return b};this.startPlaying=function(b){a.vars.isContinuousPlayFinished=!1;
b?a.vars.player.play(b):a.vars.player.play()};this.updateMediaInfo=function(b){var c=a.dom.$lbVideoCarousel&&a.dom.$lbVideoCarousel.find('[data-asin\x3d"'+b.contentId+'"]').find(".vse-lb-crv-metadata");if(c){if(0<c.length){a.dom.$lbLeftColumn.find(".vse-active-metadata").hide();a.dom.$activeCrvMetadataContainer.html(c.clone().removeClass("aok-hidden").html());a.dom.$activeCrvMetadataContainer.removeClass("aok-hidden");a.dom.$activeCrvMetadataContainer.find(".vse-crv-link").removeClass("aok-hidden");
a.vars.showVotes&&a.relatedVideosCarouselNotEmpty()&&(a.updateActiveVideoVoteContainer(b),a.vars.activeVideoVoteContainer.showOrHide(!0,!0,!0,!0));a.vars.showUploadDate&&a.dom.$wrapper.find(f.videoAge).html(b.videoAge);return}a.dom.$activeCrvMetadataContainer.addClass("aok-hidden").html("");a.dom.$lbLeftColumn.find(".vse-active-metadata").show()}a.updateBasicMediaInfo(b);a.isCustomerReviewVideo(b)?(a.dom.$activeVideoTitlePrefix.removeClass("aok-hidden"),a.dom.$activeVideoCRLink.removeClass("aok-hidden"),
a.dom.$activeVideoCRLinkWrapper.removeClass("aok-hidden")):(a.dom.$activeVideoTitlePrefix.addClass("aok-hidden"),a.dom.$activeVideoCRLink.addClass("aok-hidden"),a.dom.$activeVideoCRLinkWrapper.addClass("aok-hidden"));a.dom.$activeVideoCRLink.attr("href",b.referenceUrl||"");a.relatedVideosCarouselNotEmpty()&&(a.vars.showVotes=a.shouldShowVotes(b),a.vars.showVotes?(a.updateActiveVideoVoteContainer(b),a.vars.activeVideoVoteContainer.showOrHide(!0,!0,!0,!0)):a.vars.activeVideoVoteContainer&&a.vars.activeVideoVoteContainer.showOrHide(!1,
!1,!1,!1));a.isInfluencerVideo(b)?a.isOspEnabled(b)&&(a.dom.$wrapper.find(f.ibVideoOspDisclosure).addClass("aok-hidden"),a.dom.$wrapper.find(f.ibVideoAiDisclosure).removeClass("aok-hidden")):(a.isOspEnabled(b)?a.dom.$wrapper.find(f.ibVideoOspDisclosure).removeClass("aok-hidden"):a.dom.$wrapper.find(f.ibVideoOspDisclosure).addClass("aok-hidden"),a.dom.$wrapper.find(f.ibVideoAiDisclosure).addClass("aok-hidden"));a.vars.shouldShowProfiles&&(a.isInfluencerVideo(b)?a.updateInfluencerProfile(b):a.updateCustomerProfile(b));
a.dom.$wrapper.find(f.sbvLabel).toggleClass("aok-hidden",!b.isSponsoredBrandVideo);a.dom.$wrapper.toggleClass(f.hasSBVideoCssClass,b.isSponsoredBrandVideo)};this.updateCustomerProfile=function(b){var c=-1==a.vars.currentIndex?a.vars.$(".vse-vdp-video-profile"):a.dom.$lbVideoCarousel.find('[data-asin\x3d"'+b.contentId+'"]').find(".vse-video-customer-profile");0<c.length?(a.dom.$activeVideoCustomerProfile.html(c.clone().removeClass("vse-hidden").html()),a.dom.$videoAuthorBlock.addClass("vse-hidden"),
a.dom.$customerProfileContainer.removeClass("vse-no-cp"),b.entityId?(a.dom.$vseOapDivider.addClass("vse-hidden"),a.dom.$creatorNameAndDisclosure.removeClass("vse-hidden")):(a.dom.$vseOapDivider.removeClass("vse-hidden"),a.dom.$creatorNameAndDisclosure.addClass("vse-hidden"))):(a.dom.$activeVideoCustomerProfile.html(""),a.dom.$customerProfileContainer.addClass("vse-no-cp"),a.dom.$wrapper.find(f.ibVideoOspDisclosure).find(f.creatorAndDisclosure).html(b.vendorName),b.entityId?(a.dom.$videoAuthorBlock.addClass("vse-hidden"),
a.dom.$vseOapDivider.addClass("vse-hidden"),a.dom.$creatorNameAndDisclosure.removeClass("vse-hidden")):(a.dom.$videoAuthorBlock.removeClass("vse-hidden"),a.dom.$vseOapDivider.removeClass("vse-hidden"),a.dom.$creatorNameAndDisclosure.addClass("vse-hidden")))};this.updateInfluencerProfile=function(b){var c=-1==a.vars.currentIndex?a.vars.$(".vse-vdp-video-profile"):a.dom.$lbVideoCarousel.find('[data-asin\x3d"'+b.contentId+'"]').find(".vse-video-influencer-profile");0<c.length&&(c=c.clone(),a.dom.$activeVideoCustomerProfile.html(c.removeClass("vse-hidden").html()),
a.dom.$activeVideoCustomerProfile.addClass("vse-active-profile-container"),a.dom.$videoAuthorBlock.addClass("vse-hidden"),a.dom.$wrapper.find(f.ibVideoOspDisclosure).addClass("aok-hidden"),a.dom.$wrapper.find(f.ibVideoAiDisclosure).removeClass("aok-hidden"),b.entityId&&a.dom.$customerProfileContainer.append(a.dom.$vseFollowClassSelector),b.vendorName?(c=a.dom.$wrapper.find(f.ibVideoAiDisclosure),c.find(f.creatorAndDisclosure).html(b.vendorName),b=a.dom.$activeVideoCustomerProfile.find(".vse-profile").attr("href"),
c.find(f.creatorAndDisclosure).attr("href",b),a.dom.$vseOapDivider.addClass("vse-hidden"),a.dom.$creatorNameAndDisclosure.removeClass("vse-hidden")):(a.dom.$vseOapDivider.removeClass("vse-hidden"),a.dom.$creatorNameAndDisclosure.addClass("vse-hidden")),a.dom.$customerProfileContainer.removeClass("vse-no-cp"),a.handleInfluencerProfileNameClick(),a.handleInfluencerAvatarClick())};this.needToUpdateVideoInfoLater=function(){return a.isImageBlockVIP()&&!a.vars.A.objectIsEmpty(a.vars.currentAssetSpec)&&
a.vars.A.objectIsEmpty(a.vars.currentAssetSpec.title)};this.updateVideoMetadataIfNeeded=function(b){a.needToUpdateVideoInfoLater()&&(a.updateBasicMediaInfo(b),a.resetUserActivityTimer(),a.showVideoImmersivePlayerOverlay(),!a.vars.A.objectIsEmpty(b.closedCaptions)&&0<b.closedCaptions.length&&(a.vars.player.removeCurrentTextTracks(),a.vars.player.updateTextTrack(b.closedCaptions)))};this.clearCurrentVideoInfo=function(){a.updateBasicMediaInfo({title:"",vendorName:"",entityId:"",entityType:""})};this.updateBasicMediaInfo=
function(b){a.dom.$wrapper.find(f.videoTitle).html(b.title);a.dom.$wrapper.find(f.vendorName).html(b.vendorName);a.vars.showUploadDate&&a.dom.$wrapper.find(f.videoAge).html(b.videoAge);a.updateFollowCreatorButton(b)};this.updateFollowCreatorButton=function(b){try{if(a.dom.$followButtonSelector.length){var c=a.dom.$followButtonSelector.attr("data-entity-id"),d=a.dom.$followButtonSelector.attr("data-initialize");a.vars.A.objectIsEmpty(b.entityId)||a.vars.A.objectIsEmpty(b.entityType)||b.entityId===
a.vars.defaultEntityId?(a.dom.$followEligibleCreator.length&&a.dom.$followEligibleCreator.addClass("vse-hidden"),a.dom.$vseFollowClassSelector.addClass("vse-hidden")):(a.dom.$followButtonSelector.attr("data-type",b.entityType),a.dom.$followButtonSelector.attr("data-entity-id",b.entityId),"false"==d?(a.dom.$vseFollowClassSelector.removeClass("vse-hidden"),a.dom.$followButtonSelector.attr("data-initialize","true"),m.amznFollow.initialize()):(a.dom.$vseFollowClassSelector.removeClass("vse-hidden"),m.amznFollow.reInitializeButton(b.entityType,
c,a.dom.$followButtonSelector[0])))}else a.dom.$followEligibleCreator.length&&a.dom.$followEligibleCreator.addClass("vse-hidden")}catch(k){l.logError(f.ATTRIBUTION_NAME,"Cannot update follow button. Video: "+b.contentId+", entityId: "+b.entityId,k)}};this.isImageBlockVIP=function(){return a.vars.isVideoImmersivePlayer&&-1!==a.vars.clientPrefix.indexOf("imageblock")};this.createContinuousPlayPlaylist=function(b){a.vars.playlist=a.getCombinedPlaylist();for(var c=0;c<a.vars.playlist.length&&a.vars.playlist[0].contentId!==
b.contentId;c++)a.vars.playlist.push(a.vars.playlist.shift())};this.updateFeedback=function(b){a.vars.A.objectIsEmpty(a.vars.feedback)||a.vars.A.objectIsEmpty(b)||(a.toggleDisableFeedback(b.isSponsoredBrandVideo),a.vars.feedback.setActiveVideoAndSource(b.contentId,b.vendorCode,b.aciContentId),0<a.dom.$wrapper.find(".vse-fb-report-illegal-content").length&&a.vars.feedback.updateReportIllegalContentLink())};this.initializeHelpfulVotes=function(){if(a.vars.showVotes){var b=a.getActiveAsset();a.updateActiveVideoVoteContainer(b);
a.vars.A.on(a.vars.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-hide-votes",function(){a.vars.activeVideoVoteContainer.showOrHide(!1,!1,!1,!1);a.vars.videoVoteFailure=!0});a.vars.A.off("a:declarative:"+(a.vars.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-vote-positive")+":click");a.vars.A.declarative(a.vars.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-vote-positive","click",function(){a.castVote(n.POSITIVE_VOTE)});a.vars.A.off(a.vars.videoVoteContainerFactory.videoVoteConfig.actionPrefix+
"-vote-cast");a.vars.A.on(a.vars.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-vote-cast",function(b){var c=b===n.POSITIVE_VOTE?n.NEGATIVE_VOTE:n.POSITIVE_VOTE,d=a.getActiveAsset(),h=n.EMPTY_STRING;d&&d.videoVoteContainer&&(h=d.videoVoteContainer.getPreviousVote()===b?"cancel:"+b:d.videoVoteContainer.getPreviousVote()===n.POSITIVE_VOTE||d.videoVoteContainer.getPreviousVote()===n.NEGATIVE_VOTE?"switch-"+c+"-to-"+b:b,d.videoVoteContainer.updateWithNewVote(b));a.emitMetricToNexus({eventName:a.vars.clientPrefix+
"ibiv.videovote.castvote:"+h,stringPayload:f.EMPTY_STRING,intPayload:1,videoAsin:d.contentId})})}};this.emitMetricToNexus=function(b){a.vars.emitMetricsToNexus&&(b=a.vars.buildNexusPayload(b),l.emitNexusMetric(b,a.vars.nexusMetricsConfig.producerId,a.vars.nexusMetricsConfig.widgetMetricsSchemaId,a.vars.nexusMetricsConfig.isInternal))};this.shouldShowVotes=function(b){return a.vars.videoVoteContainerFactory&&a.vars.videoVoteContainerFactory.videoVoteConfig&&b&&b.videoVoteContainer&&!a.vars.A.objectIsEmpty(b.videoVoteContainer)&&
!a.vars.videoVoteFailure&&!b.isSponsoredBrandVideo};this.show=function(b){a.updateMediaInfo(b);a.updateFeedback(b);a.showRelatedProducts(b);a.refreshSocialSharePageState(b);a.showLabel(b);a.rotateTo(b);a.vars.isVideoImmersivePlayer&&(a.updateClosedCaptions(b),a.showOrHideSearchButton(b))};this.hasHiddenAndShowMoreClasses=function(b){if(!a.dom.$lbVideoCarousel)return!1;b=a.dom.$lbVideoCarousel.find('[data-asin\x3d"'+b.contentId+'"]');return b.hasClass("vse-hidden")&&b.hasClass("vse-show-more")};this.showOrHideSearchButton=
function(b){b.showHotspots?(a.vars.showHotspots=!0,null==a.vars.visualSearchComponent&&(b=a.initializeVisualSearchComponent(),a.vars.visualSearchComponent=new ha(a,b),a.vars.visualSearchComponent.handleSearchButtonInteractions()),a.vars.visualSearchComponent.updateEducationalRules(),a.vars.A.$("#"+a.vars.templateId+" "+f.VIPSearchButtonSelector).show()):(a.vars.showHotspots=!1,a.vars.A.$("#"+a.vars.templateId+" "+f.VIPSearchButtonSelector).hide());!a.vars.A.objectIsEmpty(a.vars.visualSearchComponent)&&
a.vars.visualSearchComponent.isInVisualSearchMode()&&a.vars.visualSearchComponent.exitVisualSearchMode()};this.showLabel=function(b){if(b.labelDetails&&b.labelDetails.showLabel){if("videoType"===b.labelDetails.labelType){a.vars.isVideoTypeLabelPresent=!0;a.vars.isTimeoutComplete=!1;var c=a.vars.A.$("#"+a.vars.templateId+" "+f.LabelNameSelector);c.text(b.labelDetails.labelName);c.removeClass("aok-hidden");setTimeout(function(){c.addClass("aok-hidden");a.vars.isTimeoutComplete=!0;a.vars.cursorOnVideoPlayerDiv&&
c.removeClass("aok-hidden")},3E3);c.removeAttr("title");a.vars.A.off("a:popover:afterShow:ive-"+a.vars.clientPrefix+"-label-type-tooltip");a.vars.A.on("a:popover:afterShow:ive-"+a.vars.clientPrefix+"-label-type-tooltip",function(b){b.popover.$popover.bind("mouseenter touchstart focus",function(){a.vars.isFeedbackClosed&&a.showFeedbackLink(a.vars.feedbackContainer,a.vars.playerContainer)})});a.vars.A.off("a:popover:show:ive-"+a.vars.clientPrefix+"-label-type-tooltip");a.vars.A.on("a:popover:show:ive-"+
a.vars.clientPrefix+"-label-type-tooltip",function(a){var c=a.popover.$popover;a=c.find(""+f.LabelTooltipSelector);c=c.find(""+b.labelDetails.tooltipSelector);a.addClass("aok-hidden");c.removeClass("aok-hidden")})}"verifiedType"===b.labelDetails.labelType&&(a.vars.isVideoTypeLabelPresent=!1,a.dom.$wrapper.find(f.verifiedPurchaseLabel).removeClass("aok-hidden"),a.dom.$wrapper.find(f.verifiedPurchaseLabelDivider).removeClass("aok-hidden"))}else a.vars.isVideoTypeLabelPresent=!1,a.vars.A.$("#"+a.vars.templateId+
" "+f.LabelNameSelector).addClass("aok-hidden"),a.dom.$wrapper.find(f.verifiedPurchaseLabel).addClass("aok-hidden"),a.dom.$wrapper.find(f.verifiedPurchaseLabelDivider).addClass("aok-hidden")};this.getSegmentTypeIfMoreVideosToExpand=function(b){b=a.dom.$lbVideoCarousel.find('[data-asin\x3d"'+b.contentId+'"]');return a.vars.relatedVideosCarousel.getSegmentTypeFromElement(b)};this.getDefaultLangFromClosedCaptions=function(a){return a&&0<a.length?a[0].locale:null};this.updateClosedCaptions=function(b){a.vars.currentClosedCaptionsLang=
a.getDefaultLangFromClosedCaptions(b.closedCaptions);a.showOrHideClosedCaptions(b);a.vars.shouldHandleCCForLandscapeVideo=b.videoWidth!==u&&b.videoHeight!==u?b.videoWidth>b.videoHeight:!1};this.showOrHideClosedCaptions=function(b){b.closedCaptions&&0<b.closedCaptions.length?a.vars.A.$("#"+a.vars.templateId+" "+f.VIPCCButtonSelector).show():a.vars.A.$("#"+a.vars.templateId+" "+f.VIPCCButtonSelector).hide()};this.updateActiveVideoVoteContainer=function(b){a.vars.activeVideoVoteContainer.setPreviousVote(n.NONE_VOTE);
a.vars.activeVideoVoteContainer.setContentId(b.contentId);b.videoVoteContainer&&(a.vars.activeVideoVoteContainer.setVoteCount(n.POSITIVE_VOTE,b.videoVoteContainer.getVoteCount(n.POSITIVE_VOTE)),a.vars.activeVideoVoteContainer.setVoteCount(n.NEGATIVE_VOTE,b.videoVoteContainer.getVoteCount(n.NEGATIVE_VOTE)));a.fetchAndUpdateVoteCountAndStatus(b)};this.castVote=function(b){if(a.vars.videoVoteContainerFactory&&a.vars.videoVoteContainerFactory.videoVoteConfig){var c=a.vars.activeVideoVoteContainer.getPreviousVote(),
d=b===n.POSITIVE_VOTE&&c!=n.POSITIVE_VOTE,c=b===n.NEGATIVE_VOTE&&c!=n.NEGATIVE_VOTE;a.vars.activeVideoVoteContainer.updateWithNewVote(b);a.vars.videoVoteContainerFactory.sendVoteToRemote(d,c,a.vars.activeVideoVoteContainer.getContentId()).then(function(c){a.vars.videoVoteContainerFactory&&a.vars.videoVoteContainerFactory.videoVoteConfig&&a.vars.A.trigger(a.vars.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-vote-cast",b)},function(c){l.count(a.vars.clientPrefix+".videovote.votecastfailure",
1);a.vars.activeVideoVoteContainer.updateWithNewVote(b)})}};this.fetchAndUpdateVoteCountAndStatus=function(b){b.videoVoteContainer&&b.videoVoteContainer.getPreviousVote()!==n.EMPTY_STRING&&a.vars.activeVideoVoteContainer.setPreviousVote(b.videoVoteContainer.getPreviousVote());b.videoVoteContainer&&!b.videoVoteContainer.countsFetched&&a.vars.videoVoteContainerFactory.fetchVoteCountAndStatus(b.contentId).then(function(c){a.relatedVideosCarouselNotEmpty()&&-1!=a.vars.currentIndex&&a.updateVotingElementsForCountAndStatus(b,
c,!1);b.videoVoteContainer.setVoteCount(n.POSITIVE_VOTE,c.positiveVoteCount);b.videoVoteContainer.countsFetched=!0;a.vars.activeVideoVoteContainer.setVoteCount(n.POSITIVE_VOTE,c.positiveVoteCount);a.vars.activeVideoVoteContainer.countsFetched=!0;c=1===c.voteStatus?n.POSITIVE_VOTE:n.NONE_VOTE;a.vars.activeVideoVoteContainer.setPreviousVote(c);b.videoVoteContainer.setPreviousVote(c);a.vars.activeVideoVoteContainer.showOrHide(!0,!0,!0,!0)},function(b){l.count(a.vars.clientPrefix+".videovote.votecountandstatusfailure",
1);a.vars.A.trigger(a.vars.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-hide-votes")})};this.showRelatedProducts=function(b){a.fadeOutRelatedProductsContainer();var c=a.setRelatedProducts(b),d=b.productAsin;if(c!==u||b.relatedProductsWithSubstitute)a.retrieveRelatedProductsCarouselFromCache(b.contentId,d)!==u?a.getRelatedProductsFromCache(b.contentId,d):a.getRelatedProducts(1,c,b)};this.setRelatedProducts=function(b){return a.vars.A.objectIsEmpty(a.vars.firstRelatedProductOverride)?b.relatedProducts:
a.vars.A.objectIsEmpty(b.relatedProducts)?a.vars.firstRelatedProductOverride:a.vars.firstRelatedProductOverride+","+b.relatedProducts};this.getRelatedProducts=function(b,c,d){if(b>f.AJAX_MAX_RETRY_COUNT)a.handleGetRelatedProductsFailure();else{var k=!0;0<a.vars.relatedProductsNilgiriRequestCount&&(k=!1);var h=x.fetchLatestPageState(a.vars.A,a.vars.clientPrefix+"-related-products-request-ps");if(h){var p=h.componentConfiguration,n=h.pageContext;a.vars.showPFOOnOverlay=h.showPFOOnOverlay;a.vars.showPFOOnOverlay&&
(a.A.$("#"+a.vars.templateId+" "+f.VIPProductCarouselOverlaySelector).hide(),a.A.$("#"+a.vars.templateId+" "+f.RELATED_PRODUCTS_CONTAINER_SELECTOR).hide());a.vars.cacheOnProductAsin=h.cacheOnProductAsin;p&&n&&p.features&&p.features.features&&(n.metadata?n.metadata.relatedProductsAsins=c:n.metadata={relatedProductsAsins:c},h=a.vars.A.objectIsEmpty(a.vars.productAsin)?"":a.vars.productAsin,d.isSponsoredBrandVideo&&(p.features.features.hideSponsoredProducts="true",n.metadata.clickTrackerUrl=d.sponsoredBrandVideoMetadata?
d.sponsoredBrandVideoMetadata.clickTrackerUrl:""),d.relatedProductsWithSubstitute&&(n.metadata.relatedProductsWithSubstitute=d.relatedProductsWithSubstitute),d.refTag&&(n.metadata.refTag=d.refTag),k={pageContext:{page:n.page,placement:n.placement,marketplaceID:n.marketplaceID,locale:n.locale,customerId:n.customerId,requestId:n.requestId,product:{contentID:h,contentIDType:"ASIN"},metadata:n.metadata},configuration:{id:p.id,type:p.type,binder:p.binder,assets:k?["ProductCarousel"]:[],features:{features:p.features.features}}},
a.vars.relatedProductsRequest=k,a.vars.relatedProductsCarouselName=p.features.features.carouselName,a.vars.keepProductCarouselOpenOnClick=null!=p.features.features.keepProductCarouselOpenOnClick?p.features.features.keepProductCarouselOpenOnClick:!1,y.sendRequest(a.vars.A,""+f.VAP_EW+f.RELATED_PRODUCTS_ENDPOINT,k,function(b){-1!==b.indexOf(f.RELATED_PRODUCTS_INNER_CLASS_NAME)?(a.cacheRelatedProductsPayload(d.contentId,d.productAsin,b),a.handleGetRelatedProductsSuccess(d.contentId,d.productAsin),a.vars.$(a.dom.$wrapper).delegate(f.RELATED_PRODUCTS_ITEM_SELECTOR+
" a","click",function(b){a.vars.isMobile&&a.vars.isMshop&&b.preventDefault();b.stopPropagation();b.stopImmediatePropagation();var c=a.vars.$(b.target).closest("li").find(f.RELATED_PRODUCTS_ITEM_SELECTOR),d=c.attr("data-asin"),c=c.hasClass("vse-sponsor-product").toString();a.emitPFOClickMetric(f.METRIC_PFO_CLICK,d,c);d=a.vars.$(b.target).closest("li").find(".vse-carousel-item").attr("href");a.vars.enableClickBasedAttribution&&a.vars.player.getCurrentTime()<=f.CLICK_ATTRIBUTION_INITIAL_DELAY&&a.isOspEnabled(a.vars.currentAssetSpec)&&
(b.preventDefault(),b=a.vars.$(b.target).closest("li").find(f.RELATED_PRODUCTS_ITEM_SELECTOR+" a").attr(f.ATTR_ORIGINAL_HREF),a.vars.isMshop||a.vars.isVideoImmersivePlayer||m.open(b,"_blank"),d=b);a.openExternalLinkFromLightBox(d)}),a.vars.enableClickBasedAttribution&&(b=a.vars.$(a.dom.$wrapper).find(""+f.RELATED_PRODUCTS_ITEM_SELECTOR),a.disableRightClickOnPFOUntilRefParamsAreBound(b)),a.vars.isVideoImmersivePlayer?(a.vars.enableMultiplePFOImpressions||(a.A.$("#"+a.vars.templateId+" "+f.VIPProductCarouselViewportSelector).unbind("scroll"),
a.A.$("#"+a.vars.templateId+" "+f.VIPProductCarouselViewportSelector).bind("scroll",a.emitPFOImpressionMetricVIPHandler)),a.vars.showPFOOnOverlay&&(a.A.$("#"+a.vars.templateId+" "+f.VIPProductCarouselOverlaySelector).fadeIn(1E3),a.A.$("#"+a.vars.templateId+" "+f.RELATED_PRODUCTS_CONTAINER_SELECTOR).fadeIn(1E3),a.handleCCStylesOnCarouselVisibility(!0))):a.vars.enableMultiplePFOImpressions||(a.vars.A.off("a:carousel:"+a.vars.relatedProductsCarouselName+":init",a.emitPFOImpressionMetricInitHandler),
a.vars.A.on("a:carousel:"+a.vars.relatedProductsCarouselName+":init",a.emitPFOImpressionMetricInitHandler)),a.vars.A.objectIsEmpty(a.vars.A.$(f.LB_CAROUSEL_CONFIG).attr("data-configuration"))&&a.emitPFORenderMetric(f.METRIC_PFO_RENDER),l.count(a.vars.clientPrefix+":relatedproducts:load:success",1),a.vars.A.trigger(a.vars.clientPrefix+":relatedproducts:load:success"),a.vars.relatedProductsNilgiriRequestCount+=1):a.handleGetRelatedProductsFailure()},function(e){b+=1;a.getRelatedProducts(b,c,d)}))}else l.count(f.RELATED_PRODUCT_PAGE_STATE_NOT_FOUND_ERROR_KEY,
1)}};this.disableRightClickOnPFOUntilRefParamsAreBound=function(b){if(!b)return!1;a.vars.$(b).bind("contextmenu",function(b){return a.vars.player.getCurrentTime()<f.CLICK_ATTRIBUTION_INITIAL_DELAY?(b.preventDefault(),!1):!0})};this.bindClickAttributionToPFOs=function(b){return a.isOspEnabled(a.vars.currentAssetSpec)?b&&0<b.length?(b.each(function(c){c=a.A.$(b[c]);var d=c.attr("href");c.attr(f.ATTR_ORIGINAL_HREF,d);d={href:d,asin:a.vars.currentAssetSpec.productAsin||a.vars.productAsin,linkCode:a.vars.linkCode,
aciContentId:a.vars.currentAssetSpec.aciContentId||a.vars.aciContentId||a.getAciContentIdFromPlayerInstance(),vendorTrackingId:a.vars.currentAssetSpec.vendorTrackingId};d=(new Q(a.vars.A)).buildTag(d);c.attr("href",d)}),!0):!1:!1};this.getVideoToRelatedProductsDivId=function(b,c,d){b=a.vars.popoverId+"-"+d+a.sanitizeForCssSelector(b);a.vars.cacheOnProductAsin&&!a.vars.A.objectIsEmpty(c)&&(b+="-"+c);return b};this.sanitizeForCssSelector=function(a){return a.split(".").join("")};this.cacheRelatedProductsPayload=
function(b,c,d){b=a.getVideoToRelatedProductsDivId(b,c,f.PC_HIDDEN_CACHE_DIV_PREFIX);a.vars.$("#"+a.vars.popoverId+" "+f.CACHE_RP_PAYLOAD_HIDDEN_DIV_CONTAINER).append("\x3cdiv id\x3d'"+b+"'\x3e"+d+" \x3c/div\x3e")};this.retrieveRelatedProductsCarouselFromCache=function(b,c){b=a.getVideoToRelatedProductsDivId(b,c,f.PC_HIDDEN_CACHE_DIV_PREFIX);b=a.vars.$("#"+b+" "+f.RELATED_PRODUCTS_INNER_CONTAINER);if(b!==u&&b[0]!==u)return b[0].outerHTML};this.handleGetRelatedProductsSuccess=function(b,c){var d=a.retrieveRelatedProductsCarouselFromCache(b,
c);a.hideCurrentlyVisibleProductContainer();var k=a.getVideoToRelatedProductsDivId(b,c,f.VISIBLE_DIV_NARROW_PREFIX);a.vars.$("#"+a.vars.popoverId+" "+f.RELATED_PRODUCTS_CONTAINER_SELECTOR).append('\x3cdiv class\x3d"vse-pc-visible aok-hidden" id\x3d\''+k+"'\x3e"+d+"\x3c/div\x3e");a.vars.$("#"+a.vars.popoverId+" "+f.RELATED_PRODUCTS_CONTAINER_SELECTOR+" #"+k+" .a-carousel-left").attr("data-element-id",a.vars.clientPrefix+"-pc-left-button");a.vars.$("#"+a.vars.popoverId+" "+f.RELATED_PRODUCTS_CONTAINER_SELECTOR+
" #"+k+" .a-carousel-right").attr("data-element-id",a.vars.clientPrefix+"-pc-right-button");a.resizeLB();a.showRelatedProductCarousel(b,c);a.fadeInRelatedProductsContainer(b,c);a.vars.enableClickBasedAttribution&&(b=a.vars.$("#"+k).find(f.RELATED_PRODUCTS_ITEM_SELECTOR+" a"),a.bindClickAttributionToPFOs(b));a.vars.enableMultiplePFOImpressions&&(k=document.querySelectorAll("#"+a.vars.popoverId+" "+f.RELATED_PRODUCTS_CONTAINER_SELECTOR+" #"+k+" "+f.RELATED_PRODUCTS_ITEM_SELECTOR))&&m.IntersectionObserver&&
new H(null,k,a.onProductItemIntersectionObserved,a.vars.enableWidgetMetricsAfterOneSecond);a.setupKeyPressEventHandlerForRelatedProductsCarousel()};this.getRelatedProductsFromCache=function(b,c){a.hideCurrentlyVisibleProductContainer();a.showRelatedProductCarousel(b,c);a.fadeInRelatedProductsContainer(b,c)};this.hideCurrentlyVisibleProductContainer=function(){a.dom.$relatedProductContainer.find(".vse-pc-visible").addClass("aok-hidden");a.hideVIPProductCarouselEmptyViewContainer()};this.hideVIPProductCarouselEmptyViewContainer=
function(){a.vars.isVideoImmersivePlayer&&a.vars.A.$(f.VIPEmptyRelatedProductsContainerSelector).addClass("aok-hidden")};this.showVIPProductCarouselEmptyViewContainer=function(){a.vars.isVideoImmersivePlayer&&a.vars.A.$(f.VIPEmptyRelatedProductsContainerSelector).removeClass("aok-hidden")};this.showRelatedProductCarousel=function(b,c){a.vars.A.show(a.vars.$("#"+a.vars.popoverId+" "+f.RELATED_PRODUCTS_CONTAINER_SELECTOR));b=a.getVideoToRelatedProductsDivId(b,c,f.VISIBLE_DIV_NARROW_PREFIX);a.vars.$("#"+
b).removeClass("aok-hidden")};this.handleGetRelatedProductsFailure=function(){l.count(a.vars.clientPrefix+":relatedproducts:load:failed",1);a.vars.showLightboxV2Experience?a.vars.$(f.RELATED_PRODUCTS_CONTAINER_SELECTOR).css({visibility:"hidden"}):a.vars.A.hide(a.vars.$(f.RELATED_PRODUCTS_CONTAINER_SELECTOR));a.vars.isVideoImmersivePlayer&&(a.hideCurrentlyVisibleProductContainer(),a.showVIPProductCarouselEmptyViewContainer())};this.fadeOutRelatedProductsContainer=function(){a.vars.$(f.RELATED_PRODUCTS_CONTAINER_SELECTOR+
" "+f.RELATED_PRODUCTS_INNER_CONTAINER).fadeOut(0)};this.fadeInRelatedProductsContainer=function(b,c){b=a.getVideoToRelatedProductsDivId(b,c,f.VISIBLE_DIV_NARROW_PREFIX);a.vars.$("#"+b+" "+f.RELATED_PRODUCTS_INNER_CONTAINER).animate({opacity:1},0);a.vars.$(f.RELATED_PRODUCTS_CONTAINER_SELECTOR+" "+f.RELATED_PRODUCTS_INNER_CONTAINER).fadeIn(200)};this.toggleDisableFeedback=function(b){a.dom&&a.dom.$lbContainer&&a.dom.$lbContainer.toggleClass("disable-report",!!b)};this.showFeedbackLink=function(b,
c){a.vars.$(b).css({display:"inline-block"});a.toggleDimVideoPlayer(c,!0);b=a.vars.A.$("#"+a.vars.templateId+" "+f.LabelNameSelector);b.length&&a.vars.isVideoTypeLabelPresent&&b.removeClass("aok-hidden")};this.hideFeedbackLink=function(b,c){a.vars.$(b).css({display:"none"});a.toggleDimVideoPlayer(c,!1);b=a.vars.A.$("#"+a.vars.templateId+" "+f.LabelNameSelector);b.length&&a.vars.isVideoTypeLabelPresent&&a.vars.isTimeoutComplete&&b.addClass("aok-hidden")};this.toggleDimVideoPlayer=function(b,c){a.vars.$(b+
" video").toggleClass("dim-video-player",c)};this.deRegisterFeedback=function(b){a.vars.A.off("vse:"+b+":feedback:shown");a.vars.A.off("vse:"+b+":feedback:hidden");a.vars.A.off("vse:ns:feedback:"+b+":init:client")};this.setVideoDetails=function(b,c){a.vars.initialVideo={index:0,title:c.videoTitle,vendorName:c.vendorName,contentId:b,vendorCode:c.vendorCode,videoUrl:c.videoUrl,imageUrl:c.imageUrl,productAsin:c.productAsin,videoReferenceId:c.videoReferenceId,videoWidth:c.videoWidth,videoHeight:c.videoHeight,
seekTime:c.seekTime,aciContentId:c.aciContentId,showHotspots:c.showHotspots,labelDetails:c.labelDetails}};this.setFollowEntities=function(b,c){a.vars.A.objectIsEmpty(a.vars.initialVideo)||(a.vars.initialVideo.entityId=b,a.vars.initialVideo.entityType=c)};this.attachPlayerEventListeners=function(){a.vars.player&&(a.vars.player.on("playbackComplete",a._playbackCompleteHandler),a.vars.player.on("playbackStart",a._firstFrameHandler))};this.attachReviewsPlayerEventListeners=function(){if(a.vars.player)a.vars.player.on("playbackComplete",
a._reviewsPlaybackCompleteHandler)};this.removeUpNextComponent=function(){a.vars.upNextTimeoutHandle&&clearTimeout(a.vars.upNextTimeoutHandle);a.vars.intervalUserActivityHandlerId=a.userActivityCountDown();a.vars.A.show(a.vars.$("#"+a.vars.templateId+" "+f.videoInformationContainer));a.dom.$wrapper.find("."+f.UpNextElementClassName).addClass("vse-hidden");a.dom.$wrapper.find("."+f.UpNextClassName).removeClass(""+f.UpNextElementShownClassName);a.dom.$wrapper.find(f.VIPSkipBackButtonSelector).removeClass("aok-hidden");
a.dom.$wrapper.find(f.VIPSkipForwardButtonSelector).removeClass("aok-hidden");a.vars.$("#"+a.vars.templateId+" ."+f.UpNextCancelClassName).unbind("click");a.vars.vipPlayPauseToggle.toggleClass(f.VIPPlayIconClassName,a.vars.vipControlsShouldPause);a.vars.vipPlayPauseToggle.toggleClass(f.VIPPauseIconClassName,!a.vars.vipControlsShouldPause);a.vars.isUpNextComponentActive=!1};this._playUpNextHandler=function(){if(a.relatedVideosCarouselNotEmpty()){var b=a.getActiveAsset(),c=a._getNextAsset(b);c&&(a.vars.vipControlsShouldPause=
!1,a.vars.lightBoxPausedVideo=!1,a.removeUpNextComponent(),b.eventTimestamp&&(c.eventTimestamp=b.eventTimestamp),a.vars.player.play(c),a.emitThumbnailMetric(f.METRIC_UPNEXT_THUMBNAIL_IMPRESSION,c,a.vars.currentIndex),a.show(c),a.vars.currentAssetSpec=c,-1===a.vars.currentIndex&&(a.vars.currentIndex=0))}};this._cancelContinuousPlayHandler=function(){if(a.relatedVideosCarouselNotEmpty()){var b=a.getActiveAsset();a.vars.player.loadNextVideoPoster(b.imageUrl);a.vars.vipControlsShouldPause=!0;a.removeUpNextComponent();
a.vars.vipControlsShouldPause=!1;a.vars.lightBoxPausedVideo=!0}};this.continuousPlay=function(b,c){b.eventTimestamp&&(c.eventTimestamp=b.eventTimestamp);a.refTagRecorder.emitRefTag(c.continuousPlayRefTag);null!=a.vars.onSiteAttributionMetrics&&a.vars.A.trigger("vse:"+a.vars.clientPrefix+":player:continuous:play");a.vars.currentIndex=a.findIndex(c);a.vars.player.play(c);a.vars.isVideoImmersivePlayer&&a.emitThumbnailMetric(f.METRIC_UPNEXT_THUMBNAIL_IMPRESSION,c,a.vars.currentIndex);!a.vars.A.objectIsEmpty(a.vars.relatedVideosCarousel)&&
a.hasHiddenAndShowMoreClasses(c)&&a.vars.relatedVideosCarousel.loadMoreVideos(a.getSegmentTypeIfMoreVideosToExpand(c));a.show(c)};this._playbackCompleteHandler=function(){if(a.relatedVideosCarouselNotEmpty()&&"inline"!=a.vars.currentPlayerMode){var b=a.getActiveAsset(),c=a._getNextAsset(b);c?a.vars.useUpNextComponent?(a.vars.isUpNextComponentActive=!0,a.vars.vipControlsShouldPause=!0,a.vars.lightBoxPausedVideo=!0,a.clearIntervalUserActivityHandler(),a.dom.$wrapper.find(f.VIPSkipBackButtonSelector).addClass("aok-hidden"),
a.dom.$wrapper.find(f.VIPSkipForwardButtonSelector).addClass("aok-hidden"),a.vars.vipPlayPauseToggle.toggleClass(f.VIPPlayIconClassName,a.vars.vipControlsShouldPause),a.vars.vipPlayPauseToggle.toggleClass(f.VIPPauseIconClassName,!a.vars.vipControlsShouldPause),a.vars.A.hide(a.vars.$("#"+a.vars.templateId+" "+f.videoInformationContainer)),a.vars.vipControlsShouldPause=!1,a.vars.lightBoxPausedVideo=!1,a.vars.player.loadNextVideoPoster(c.imageUrl),a.dom.$wrapper.find("."+f.UpNextVideoTitleClassName).html(c.title),
a.dom.$wrapper.find("."+f.UpNextAuthorClassName).html(c.vendorName),a.dom.$wrapper.find("."+f.UpNextElementClassName).removeClass("vse-hidden"),a.dom.$wrapper.find("."+f.UpNextClassName).addClass(""+f.UpNextElementShownClassName),a.vars.$("#"+a.vars.templateId+" ."+f.UpNextCancelClassName).click(a._cancelContinuousPlayHandler),a.showVideoImmersivePlayerOverlay(),a.resetUserActivityTimer(-2),a.vars.upNextTimeoutHandle=a.vars.A.delay(function(){a.removeUpNextComponent();a.continuousPlay(b,c);a.vars.currentAssetSpec=
c;-1===a.vars.currentIndex&&(a.vars.currentIndex=0)},5E3)):a.continuousPlay(b,c):a.noNextVideoHandler()}else a.noNextVideoHandler()};this._reviewsPlaybackCompleteHandler=function(){a.dom.$wrapper.find(f.VIPTimeRemainingSelector).text("-0:00")};this._firstFrameHandler=function(){!a.vars.showMoreMenuExperience&&a.vars.isMobile&&a.hideFeedbackLink("#vse-"+a.vars.clientPrefix+"-feedback-container","#"+a.vars.containerId+"-container");a.vars.isVideoImmersivePlayer&&(a.vars.player.getMediaDuration()!==
a.vars.vipVideoDuration&&(a.vars.vipVideoDuration=a.vars.player.getMediaDuration()),a.vars.vipControlsShouldPause=!0,a.vars.vipPlayPauseToggle.toggleClass(f.VIPPauseIconClassName,a.vars.vipControlsShouldPause),a.vars.vipPlayPauseToggle.toggleClass(f.VIPPlayIconClassName,!a.vars.vipControlsShouldPause))};this._getNextAsset=function(b){for(var c=0;c<a.vars.playlist.length&&a.vars.playlist[c].contentId!=b.contentId;c++);if(c!=a.vars.playlist.length)return a.vars.playlist[c+1];if(-1===a.vars.currentIndex)return a.vars.playlist[0]};
this._playerFailedAutoplayHandler=function(){a.vars.vipControlsShouldPause=!1;a.toggleVipPlayPauseClass();a.vars.vipVideoDuration=a.vars.player.getMediaDuration();a.updateProgressBarAndTimeDisplay();a.vars.customerReviewsConfig&&a.vars.customerReviewsConfig.showCustomerReviewMetadata&&(a.handleUserActivity(),a.handleCCStylesOnReviewsOverlayVisibility(!0));l.count(f.AUTOPLAY_FALLBACK_EXECUTED,1)};this._playerSucceededAutoplayHandler=function(){a.clearIntervalUserActivityHandler();a.vars.intervalUserActivityHandlerId=
a.userActivityCountDown();a.vars.vipPlayIconClicked=!0;a.vars.useAutoplayFallback=!1;a.vars.customerReviewsConfig&&a.vars.customerReviewsConfig.showCustomerReviewMetadata&&a.handleCCStylesOnReviewsOverlayVisibility(!0)};this.handleCCStylesOnCarouselVisibility=function(b){a.A.$("#"+a.vars.templateId+" .vjs-text-track-display").toggleClass(f.VIPProductCarouselOpenedClassName,b)};this.handleCCStylesOnReviewsOverlayVisibility=function(b){a.A.$("#"+a.vars.templateId+" .vjs-text-track-display").toggleClass(f.VIPReviewsOverlayVisibleClassName,
b)};this.onPlayerTapHandler=function(){"inline"!==a.vars.currentPlayerMode&&(a.vars.showPFOOnOverlay&&a.handleCCStylesOnCarouselVisibility(!0),a.showVideoImmersivePlayerOverlay(),a.resetUserActivityTimer())};this.pauseVideoIfNeeded=function(){a.vars.player&&a.vars.player.isPlaying()&&(a.vars.player.pause(a.vars.isVideoImmersivePlayer?"ivx-pause":u),a.vars.lightBoxPausedVideo=!0,a.vars.isVideoImmersivePlayer&&a.vars.isVIPOverlayTimerSet&&a.clearIntervalUserActivityHandler())};this.muteUnMuteVideo=
function(){a.vars.player&&!a.vars.player.isMuted()?a.vars.player.mute():a.vars.player.unmute();a.updateAudioToggleStatus()};this.updateAudioToggleStatus=function(){a.vars.player&&a.vars.vipMuteUnmuteToggle&&(a.vars.vipMuteUnmuteToggle.toggleClass(f.VIPMuteIconClassName,a.vars.player.isMuted()),a.vars.vipMuteUnmuteToggle.toggleClass(f.VIPUnmuteIconClassName,!a.vars.player.isMuted()))};this.resumeVideoIfNeeded=function(b){if(!a.vars.lightboxOpened&&!0!==b)return!1;a.vars.player&&a.vars.player.isPlaying()&&
(a.vars.player.pause(a.vars.isVideoImmersivePlayer?"ivx-pause":u),a.vars.lightBoxPausedVideo=!0);a.vars.player&&!a.vars.player.isPlaying()&&!a.vars.isContinuousPlayFinished&&a.vars.lightBoxPausedVideo?(a.vars.player.resume(Date.now()),a.vars.isVideoImmersivePlayer&&!a.vars.isVIPOverlayTimerSet&&(a.resetUserActivityTimer(),a.showVideoImmersivePlayerOverlay(),a.vars.intervalUserActivityHandlerId=a.userActivityCountDown())):a.vars.useAutoplayFallback&&(a.startPlaying(a.vars.currentAssetSpec),a.vars.intervalUserActivityHandlerId=
a.userActivityCountDown(),a.vars.vipPlayIconClicked=!0,a.vars.isClosedCaptionEnabled&&a.vars.player.enableCurrentTextTrack(a.vars.currentClosedCaptionsLang),a.vars.useAutoplayFallback=!1);a.vars.isVideoImmersivePlayer&&a.vars.isContinuousPlayFinished&&(a.relatedVideosCarouselNotEmpty()&&a.vars.initialVideo?(a.startPlaying(a.vars.initialVideo),a.show(a.vars.initialVideo)):a.vars.currentAssetSpec&&(a.startPlaying(a.vars.currentAssetSpec),a.resetUserActivityTimer(),a.showVideoImmersivePlayerOverlay(),
a.vars.intervalUserActivityHandlerId=a.userActivityCountDown()));a.vars.lightBoxPausedVideo=!1};this.noNextVideoHandler=function(){a.vars.isVideoImmersivePlayer&&(a.clearIntervalUserActivityHandler(),a.vars.lightBoxPausedVideo=!0,a.vars.vipControlsShouldPause=!1,a.vars.vipPlayPauseToggle.toggleClass(f.VIPPauseIconClassName,a.vars.vipControlsShouldPause),a.vars.vipPlayPauseToggle.toggleClass(f.VIPPlayIconClassName,!a.vars.vipControlsShouldPause),a.showVideoImmersivePlayerOverlay());a.vars.isContinuousPlayFinished=
!0};this.initializeVisualSearchComponent=function(){return{A:a.A,templateId:a.vars.templateId}};this.setInitialClosedCaptions=function(b,c){c=ma.getClosedCaptions(a.vars.A,c);b.closedCaptions=c;a.vars.initialVideo.closedCaptions=c;a.vars.currentClosedCaptionsLang=a.getDefaultLangFromClosedCaptions(c)};this.setupVIPClosedCaptions=function(b,c){if("inline"!==a.vars.currentPlayerMode){a.vars.closedCaptionsConfig=b;var d="#"+a.vars.templateId+" "+f.VIPCCButtonSelector;a.vars.A.$(d+"."+f.VIPCCButtonUnpressedClassName).live("click",
function(){a.vars.isClosedCaptionEnabled=!0;a.vars.customerReviewsConfig&&a.vars.customerReviewsConfig.showCustomerReviewMetadata&&a.A.$("#"+a.vars.templateId+" .vjs-text-track-display").toggleClass(f.VIPLandscapeVideoClassName,a.vars.shouldHandleCCForLandscapeVideo);a.vars.A.$(""+d).removeClass(f.VIPCCButtonUnpressedClassName).addClass(f.VIPCCButtonPressedClassName);a.vars.player.enableCurrentTextTrack(a.vars.currentClosedCaptionsLang);a.showTempCCPopup(a.getCurrentCaptionsOnText())});a.vars.A.$(d+
"."+f.VIPCCButtonPressedClassName).live("click",function(){a.vars.isClosedCaptionEnabled=!1;a.vars.A.$(""+d).removeClass(f.VIPCCButtonPressedClassName).addClass(f.VIPCCButtonUnpressedClassName);a.vars.player.disableCurrentTextTrack(a.vars.currentClosedCaptionsLang);a.showTempCCPopup(b.captionsOffText)});a.vars.A.objectIsEmpty(c)&&a.vars.A.$(""+d).hide()}};this.getCurrentCaptionsOnText=function(){var b=a.vars.closedCaptionsConfig.captionsOnTexts,c=a.vars.currentClosedCaptionsLang;return a.vars.A.objectIsEmpty(b)||
a.vars.A.objectIsEmpty(b[c])?f.EMPTY_STRING:b[c]};this.showTempCCPopup=function(b){a.vars.A.$("#"+a.vars.templateId+" "+f.VIPCCTooltipTextSelector).text(b);a.vars.A.$("#"+a.vars.templateId+" "+f.VIPCCTooltipSelector).removeClass("aok-hidden");clearTimeout(a.vars.closedCaptionsTooltipTimerId);a.vars.closedCaptionsTooltipTimerId=setTimeout(function(){return a.vars.A.$("#"+a.vars.templateId+" "+f.VIPCCTooltipSelector).addClass("aok-hidden")},3E3)};this.setupDefaultClosedCaptions=function(){a.vars.A.$("#"+
a.vars.templateId+" "+f.defaultPlayerCCButtonTitleSelector).removeAttr("title")};this.onTextTrackEnable=function(b){if("inline"!==a.vars.currentPlayerMode){var c="#"+a.vars.templateId+" "+f.VIPCCButtonSelector;"showing"===b.mode&&a.vars.A.$(""+c).hasClass(f.VIPCCButtonUnpressedClassName)&&(a.vars.isClosedCaptionEnabled=!0,a.vars.customerReviewsConfig&&a.vars.customerReviewsConfig.showCustomerReviewMetadata&&a.A.$("#"+a.vars.templateId+" .vjs-text-track-display").toggleClass(f.VIPLandscapeVideoClassName,
a.vars.shouldHandleCCForLandscapeVideo),a.vars.A.$(""+c).removeClass(f.VIPCCButtonUnpressedClassName).addClass(f.VIPCCButtonPressedClassName))}};this.getDomain=function(){return a.vars.A.objectIsEmpty(m.location.origin)?"https://www.amazon.com":m.location.origin};this.buildShareUrl=function(b){return a.getDomain()+(b.isSponsoredBrandVideo&&b.sponsoredBrandVideoMetadata?b.sponsoredBrandVideoMetadata.linkUrl:"/vdp/"+b.contentId)};this.refreshSocialSharePageState=function(b){var c=a.buildShareUrl(b);
a.vars.A.objectIsEmpty(a.vars.productAsin)||(c+="?product\x3d"+a.vars.productAsin);a.vars.A.state.replace(a.vars.socialSharePageState,{pageLevelData:{clientRef:"ib",deviceTypeRef:a.vars.isMobile?"mb":"dt"},url:c,image:b.imageUrl,title:b.title,description:b.title})};this.getMshopShareParams=function(b){var c=a.buildShareUrl(b)+"?ref\x3dive_share_mshop_"+a.vars.clientPrefix;b=b.title+" "+c;var d="\x3cdiv\x3e \x3cp\x3e"+b+"\x3c/p\x3e \x3c/div\x3e";return{subject:b,messagePlain160:b.substring(0,160),
messagePlain140:b.substring(0,140),messageHTML:d,messagePlain:b,url:c}};this.getDomElements=function(b,c){a.dom.$wrapper=a.vars.$("#"+b+" #"+c);a.dom.$lbContainer=a.dom.$wrapper.find(".vse-lb-container");a.dom.$lbLeftColumn=a.dom.$wrapper.find(".vse-lb-left");a.dom.$lbRightColumn=a.dom.$wrapper.find(".vse-lb-right");a.dom.$lbCCHeader=a.dom.$wrapper.find(".vse-cc-header");a.dom.$lbTabContainer=a.dom.$wrapper.find(".vse-lightbox-tab");a.dom.$videoAuthor=a.dom.$wrapper.find(".vse-video-author span");
a.dom.$mobileFixedContainer=a.dom.$wrapper.find(".vse-common-mobile-fixed-container");a.dom.$mobileMovableContainer=a.dom.$wrapper.find(".vse-vb-movable-container");a.dom.$relatedProductContainer=a.dom.$wrapper.find(".vse-related-products-narrow");a.dom.$activeVideoOspLink=a.dom.$wrapper.find(".vse-oap-link");a.dom.$activeVideoTitlePrefix=a.dom.$wrapper.find(".vse-title-prefix");a.dom.$activeVideoCRLink=a.dom.$wrapper.find(".vse-cr-link");a.dom.$activeVideoCRLinkWrapper=a.dom.$wrapper.find(".video-title-container-right");
a.dom.$followButtonSelector=a.dom.$wrapper.find(f.followButton);a.dom.$vseFollowClassSelector=a.dom.$wrapper.find(f.vseFollowClass);a.dom.$followEligibleCreator=a.dom.$wrapper.find(f.creatorAndDisclosure)};this.getCustomerProfileDomElements=function(){a.dom.$lbVideoCarousel=a.vars.isVideoImmersivePlayer?a.dom.$wrapper.find(".vse-vip-lb-carousel"):a.dom.$wrapper.find(".vse-related-videos-container");a.dom.$activeVideoCustomerProfile=a.dom.$wrapper.find("#vse-active-video-customer-profile");a.dom.$activeCrvMetadataContainer=
a.dom.$wrapper.find(".vse-active-crv-metadata");a.dom.$videoAuthorBlock=a.dom.$wrapper.find(".vse-video-author");a.dom.$customerProfileContainer=a.dom.$wrapper.find(".vse-cp-container");a.dom.$profileLinkSelector=a.dom.$wrapper.find(".vse-profile");a.dom.$vseOapDivider=a.dom.$wrapper.find(".vse-oap-divider");a.dom.$creatorNameAndDisclosure=a.dom.$wrapper.find(".vse-creator-name-and-disclosure")};this.shouldSetProductCarouselWidth=function(b){var c=a.dom.$wrapper.find(".vse-lb-right .vse-related-videos-container .a-carousel-row").height();
return a.vars.A.isFiniteNumber(c)?c<b?!0:!1:!1};this.resizeDesktopLB=function(){var b=a.dom.$lbLeftColumn.outerHeight(!0);if(!a.isDesktopVerticalLightBox()){var c=m.innerHeight-a.dom.$wrapper.closest(f.LightboxWrapperSelector).outerHeight();0<c&&a.dom.$wrapper.closest(f.LightboxWrapperSelector).animate({marginTop:c/2+"px",marginBottom:c/2+"px",top:0},0)}0<a.vars.$("#"+a.vars.templateId+" "+f.RELATED_PRODUCTS_CONTAINER_SELECTOR).length?!a.vars.showLightboxV2Experience&&a.shouldSetProductCarouselWidth(b-
a.vars.relatedProductsContainerFixedHeight)?(a.vars.$("#"+a.vars.templateId+" "+f.RELATED_PRODUCTS_CONTAINER_SELECTOR).width(a.dom.$lbContainer.outerWidth()),c=b-a.vars.relatedProductsContainerFixedHeight):(a.vars.$("#"+a.vars.templateId+" "+f.RELATED_PRODUCTS_CONTAINER_SELECTOR).removeAttr("style"),c=b):(b=a.dom.$lbTabContainer.length?a.dom.$lbTabContainer.outerHeight(!0):0,c=b=a.vars.$("#"+a.vars.popoverId).height()-(a.dom.$lbContainer.outerHeight(!0)-a.dom.$lbContainer.innerHeight())-b);a.vars.showLightboxV2Experience&&
(a.isDesktopVerticalLightBox()?(a.toggleLightboxCloseButton(!1),a.hideFeedbackLink(a.vars.feedbackContainer,a.vars.playerContainer),c=b,a.dom.$lbRightColumn.css({height:"unset"})):(a.toggleLightboxCloseButton(!0),a.dom.$lbRightColumn.css({height:b})));a.dom.$lbRightColumn.css({"max-height":c});a.vars.setMaxHeightToLBLeftColumn&&(b=a.dom.$lbTabContainer.length?a.dom.$lbTabContainer.outerHeight(!0):0,b=a.vars.$("#"+a.vars.popoverId).height()-(a.dom.$lbContainer.outerHeight(!0)-a.dom.$lbContainer.height())-
b,a.dom.$lbLeftColumn.css({"max-height":b}));!a.vars.A.capabilities.mobile&&a.vars.A.capabilities.touch&&(a.toggleLightboxCloseButton(!0),a.dom.$wrapper.closest(f.LightboxWrapperSelector).addClass(f.TABLET_LIGHTBOX_CLASS_NAME),a.dom.$wrapper.closest(f.LightboxWrapperSelector).find(f.AUI_POPOVER_INNER).addClass(f.TABLET_LIGHTBOX_CLASS_NAME))};this.resizeMobileLB=function(){a.dom.$lbContainer.height(m.innerHeight);var b=a.vars.$(a.dom.$mobileFixedContainer).outerHeight(!0),b=a.vars.$(m).height()-b;
a.vars.$(a.dom.$mobileMovableContainer).animate({"max-height":b})};this.resizeLB=function(){a.vars.isMobile?a.resizeMobileLB():a.resizeDesktopLB()};this.resetCarouselWithSeeMore=function(){a.vars.A.objectIsEmpty(a.vars.relatedVideosCarousel)||a.vars.relatedVideosCarousel.resetVideosStateOnLightboxReopen()};this.isOspEnabled=function(b){return!a.vars.A.objectIsEmpty(b.vendorTrackingId)&&""!==b.vendorTrackingId};this.showVideoImmersivePlayerOverlay=function(){a.dom.$wrapper.find(f.VIPOverlaySelector).addClass(f.VIPOverlayShowClassName);
a.dom.$wrapper.find(f.VIPSearchButtonSelector).removeClass(f.VIPSearchButtonHideText);a.vars.customerReviewsConfig&&a.vars.customerReviewsConfig.showCustomerReviewMetadata&&a.handleCCStylesOnReviewsOverlayVisibility(!0)};this.hideVideoImmersivePlayerOverlay=function(){a.vars.useMultiCarousel&&a.vars.multiCarouselExpanded&&a.openCloseMultiCarousel();a.vars.showPFOOnOverlay&&a.handleCCStylesOnCarouselVisibility(!1);a.vars.customerReviewsConfig&&a.vars.customerReviewsConfig.showCustomerReviewMetadata&&
a.handleCCStylesOnReviewsOverlayVisibility(!1);a.dom.$wrapper.find(f.VIPSearchButtonSelector).addClass(f.VIPSearchButtonHideText);a.dom.$wrapper.find(f.VIPOverlaySelector).removeClass(f.VIPOverlayShowClassName)};this.setUserActivityTimer=function(b){a.vars.$(b.target).hasClass(f.VIPOverlayShowClassName)||a.vars.$(b.target).hasClass(f.UpNextClassName)||a.vars.$(b.target).hasClass(f.VIPMetadataClassName)||a.vars.$(b.target).hasClass(f.VIPVideoInfoClassName)||a.vars.$(b.target).hasClass(f.VIPVideoAgeClassName)||
a.vars.$(b.target).hasClass(f.VIPVideoTitleWrapperClassName)||a.vars.$(b.target).hasClass(f.VIPVideoHelpfulVotesClassName)||a.vars.$(b.target).hasClass(f.VIPPlayPauseClassName)||a.vars.$(b.target).hasClass(f.VIPScrubberClassName)?(a.hideVideoImmersivePlayerOverlay(),a.vars.isMultiCarouselClosedForFirstTime&&a.vars.showHotspots&&a.vars.visualSearchComponent.addAnimationForHotspotsVideo()):a.resetUserActivityTimer()};this.resetUserActivityTimer=function(b){void 0===b&&(b=0);a.vars.useAllIVXComponents&&
(a.vars.secondsFromLastActivity=b)};this.handleUserActivityForReviewsUsecase=function(b){a.isReviewTextExpanded()?a.isTargetOutsideExpandedReviewsMetadata(b)&&(a.A.$(f.VIPOverlaySelector).removeClass("vse-reviews-expand-full-cr"),a.A.$(".vse-reviews-content-ellipsis-wrapper").scrollTop(0),a.resetReviewTextStyle(),a.A.animationFrameDelay(function(){a.compactReviewIfNeeded();a.updateReviewsExpandButtonVisibility()}),a.vars.vipControlsShouldPause&&a.resumeVideoIfNeeded()):a.vars.useAutoplayFallback||
a.vars.vipControlsShouldPause&&a.setUserActivityTimer(b)};this.handleUserActivity=function(){!a.vars.isVIPOverlayOnTapEventRegistered&&a.vars.$(""+a.vars.popoverId)&&(a.dom.$lbContainer.click(function(b){a.vars.customerReviewsConfig&&a.vars.customerReviewsConfig.showCustomerReviewMetadata?a.handleUserActivityForReviewsUsecase(b):a.setUserActivityTimer(b)}),a.vars.isVIPOverlayOnTapEventRegistered=!0)};this.userActivityCountDown=function(){if(a.vars.useAllIVXComponents)return a.vars.intervalUserActivityHandlerId=
a.vars.A.interval(function(){a.vars.multiCarouselExpanded||(a.vars.secondsFromLastActivity++,3<a.vars.secondsFromLastActivity&&a.hideVideoImmersivePlayerOverlay())},1E3),a.vars.isVIPOverlayTimerSet=!0,a.handleUserActivity(),a.vars.intervalUserActivityHandlerId};this.clearIntervalUserActivityHandler=function(){a.vars.isVIPOverlayTimerSet=!1;clearInterval(a.vars.intervalUserActivityHandlerId)};this.emitMetric=function(b){a.emitMetricToNexus({eventName:b,stringPayload:f.EMPTY_STRING,intPayload:1})};
this.emitClickMetric=function(b,c){void 0===c&&(c="");b={eventName:b,stringPayload:f.EMPTY_STRING,intPayload:1,videoAsin:a.getVideoAsin(),rankingStrategy:a.getRankingStrategy(),groupType:""!==c?c:a.getGroupType()};a.emitMetricToNexus(b)};this.emitEventDurationMetric=function(b,c){b={eventName:b,stringPayload:f.EMPTY_STRING,intPayload:c,videoAsin:a.getVideoAsin(),rankingStrategy:a.getRankingStrategy()};a.emitMetricToNexus(b)};this.emitRelatedVideosRenderMetric=function(b,c){a.vars.A.objectIsEmpty(c)||
(b={eventName:b,stringPayload:f.EMPTY_STRING,intPayload:1,videoAsinList:c.getplaylist().map(function(a){return a.contentId+f.COMMA+a.groupType}).join(f.SEMICOLON),rankingStrategy:c.getplaylist().map(function(a){return a.rankingStrategy}).join(f.SEMICOLON)},a.emitMetricToNexus(b))};this.emitPFOClickMetric=function(b,c,d){a.vars.emitMetricsToNexus&&(b=a.vars.buildNexusPayload({eventName:b,stringPayload:d.toString(),intPayload:1,productAsin:c,videoAsin:a.getVideoAsin(),rankingStrategy:a.getRankingStrategy()}),
l.emitNexusMetric(b,a.vars.nexusMetricsConfig.producerId,a.vars.nexusMetricsConfig.widgetMetricsSchemaId,a.vars.nexusMetricsConfig.isInternal))};this.emitPFORenderMetric=function(b){a.A.off(" "+a.vars.clientPrefix+":relatedproducts:load:success");a.A.on(" "+a.vars.clientPrefix+":relatedproducts:load:success",function(){for(var c=a.A.$("#"+a.vars.templateId+" .vse-pc-visible").not(".aok-hidden").find(".vse-product-item"),d="",k=a.getVideoAsin(),h=[],l=0;l<c.length;l++)h.push([c[l].getAttribute("data-asin"),
c[l].classList.contains("vse-sponsor-product").toString(),!1]),d+=c[l].getAttribute("data-asin")+","+c[l].classList.contains("vse-sponsor-product").toString(),l!==c.length-1&&(d+=f.SEMICOLON);a.vars.contentIdProductAsinMap[k]=h;a.vars.emitMetricsToNexus&&(c={eventName:b,stringPayload:d.toString(),intPayload:1,videoAsin:k,rankingStrategy:a.getRankingStrategy(),groupType:a.getGroupType()},a.emitMetricToNexus(c))})};this.getVideoAsin=function(){return a.vars.currentAssetSpec&&a.vars.currentAssetSpec.contentId?
a.vars.currentAssetSpec.contentId:a.relatedVideosCarouselNotEmpty()?a.getCurrentlyPlayingVideoInCarousel(a.vars.currentIndex).contentId:f.EMPTY_STRING};this.getRankingStrategy=function(){return a.vars.currentAssetSpec&&a.vars.currentAssetSpec.rankingStrategy?a.vars.currentAssetSpec.rankingStrategy:a.relatedVideosCarouselNotEmpty()?a.getCurrentlyPlayingVideoInCarousel(a.vars.currentIndex).rankingStrategy:a.vars.rankingStrategy};this.getGroupType=function(){return a.vars.currentAssetSpec&&a.vars.currentAssetSpec.groupType?
a.vars.currentAssetSpec.groupType:a.relatedVideosCarouselNotEmpty()?a.getCurrentlyPlayingVideoInCarousel(a.vars.currentIndex).groupType:f.EMPTY_STRING};this.emitPFOImpressionMetric=function(b,c,d,f){a.vars.emitMetricsToNexus&&(b={eventName:b,stringPayload:d.toString(),intPayload:f,productAsin:c,videoAsin:a.getVideoAsin(),rankingStrategy:a.getRankingStrategy()},a.emitMetricToNexus(b))};this.emitThumbnailMetric=function(b,c,d){void 0===d&&(d=1);a.vars.emitMetricsToNexus&&(b=a.vars.buildNexusPayload({eventName:b,
stringPayload:f.EMPTY_STRING,intPayload:d,productAsin:c.productAsin,videoAsin:c.contentId,rankingStrategy:c.rankingStrategy,groupType:c.groupType}),l.emitNexusMetric(b,a.vars.nexusMetricsConfig.producerId,a.vars.nexusMetricsConfig.widgetMetricsSchemaId,a.vars.nexusMetricsConfig.isInternal))};this.emitButtonImpressionMetric=function(b,c,d){void 0===d&&(d=1);a.vars.emitMetricsToNexus&&(b=a.vars.buildNexusPayload({eventName:b,stringPayload:f.EMPTY_STRING,intPayload:d,rankingStrategy:a.getRankingStrategy(),
groupType:c}),l.emitNexusMetric(b,a.vars.nexusMetricsConfig.producerId,a.vars.nexusMetricsConfig.widgetMetricsSchemaId,a.vars.nexusMetricsConfig.isInternal))};this.emitPFOImpressionMetricHandler=function(b,c,d){var f=a.getVideoAsin(),h=a.vars.contentIdProductAsinMap[f];if(h){for(;b<Math.min(c,h.length);b++)h[b][2]||(a.emitPFOImpressionMetric(d,h[b][0],h[b][1],b),h[b][2]=!0);a.vars.contentIdProductAsinMap[f]=h}};this.emitPFOImpressionMetricVIPHandler=function(){var b=a.A.$("#"+a.vars.templateId+" .vse-pc-visible .a-carousel-viewport").not(".aok-hidden"),
c=b.find(".vse-product-item").first(),b=m.innerWidth>m.innerHeight?Math.floor((b.scrollTop()+m.innerHeight)/c.height()):Math.floor((b.scrollLeft()+m.innerWidth)/c.width());a.emitPFOImpressionMetricHandler(0,b,f.METRIC_PFO_IMPRESSION)};this.emitPFOImpressionMetricDefaultHandler=function(b){var c=b.carousel.getAttr("pageNumber");b=b.carousel.getAttr("pageSize");a.emitPFOImpressionMetricHandler((c-1)*b,c*b,f.METRIC_PFO_IMPRESSION)};this.emitPFOImpressionMetricInitHandler=function(b){a.vars.A.off("a:carousel:"+
a.vars.relatedProductsCarouselName+":change:pageNumber",a.emitPFOImpressionMetricDefaultHandler);a.vars.A.on("a:carousel:"+a.vars.relatedProductsCarouselName+":change:pageNumber",a.emitPFOImpressionMetricDefaultHandler);a.emitPFOImpressionMetricDefaultHandler(b)};this.handleWatchIconMetric=function(){var b=function(b){a.vars.manualTriggerWatchIcon||a.emitClickMetric(f.METRIC_WATCH_ICON);a.vars.useMultiCarousel&&!a.vars.multiCarouselExpanded&&(a.resetUserActivityTimer(-2),setTimeout(function(){return a.openCloseMultiCarousel()},
750))};a.A.$("#"+a.vars.templateId+" "+f.VIPWatchIconSelector+".vse-unpressed").click(b);a.A.$("#"+a.vars.templateId+" "+f.VIPWatchIconSelector+".vse-pressed").click(b)};this.handleShopIconMetric=function(){var b=function(b){a.vars.manualTriggerShopIcon||a.emitClickMetric(f.METRIC_SHOP_ICON)};a.A.$("#"+a.vars.templateId+" "+f.VIPShopIconSelector+".vse-unpressed").click(b);a.A.$("#"+a.vars.templateId+" "+f.VIPShopIconSelector+".vse-pressed").click(b)};this.handleShareIconMetric=function(){a.A.on("a:sheet:beforeShow:"+
a.vars.socialShareId+"-sheet",function(){a.emitClickMetric(f.METRIC_SHARE_ICON)})};this.handleInfluencerProfileNameClick=function(){a.dom.$activeVideoCustomerProfile.find(".a-profile-name").unbind("click");a.dom.$activeVideoCustomerProfile.find(".a-profile-name").click(function(){l.count(a.vars.clientPrefix+".influencerProfileNameClickCount",1)})};this.handleInfluencerAvatarClick=function(){a.dom.$activeVideoCustomerProfile.find(".a-profile-avatar").unbind("click");a.dom.$activeVideoCustomerProfile.find(".a-profile-avatar").click(function(){l.count(a.vars.clientPrefix+
".influencerAvatarClick",1)})};this.getDeviceOrientation=function(){return m.innerHeight>m.innerWidth?f.PORTRAIT:m.innerWidth>m.innerHeight?f.LANDSCAPE:f.SQUARE};this.getAspectRatio=function(a){if(a===f.PORTRAIT)return f.PORTRAIT_ASPECT_RATIO;if(a===f.LANDSCAPE)return f.LANDSCAPE_ASPECT_RATIO;if(a===f.SQUARE)return f.SQUARE_ASPECT_RATIO};this.isDesktopVerticalLightBox=function(){return!a.vars.isMobile&&m.innerWidth<a.vars.verticalLightBoxMaxWidth};this.attachStickyHeaders=function(){a.vars.isMobile||
!a.vars.lightboxOpened||a.vars.A.objectIsEmpty(a.vars.relatedVideosCarousel)||a.vars.relatedVideosCarousel.attachStickyHeader({A:a.vars.A,stickyHeaderContainer:"#"+a.vars.popoverId+" .vse-lb-right",stickyHeaderLBContainer:"#"+a.vars.popoverId,lbModalContainer:".a-modal-scroller.a-declarative"})};this.resetStickyHeaders=function(){a.vars.isMobile||a.vars.A.objectIsEmpty(a.vars.relatedVideosCarousel)||a.dom.$lbRightColumn.find(".vse-vc-header.first-item").removeAttr("style").removeClass("vse-absolute")};
this.initializeVideoActionTray=function(b,c){a.vars.videoActionTrayComponents=new za({A:a.A,contentCarousel:a.vars.relatedVideosCarousel,socialShareId:a.vars.socialShareId,templateId:a.vars.templateId,clientPrefix:a.vars.clientPrefix});a.setVIPOrientationProperties(c);a.handleShopIconMetric();a.vars.enableMultiplePFOImpressions?a.vars.videoActionTrayComponents.handleShopIconInteractions():a.vars.videoActionTrayComponents.handleShopIconInteractions(a.emitPFOImpressionMetricVIPHandler);a.vars.videoActionTrayComponents.handleShareIconInteractions();
a.handleShareIconMetric();a.handleWatchIconMetric();a.vars.videoActionTrayComponents.handleVIPCarouselClose();a.initializeWatchComponents(b);a.A.on("vse:"+a.vars.templateId+":vip:vat:component:open",function(){a.A.$("#"+a.vars.templateId+" "+f.VIPActionOverlaySelector).addClass(f.VIPActionOverlayShowClassName)});a.A.on("vse:"+a.vars.templateId+":vip:vat:component:close",function(){a.A.$("#"+a.vars.templateId+" "+f.VIPActionOverlaySelector).removeClass(f.VIPActionOverlayShowClassName)})};this.updateProgressBarAndTimeDisplay=
function(b,c,d){if(0===a.vars.vipVideoDuration)a.vars.vipVideoDuration=a.vars.player.getMediaDuration();else{b=a.vars.A.$(c);d=a.vars.A.$(d);c=0<d.length?d:a.dom.$wrapper.find(f.VIPProgressBarFillSelector);d=0<b.length?b:a.dom.$wrapper.find(f.VIPTimeRemainingSelector);var k=Math.min(a.vars.player.getCurrentTime(),a.vars.vipVideoDuration);c.width(k/a.vars.vipVideoDuration*100+"%");var h;b=0;c=!1;3600<=a.vars.vipVideoDuration&&(b=Math.floor(k/3600),c=!0);var l=a.vars.vipVideoDuration-k,k=Math.floor(l%
60);h=Math.floor(l/60%60);c&&(b=Math.floor(l/3600));d.text("-"+(c?b+":":"")+(c&&10>h?"0"+h+":":h+":")+(10>k?"0"+k:k))}};this.initializeVIPControls=function(){var b=a.dom.$wrapper.find(f.VIPSkipBackButtonSelector);b.unbind("click");b.click(function(b){b.stopPropagation();b=a.vars.player.getCurrentTime();a.vars.player.setCurrentTime(b-10);a.resetUserActivityTimer(2);a.vars.isContinuousPlayFinished=!1;a.emitClickMetric(f.METRIC_SKIP_BACK)});b=a.dom.$wrapper.find(f.VIPSkipForwardButtonSelector);b.unbind("click");
b.click(function(b){b.stopPropagation();0===a.vars.vipVideoDuration&&(a.vars.vipVideoDuration=a.vars.player.getMediaDuration());b=a.vars.player.getCurrentTime();a.vars.player.setCurrentTime(Math.min(b+10,a.vars.vipVideoDuration-1));a.resetUserActivityTimer(2);a.emitClickMetric(f.METRIC_SKIP_FORWARD)});a.initializeMuteButton();a.vars.vipPlayPauseToggle=a.dom.$wrapper.find(f.VIPPlayPauseToggleSelector);a.vars.vipPlayPauseToggle.unbind("click");a.vars.vipPlayPauseToggle.click(function(b){b.stopPropagation();
a.vars.vipControlsShouldPause?(a.pauseVideoIfNeeded(),a.vars.vipControlsShouldPause=!1,a.emitClickMetric(f.METRIC_PAUSE)):(a.vars.useUpNextComponent&&a.vars.isUpNextComponentActive?a._playUpNextHandler():a.resumeVideoIfNeeded(),a.resetUserActivityTimer(2),a.vars.vipControlsShouldPause=!0,a.emitClickMetric(f.METRIC_PLAY));a.vars.vipPlayPauseToggle.toggleClass(f.VIPPauseIconClassName,a.vars.vipControlsShouldPause);a.vars.vipPlayPauseToggle.toggleClass(f.VIPPlayIconClassName,!a.vars.vipControlsShouldPause)});
a.vars.player.on("timeupdate",a.updateProgressBarAndTimeDisplay);a.initializeProgressBarTouchEvents()};this.initializeProgressBarTouchEvents=function(b,c,d){b=0<a.vars.A.$(b).length?a.vars.A.$(b):a.dom.$wrapper;c=c||f.VIPProgressBarSelector;var k=b.find(c);b.delegate(c,"touchstart",function(b){b.stopPropagation();a.vars.isScrubbing=!0;a.pauseVideoIfNeeded()});b.delegate(c,"touchmove",function(b){if(a.vars.isScrubbing){b.stopPropagation();a.resetUserActivityTimer();var c=k.width(),d=k.get(0)&&(k.get(0).getBoundingClientRect().x||
k.get(0).getBoundingClientRect().left)||0;b=Math.max(0,Math.min(1,(b.originalEvent.touches[0].clientX-d)/c));c=a.vars.vipVideoDuration*b;1===b&&(c-=.1);a.vars.player.setCurrentTime(c)}});b.delegate(c,"touchend",function(b){b.stopPropagation();a.vars.isScrubbing=!1;a.vars.isContinuousPlayFinished=!1;a.vars.vipControlsShouldPause&&a.resumeVideoIfNeeded(d)});b.delegate(c,"click",function(b){b.stopPropagation();a.vars.isContinuousPlayFinished=!1;a.resetUserActivityTimer();var c=k.width();b=Math.max(0,
Math.min(1,b.offsetX/c));c=a.vars.vipVideoDuration*b;1===b&&(c-=.1);a.vars.player.setCurrentTime(c)})};this.initializeMuteButton=function(){a.vars.vipMuteUnmuteToggle=a.dom.$wrapper.find(f.VIPMuteUnmuteSelector);a.vars.vipMuteUnmuteToggle.unbind("click");a.vars.vipMuteUnmuteToggle.click(function(b){b.stopPropagation();a.muteUnMuteVideo()})};this.updateSegmentTab=function(b){a.vars.relatedVideosCarousel&&a.vars.relatedVideosCarousel.updateSegmentTabForActiveVideo(b)};this.vseCsmWidgetLoadedMetrics=
function(){var b=a.vars.A.$("#"+a.vars.clientPrefix+"-vse-related-videos");a.vars.isMetricRecorded||a.vars.A.objectIsEmpty(b.offset())?a.vars.A.off("scroll",a.vseCsmWidgetLoadedMetrics):a.vars.A.onScreen(b)&&(a.postWidgetInitializationMetrics(),a.vars.isMetricRecorded=!0)};this.postWidgetInitializationMetrics=function(){var b=a.vars.A.now()-a.vars.widgetStartTime;a.vars.A.$("#vse-spinner").hasClass("aok-hidden")?(l.count(a.vars.clientPrefix+".widgetViewedAndLoadedCount",1),l.count(a.vars.clientPrefix+
".widgetViewedAndLoadedDuration",b)):(l.count(a.vars.clientPrefix+".widgetViewedNotLoadedCount",1),l.count(a.vars.clientPrefix+".widgetViewedNotLoadedDuration",b));l.count(a.vars.clientPrefix+".pageLoadToWidgetViewedDuration",b)};this.emitMultipleThumbnailImpressionMetricHandler=function(b){try{if(b===u||null===b)return!1;var c=a.vars.isVideoImmersivePlayer?a.getCombinedPlaylist():a.vars.playlist;a.emitThumbnailMetric(a.vars.isVideoImmersivePlayer?f.METRIC_WATCH_THUMBNAIL_IMPRESSION:f.METRIC_LB_THUMBNAIL_IMPRESSION,
c[b],b)}catch(d){l.logError(f.ATTRIBUTION_NAME,"Failed to emit thumbnail impression",d)}};this.emitButtonImpressionMetricHandler=function(b,c){try{if(c===u||null===c)return!1;var d=a.A.$(c).attr("data-segment-id");a.emitButtonImpressionMetric(f.METRIC_LB_SHOW_MORE_BUTTON_IMPRESSION,d,b)}catch(k){l.logError(f.ATTRIBUTION_NAME,"Failed to emit show more button impression",k)}};this.triggerWeblabHandler=function(b){try{var c=a.vars.isVideoImmersivePlayer?a.getCombinedPlaylist():a.vars.playlist,d=c[b].labelDetails?
c[b].labelDetails.labelWeblabName:"";d&&!a.vars.hasWeblabTriggered&&(a.vars.hasWeblabTriggered=a.triggerWeblab(d))}catch(k){l.logError(f.ATTRIBUTION_NAME,"Failed to trigger weblab",k)}};this.triggerWeblab=function(b){if(!b)return!1;y.sendRequest(a.vars.A,""+f.VAP_EW+f.WEBLAB_TRIGGER_ENDPOINT,{weblabName:b},function(){},function(){});return!0};this.onIntersectionObserved=function(b){a.emitMultipleThumbnailImpressionMetricHandler(b);a.triggerWeblabHandler(b)};this.onIntersectionObservedForShowMoreButton=
function(b,c){a.emitButtonImpressionMetricHandler(b,c)};this.onProductItemIntersectionObserved=function(b,c){c&&c.dataset&&a.emitPFOImpressionMetric(f.METRIC_PFO_IMPRESSION,c.dataset.asin||null,c.dataset.isSponsored||!1,b)};this.getEligibleIndicesForEmission=function(a,c){return c=a=a.filter(function(a){return 0>c.indexOf(a)}).slice()};this.getModalFactory=function(){var b=null;a.vars.isMobile?v.now("a-secondary-view").execute("vw-dp-secondary-view",function(a){b=a}):v.now("a-modal").execute("vw-dp-modal",
function(a){b=a});return b};this.resetVIPControls=function(){a.vars.vipControlsShouldPause||(a.vars.vipControlsShouldPause=!0,a.vars.vipPlayPauseToggle.toggleClass(f.VIPPlayIconClassName,!a.vars.vipControlsShouldPause),a.vars.vipPlayPauseToggle.toggleClass(f.VIPPauseIconClassName,a.vars.vipControlsShouldPause))};this.setMshopPageOrientation=function(b){a.vars.A.capabilities.ios&&"function"===typeof a.vars.mShopFactory.setPageOrientation&&a.vars.mShopFactory.setPageOrientation({behavior:b})};this.requestMshopFullscreen=
function(){a.vars.isVideoImmersivePlayer&&!a.vars.A.objectIsEmpty(a.vars.mShopFactory)&&(a.vars.A.capabilities.ios&&a.vars.viewportMetaTag.attr("content",a.vars.viewportMetaTagContent+",  viewport-fit\x3dcover"),a.vars.mShopFactory.requestFullscreen({successCallback:function(){document.addEventListener("touchmove",a.mShopScrollLock,!0);document.addEventListener("touch",a.mShopScrollLock,!0);a.vars.A.delay(function(){a.vars.A.trigger("resize",{},{width:m.innerWidth,height:document.documentElement.clientHeight});
a.dom.$lbContainer&&a.dom.$lbContainer.height(document.documentElement.clientHeight)},200);a.setMshopPageOrientation(a.vars.mShopFactory.AUTO_ROTATE_ENABLED)},failCallback:function(){a.vars.A.trigger("resize",{},{width:m.innerWidth,height:document.documentElement.clientHeight});a.dom.$lbContainer&&a.dom.$lbContainer.height(document.documentElement.clientHeight)}}))};this.cancelMshopFullscreen=function(b){void 0===b&&(b=function(){});a.vars.isVideoImmersivePlayer&&!a.vars.A.objectIsEmpty(a.vars.mShopFactory)&&
(a.vars.A.capabilities.ios&&a.vars.viewportMetaTag.attr("content",a.vars.viewportMetaTagContent),a.vars.mShopFactory.cancelFullscreen({successCallback:function(){document.removeEventListener("touchmove",a.mShopScrollLock,!0);document.removeEventListener("touch",a.mShopScrollLock,!0);b();a.setMshopPageOrientation(a.vars.mShopFactory.AUTO_ROTATE_DISABLED)},failCallback:function(){a.requestMshopFullscreen()}}))};this.cancelMshopFullscreenAndNavigate=function(b){var c;"string"===typeof b?c=function(){a.vars.A.delay(function(){a.closeIVXComponents();
a.vars.mShopFactory.navigate({url:b,transition:"slide"})},600)}:(b&&b.preventDefault(),c=function(){if(b.target){var c=b.target.getAttribute("href");a.closeIVXComponents();a.vars.mShopFactory.navigate({url:c,transition:"slide"})}});a.vars.disableFullScreenOnMshop?c():a.cancelMshopFullscreen(c)};this.openExternalLinkFromLightBox=function(b){a.pauseVideoIfNeeded();a.vars.isMshop&&a.vars.isVideoImmersivePlayer&&a.cancelMshopFullscreenAndNavigate(b)};this.closeIVXComponents=function(){a.vars.$(".vse-close-button").click();
a.A.trigger("vse:ns:partialcomponents:"+a.vars.clientPrefix+":ivx:close")};this.closeIXVAndTriggerDisclosureEvent=function(b){a.vars.isVideoImmersivePlayer&&b&&(a.preventExternalLinkClick(b),b.srcElement&&(b=b.srcElement.getAttribute("href"),a.closeIVXComponents(),a.vars.A.trigger(a.vars.clientPrefix+":vse:disclosure:click",b)))};this.preventExternalLinkClick=function(a){a&&a.preventDefault()};this.mShopScrollLock=function(b){0<a.vars.$(b.target).closest(f.VIPActionOverlaySelector).length||0<a.vars.$(b.target).closest(".vse-profile").length||
0<a.vars.$(b.target).closest(".vse-fb-sheet").length||a.vars.$(b.target).hasClass("vse-fb-copyright")||a.vars.$(b.target).hasClass("vse-oap-link")||a.vars.$(b.target).hasClass("vse-profile")||a.vars.$(b.target).hasClass("vse-cr-link")||a.vars.$(b.target).hasClass("vse-fb-report-illegal-content")?b.stopPropagation():b.preventDefault()};this.initializeWatchComponents=function(b){b={A:a.A,segmentTabs:b,segmentTabCssClassSelectorName:"#"+a.vars.popoverId+" "+f.VIPLbTabsContainerSelector+" .vse-vip-lb-tab"};
a.vars.useMultiCarousel||a.vars.A.objectIsEmpty(a.vars.relatedVideosCarousel)?a.vars.useMultiCarousel&&!a.vars.hideWatchIcon&&a.vars.videoActionTrayComponents.handleMoreVideosIconInteractions():(a.vars.relatedVideosCarousel.initializeSegmentTabs(b),a.vars.videoActionTrayComponents.handleWatchIconInteractions())};this.setVIPOrientationProperties=function(b){var c={carouselAnimationType:{width:"toggle"},getCardInViewOffset:function(a){return a.offset().left},getOffsetPointForTabUpdate:function(){return m.innerWidth/
2},animatedCarouselDimensionValue:function(){return b},getCarouselPropertyToAnimate:function(a){return{scrollLeft:a}}},d={carouselAnimationType:{height:"toggle"},getCardInViewOffset:function(a){return a.offset().top},getOffsetPointForTabUpdate:function(){return a.A.$("#"+a.vars.templateId+" "+f.VIPLbTabsContainerSelector).outerHeight(!0)+parseInt(a.A.$("#"+a.vars.templateId+" "+f.VIPLbCarouselSelector+" .vse-video-card:first").css("margin-top"))},animatedCarouselDimensionValue:function(){return a.A.$("#"+
a.vars.templateId+" "+f.VIPLbCarouselSelector+" .vse-video-card:last").outerHeight(!0)+3},getCarouselPropertyToAnimate:function(a){return{scrollTop:a}}},k={carouselAnimationType:{height:"toggle"},getCardInViewOffset:function(a){return a.offset().top},getOffsetPointForTabUpdate:function(){return a.A.$("#"+a.vars.templateId+" "+f.VIPLbTabsContainerSelector).outerHeight(!0)+parseInt(a.A.$("#"+a.vars.templateId+" "+f.VIPLbCarouselSelector+" .vse-video-card:first").css("margin-top"))},animatedCarouselDimensionValue:function(){return b},
getCarouselPropertyToAnimate:function(a){return{scrollLeft:a}}};m.innerHeight>m.innerWidth&&a.setOrintationConfig(c);m.innerWidth>m.innerHeight&&(a.vars.useMultiCarousel?a.setOrintationConfig(k):a.setOrintationConfig(d),a.updateLbViewportHeight());a.A.on.orientationchange(function(b){0===b.orientation?(a.setOrintationConfig(c),a.resetLbViewportHeight(),a.emitMetric(f.METRIC_PORTRAIT_MODE)):(a.vars.useMultiCarousel?a.setOrintationConfig(k):a.setOrintationConfig(d),a.updateLbViewportHeight(),a.emitMetric(f.METRIC_LANDSCAPE_MODE))})};
this.setOrintationConfig=function(b){a.vars.videoActionTrayComponents.setOrientationConfig(b);a.setOrientationConfig(b)};this.resetLbViewportHeight=function(){a.A.$("#"+a.vars.templateId+" "+f.VIPLbCarouselViewportSelector).css("height","initial")};this.updateLbViewportHeight=function(){a.A.$("#"+a.vars.templateId+" "+f.VIPLbCarouselViewportSelector).height(m.innerHeight-a.A.$("#"+a.vars.templateId+" "+f.VIPLbTabsContainerSelector).outerHeight(!0))};this.isReviewTextOverflow=function(){var b=a.A.$("#"+
a.vars.templateId+" .vse-reviews-content-ellipsis-wrapper").prop("scrollHeight"),c=a.A.$("#"+a.vars.templateId+" .vse-reviews-content-ellipsis-wrapper").prop("clientHeight");return b>c};this.isReviewTextExpanded=function(){return a.A.$("#"+a.vars.templateId+" "+f.VIPOverlaySelector).hasClass("vse-reviews-expand-full-cr")};this.updateReviewsExpandButtonVisibility=function(){a.A.$("#"+a.vars.templateId+" .vse-reviews-expand-container").toggleClass("vse-reviews-expand-show-toggle",a.isReviewTextOverflow())};
this.styleExpandedReviewText=function(){var b=a.A.$("#"+a.vars.templateId+" .vse-reviews-content-expand-container"),c=a.isReviewTextOverflow()?"vse-reviews-content-expand-container-long":"vse-reviews-content-expand-container-short";b.addClass(c)};this.resetReviewTextStyle=function(){a.A.$("#"+a.vars.templateId+" .vse-reviews-content-expand-container").removeClass("vse-reviews-content-expand-container-short vse-reviews-content-expand-container-long")};this.compactReviewIfNeeded=function(){var b=a.A.$("#"+
a.vars.templateId+" .vse-reviews-content-ellipsis-wrapper"),c=a.A.$("#"+a.vars.templateId+" .vse-vip-play-pause-forward-previous-btns-container"),d=b.hasClass("vse-reviews-content-ellipsis-single-line"),d=b.height()*(d?2:1),c=b.offset().top+d>c.offset().top-10;b.toggleClass("vse-reviews-content-ellipsis-single-line",c)};this.handleReviewsOnResize=function(){a.vars.customerReviewsConfig&&a.vars.customerReviewsConfig.showCustomerReviewMetadata&&a.vars.lightboxOpened&&(a.isReviewTextExpanded()?(a.resetReviewTextStyle(),
a.styleExpandedReviewText()):(a.compactReviewIfNeeded(),a.updateReviewsExpandButtonVisibility()))};this.isTargetOutsideExpandedReviewsMetadata=function(b){return f.VIPReviewsMetadataSelectors.every(function(c){return 0===a.A.$(b.target).closest(c).length})};this.toggleVipPlayPauseClass=function(){a.vars.vipPlayPauseToggle.toggleClass(f.VIPPauseIconClassName,a.vars.vipControlsShouldPause);a.vars.vipPlayPauseToggle.toggleClass(f.VIPPlayIconClassName,!a.vars.vipControlsShouldPause)};this.handleKeepVideoCarouselOpen=
function(){a.vars.lightboxOpened&&a.vars.keepCarouselOpenOnLinkClick&&(a.handleIVXOverlay(),a.vars.manualTriggerWatchIcon=!0,a.vars.videoActionTrayComponents.triggerWatchIconInteractionOpen(),a.vars.watchAllClicked=!1,a.vars.manualTriggerWatchIcon=!1)};this.handleKeepProductCarouselOpen=function(){a.vars.lightboxOpened&&a.vars.keepProductCarouselOpenOnClick&&(a.handleIVXOverlay(),a.vars.manualTriggerShopIcon=!0,a.vars.videoActionTrayComponents&&a.vars.videoActionTrayComponents.triggerShopIconInteractionOpen(),
a.vars.manualTriggerShopIcon=!1)};this.handleIVXOverlay=function(){a.vars.useAutoplayFallback||!a.vars.lightboxOpenedFirstTime?a.showVideoImmersivePlayerOverlay():a.hideVideoImmersivePlayerOverlay()};this.showPoster=function(b){a.vars.player.showPoster(b)};this.addPlayerHoverHandler=function(){var b=a.vars.A.$("#"+a.vars.containerId),c=a.vars.$("#"+a.vars.templateId+"-close-button");if(c){c=c.clone();c.removeClass("vse-close-button").addClass(f.LB_CLOSE_BUTTON_ON_PLAYER_CLASS_NAME);b.append(c);var d=
function(){(a.isDesktopVerticalLightBox()||a.isSingleVideoLightbox())&&a.toggleLightboxCloseButton(!0)};a.vars.playerUnHoverHandler=function(){(a.isDesktopVerticalLightBox()||a.isSingleVideoLightbox())&&a.toggleLightboxCloseButton(!1)};b.hover(function(){return d()},function(){return a.vars.playerUnHoverHandler()});a.dom.$wrapper.find("."+f.LB_CLOSE_BUTTON_ON_PLAYER_CLASS_NAME).hover(function(){d();a.vars.isFeedbackClosed&&a.showFeedbackLink(a.vars.feedbackContainer,a.vars.playerContainer)});var k;
b.keyup(function(b){clearTimeout(k);9===b.keyCode&&(null!==a.vars.feedbackContainer&&a.showFeedbackLink(a.vars.feedbackContainer,a.vars.playerContainer),a.toggleLightboxCloseButton(!0),k=setTimeout(function(){a.hideFeedbackLink(a.vars.feedbackContainer,a.vars.playerContainer);(a.isDesktopVerticalLightBox()||a.isSingleVideoLightbox())&&a.toggleLightboxCloseButton(!1)},3E3))})}};this.setupKeyPressEventHandlerForRelatedProductsCarousel=function(){a.dom.$relatedProductContainer.keyup(function(b){9===
b.keyCode&&(a.dom.$relatedProductContainer.find(".a-carousel-col").css("display","block"),a.dom.$relatedProductContainer.mouseout(function(){a.dom.$relatedProductContainer.find(".a-carousel-col").css("display","")}))})};this.toggleLightboxCloseButton=function(b){0<a.dom.$wrapper.find("."+f.LB_CLOSE_BUTTON_ON_PLAYER_CLASS_NAME).length&&a.dom.$wrapper.find("."+f.LB_CLOSE_BUTTON_ON_PLAYER_CLASS_NAME).toggleClass("vse-show",b)};this.feedBackMouseLeaveHandler=function(){a.vars.isFeedbackClosed?a.hideFeedbackLink(a.vars.feedbackContainer,
a.vars.playerContainer):a.toggleLightboxCloseButton(!0);a.vars.cursorOnVideoPlayerDiv=!1};this.isSingleVideoLightbox=function(){return 0<a.vars.A.$("#"+a.vars.popoverName+"-wrapper").length?0<=a.vars.A.$("#"+a.vars.popoverName+"-wrapper").attr("data-css-class").indexOf("vse-single-video-lb"):!1};this.showHideElementsForMultiCarousel=function(){a.vars.multiCarouselExpanded?setTimeout(function(){a.A.$("#"+a.vars.templateId+" ."+f.VIPScrubberClassName).removeClass("aok-hidden");a.A.$("#"+a.vars.templateId+
" ."+f.VIPPlayPauseClassName).removeClass("aok-hidden");a.A.$("#"+a.vars.templateId+" "+f.VIPFeedbackContainer).removeClass("aok-hidden");a.A.$("#"+a.vars.templateId+" ."+f.VIPVideoHelpfulVotesClassName).removeClass("aok-hidden")},250):(a.A.$("#"+a.vars.templateId+" ."+f.VIPScrubberClassName).addClass("aok-hidden"),a.A.$("#"+a.vars.templateId+" ."+f.VIPPlayPauseClassName).addClass("aok-hidden"),a.A.$("#"+a.vars.templateId+" "+f.VIPFeedbackContainer).addClass("aok-hidden"),a.A.$("#"+a.vars.templateId+
" ."+f.VIPVideoHelpfulVotesClassName).addClass("aok-hidden"))};this.openCloseMultiCarousel=function(){a.vars.multiCarouselExpanded?(a.vars.hideWatchIcon||a.vars.videoActionTrayComponents.reset(),a.A.$("#"+a.vars.templateId+" "+f.VIPMultiCarouselWrapper).removeClass(f.VIPMultiCarouselExpandedClass),a.showHideElementsForMultiCarousel(),a.A.$("#"+a.vars.templateId+" "+f.VIPSearchButtonSelector).removeClass("aok-hidden"),a.resetUserActivityTimer(),a.vars.multiCarouselExpanded=!1,a.vars.keepMultiCarouselOpen=
!1):(a.resetUserActivityTimer(-2),a.A.$("#"+a.vars.templateId+" "+f.VIPMultiCarouselWrapper).addClass(f.VIPMultiCarouselExpandedClass),a.showHideElementsForMultiCarousel(),a.A.$("#"+a.vars.templateId+" "+f.VIPSearchButtonSelector).addClass("aok-hidden"),a.vars.multiCarouselExpanded=!0)};this.removeAriaHiddenFromCarouselCards=function(){var b=document.querySelectorAll("#"+a.vars.popoverId+" li.vse-video-card"),c=Array.prototype.slice.call(b);c&&a.vars.A.delay(function(){c.forEach(function(a){a.setAttribute("aria-hidden",
"false")})},300)};this.isGroupOne=function(b){if(b.groupType)return-1!==b.groupType.indexOf(f.G1);if(!a.vars.A.objectIsEmpty(a.vars.multiCarouselS1))for(var c=a.vars.multiCarouselS1.getplaylist(),d=0;d<c.length;d++)if(c[d].contentId===b.contentId)return!0;return!1};this.isGroupTwo=function(b){if(b.groupType)return-1!==b.groupType.indexOf(f.G2);if(!a.vars.A.objectIsEmpty(a.vars.multiCarouselS2))for(var c=a.vars.multiCarouselS2.getplaylist(),d=0;d<c.length;d++)if(c[d].contentId===b.contentId)return!0;
return!1};this.isInPlayList=function(b){if(!a.vars.A.objectIsEmpty(a.vars.relatedVideosCarousel)&&b)for(var c=a.vars.relatedVideosCarousel.getplaylist(),d=0;d<c.length;d++)if(c[d].contentId===b.contentId)return!0;return!1};this.getActiveAsset=function(){if(a.vars.useMultiCarousel){var b=a.isGroupOne(a.vars.currentAssetSpec),c=a.isGroupTwo(a.vars.currentAssetSpec),d=a.vars.currentAssetSpec,b=a.vars.A.objectIsEmpty(a.vars.currentAssetSpec)?!1:b,c=a.vars.A.objectIsEmpty(a.vars.currentAssetSpec)?!1:c;
b&&!a.vars.A.objectIsEmpty(a.vars.multiCarouselS1)?d=a.vars.multiCarouselS1.getActiveAsset():c&&!a.vars.A.objectIsEmpty(a.vars.multiCarouselS2)&&(d=a.vars.multiCarouselS2.getActiveAsset());return d}return a.vars.A.objectIsEmpty(a.vars.relatedVideosCarousel)?a.vars.currentAssetSpec:a.vars.relatedVideosCarousel.getActiveAsset()!==u?a.vars.relatedVideosCarousel.getActiveAsset():a.vars.currentAssetSpec};this.getCombinedPlaylist=function(){if(a.vars.useMultiCarousel){var b=[];a.vars.A.objectIsEmpty(a.vars.multiCarouselS1)||
(b=b.concat(a.vars.multiCarouselS1.getplaylist()));a.vars.A.objectIsEmpty(a.vars.multiCarouselS2)||(b=b.concat(a.vars.multiCarouselS2.getplaylist()));return b}return a.vars.relatedVideosCarousel.getplaylist()};this.setOrientationConfig=function(b){a.vars.useMultiCarousel?(a.vars.A.objectIsEmpty(a.vars.multiCarouselS1)||a.vars.multiCarouselS1.setOrientationConfig(b),a.vars.A.objectIsEmpty(a.vars.multiCarouselS2)||a.vars.multiCarouselS2.setOrientationConfig(b)):a.vars.A.objectIsEmpty(a.vars.relatedVideosCarousel)||
a.vars.relatedVideosCarousel.setOrientationConfig(b)};this.findIndex=function(b){if(a.vars.useMultiCarousel){var c=a.isGroupOne(b),d=a.isGroupTwo(b);if(!c&&!d)return-1;if(!a.vars.A.objectIsEmpty(a.vars.multiCarouselS1)&&c)return a.vars.multiCarouselS1.findIndex(b);if(!a.vars.A.objectIsEmpty(a.vars.multiCarouselS2)&&!c)return(a.vars.A.objectIsEmpty(a.vars.multiCarouselS1)?0:a.vars.multiCarouselS1.getplaylist().length)+a.vars.multiCarouselS2.findIndex(b)}else return a.isInPlayList(b)?a.vars.relatedVideosCarousel.findIndex(b):
-1};this.markPlaying=function(b){if(b!==u)if(a.vars.useMultiCarousel){var c=a.isGroupOne(b),d=a.isGroupTwo(b),k=a.vars.A.objectIsEmpty(a.vars.currentAssetSpec)?!1:c;!a.vars.A.objectIsEmpty(a.vars.multiCarouselS1)&&c?(a.vars.multiCarouselS1.markPlaying(b),a.vars.A.objectIsEmpty(a.vars.multiCarouselS2)||k||a.dom.$wrapper.find(f.VIPMultiCarouselTwoContainer).find(".vse-video-card").removeClass("active")):!a.vars.A.objectIsEmpty(a.vars.multiCarouselS2)&&d&&(a.vars.multiCarouselS2.markPlaying(b),!a.vars.A.objectIsEmpty(a.vars.multiCarouselS1)&&
k&&a.dom.$wrapper.find(f.VIPMultiCarouselOneContainer).find(".vse-video-card").removeClass("active"))}else a.isInPlayList(b)&&a.vars.relatedVideosCarousel.markPlaying(b)};this.rotateTo=function(b){if(a.vars.useMultiCarousel){a.vars.A.objectIsEmpty(a.vars.multiCarouselS1)||a.vars.multiCarouselS1.removeActive();a.vars.A.objectIsEmpty(a.vars.multiCarouselS2)||a.vars.multiCarouselS2.removeActive();var c=a.isGroupOne(b);a.vars.A.objectIsEmpty(a.vars.currentAssetSpec)||a.isGroupOne(a.vars.currentAssetSpec);
!a.vars.A.objectIsEmpty(a.vars.multiCarouselS1)&&c?a.vars.multiCarouselS1.rotateTo(b):a.vars.A.objectIsEmpty(a.vars.multiCarouselS2)||a.vars.multiCarouselS2.rotateTo(b)}else a.vars.A.objectIsEmpty(a.vars.relatedVideosCarousel)||a.vars.relatedVideosCarousel.rotateTo(b)};this.updateVotingElements=function(b,c,d){a.vars.useMultiCarousel?(b=a.isGroupOne(b),!a.vars.A.objectIsEmpty(a.vars.multiCarouselS1)&&b?a.vars.multiCarouselS1.updateVotingElements(c,d):a.vars.A.objectIsEmpty(a.vars.multiCarouselS2)||
a.vars.multiCarouselS2.updateVotingElements(c,d)):a.vars.A.objectIsEmpty(a.vars.relatedVideosCarousel)||a.vars.relatedVideosCarousel.updateVotingElements(c,d)};this.updateVotingElementsForCountAndStatus=function(b,c,d){a.vars.useMultiCarousel?(b=a.isGroupOne(b),!a.vars.A.objectIsEmpty(a.vars.multiCarouselS1)&&b?a.vars.multiCarouselS1.updateVotingElementsForCountAndStatus(c,d):a.vars.A.objectIsEmpty(a.vars.multiCarouselS2)||a.vars.multiCarouselS2.updateVotingElementsForCountAndStatus(c,d)):a.vars.A.objectIsEmpty(a.vars.relatedVideosCarousel)||
a.vars.relatedVideosCarousel.updateVotingElementsForCountAndStatus(c,d)};this.initializeMultiCarousel=function(b,c){a.emitRelatedVideosRenderMetric(f.METRIC_WATCH_THUMBNAIL_RENDER,c);b=b?f.VIPMultiCarouselOneContainer:f.VIPMultiCarouselTwoContainer;a.dom.$wrapper.delegate(b,"touchstart",function(b){a.vars.multiCarouselExpanded&&(a.vars.keepMultiCarouselOpen=!0,a.resetUserActivityTimer(-2),b.stopPropagation())});a.dom.$wrapper.delegate(b,"touchend",function(b){a.vars.multiCarouselExpanded&&(a.vars.keepMultiCarouselOpen=
!1,a.resetUserActivityTimer(-2),b.stopPropagation())})};this.relatedVideosCarouselNotEmpty=function(){return!a.vars.A.objectIsEmpty(a.vars.relatedVideosCarousel)||!a.vars.A.objectIsEmpty(a.vars.multiCarouselS1)||!a.vars.A.objectIsEmpty(a.vars.multiCarouselS2)};this.toggleSingleLbCssClass=function(b){!a.vars.isMobile&&a.dom.$wrapper&&a.dom.$wrapper.closest(f.LightboxWrapperSelector)&&a.dom.$wrapper.closest(f.LightboxWrapperSelector).toggleClass(f.SINGLE_VIDEO_LB_CSS_CLASS,b)&&setTimeout(function(){return a.vars.A.trigger("resize",
{},{width:m.innerWidth,height:m.innerHeight})},200)};this.vars={A:c,$:c.$,isMobile:!1,player:null,feedback:null,clientPrefix:null,placement:null,containerId:null,contentId:null,productAsin:null,playerFactory:null,ingressRelatedVideosCarousel:null,relatedVideosCarousel:null,keepCarouselOpenOnLinkClick:!1,watchAllClicked:!1,keepProductCarouselOpenOnClick:!1,videoVoteContainerFactory:null,activeVideoVoteContainer:null,isMshop:!1,isContinuousPlayFinished:!1,isFeedbackClosed:!0,showVotes:!1,defaultEntityId:f.EMPTY_STRING,
videoVoteFailure:!1,videoVoteConfig:null,currentAssetSpec:null,initialVideo:null,relatedProductsNilgiriRequestCount:0,popoverId:null,relatedProductsRequest:null,cursorOnVideoPlayerDiv:!1,lightBoxPausedVideo:!1,verticalLightBoxMaxWidth:1024,relatedProductsContainerFixedHeight:115,currentIndex:0,socialSharePageState:null,mShopFactory:null,lightboxOpened:!1,lightboxCarouselRegistered:!1,playFullScreenVideo:!1,ingressHasInitialAssetSpec:!0,playlist:null,isVideoImmersivePlayer:!1,secondsFromLastActivity:0,
intervalUserActivityHandlerId:0,isVIPOverlayTimerSet:!1,isVIPOverlayOnTapEventRegistered:!1,lightboxOpenedFirstTime:!0,videoActionTrayComponents:null,socialShareId:null,ingressCarousel:null,ingressPlaylist:null,widgetStartTime:0,isMetricRecorded:!1,carouselPageSize:0,nextPage:0,previousPage:0,vipVideoDuration:0,isScrubbing:!1,vipControlsShouldPause:!0,vipPlayPauseToggle:null,shouldShowProfiles:!1,popoverName:null,isUpNextComponentActive:!1,upNextTimeoutHandle:null,useUpNextComponent:!1,upNextString:f.EMPTY_STRING,
cancelString:f.EMPTY_STRING,watchIconFirstOpen:!0,shopIconFirstOpen:!0,manualTriggerWatchIcon:!1,manualTriggerShopIcon:!1,customerReviewsConfig:null,useAutoplayFallback:!1,vipPlayIconClicked:!1,contentIdProductAsinMap:{},showLightboxV2Experience:!1,playerContainer:null,feedbackContainer:null,showContentCarousel:!0,useMultiCarousel:!1,hideWatchIcon:!1,multiCarouselExpanded:!1,handleMultiCarousel:!0,keepMultiCarouselOpen:!1,multiCarouselS1:null,multiCarouselS2:null,isSwipingMultiCarousel:!1,showPFOOnOverlay:!1,
cacheOnProductAsin:!1,onSiteAttributionMetrics:null,useAllIVXComponents:!0,viewportMetaTag:null,viewportMetaTagContent:null,isClosedCaptionEnabled:!1,currentClosedCaptionsLang:null,closedCaptionsConfig:{},closedCaptionsTooltipTimerId:0,shouldHandleCCForLandscapeVideo:!1,playerUnHoverHandler:function(){},setMaxHeightToLBLeftColumn:!1,seekTime:0,rankingStrategy:f.EMPTY_STRING,videoUrlInlineVideoKey:f.EMPTY_STRING,showMoreMenuExperience:!1,disableFullScreenOnMshop:!1,disableCreatorClicksOnMshop:!1,vipControlsShouldMute:!0,
vipMuteUnmuteToggle:null,currentPlayerMode:"",inlinePlayerInitialized:!1,firstRelatedProductOverride:null,isMultiCarouselClosedForFirstTime:!1,showHotspots:!1,isVideoTypeLabelPresent:!1,isTimeoutComplete:!1};this.dom={$wrapper:null,$lbContainer:null,$lbLeftColumn:null,$lbRightColumn:null,$lbCCHeader:null,$lbTabContainer:null,$videoAuthor:null,$playerContainer:null,$mobileFixedContainer:null,$mobileMovableContainer:null,$relatedProductContainer:null,$activeVideoOspLink:null,$activeVideoTitlePrefix:null,
$activeVideoCRLink:null,$lbVideoCarousel:null,$activeVideoCustomerProfile:null,$customerProfileContainer:null,$videoAuthorBlock:null,$activeVideoCRLinkWrapper:null,$profileLinkSelector:null,$followButtonSelector:null,$followEligibleCreator:null};this.refTagRecorder=new K(c)}d.prototype.getAciContentIdFromPlayerInstance=function(){try{return this.vars.player.player.playerInstance.config.aciContentId}catch(c){l.logError(f.ATTRIBUTION_NAME,"Failed to get aciContentId for the asset: "+this.vars.currentAssetSpec.contentId+
" ",c)}};d.prototype.isCustomerReviewVideo=function(c){return"AOD60"==c.vendorCode};d.prototype.isInfluencerVideo=function(c){return c.creatorType?"influencer"===c.creatorType.toLowerCase():!1};return d}(),Aa=f.VAP_EW+"subcomponent/",ja=function(){function d(){}d.getLazyLoadComponents=function(c,a,b,f,l){c.$("#"+a+" div[data-configuration]").each(function(){d.callSubComponentBuilder({A:c,context:b,handleFailure:l,handleSuccess:f},c.$(this),3)})};d.callSubComponentBuilder=function(c,a,b){var f=c.A,
m=c.context,k=c.handleFailure,h=c.handleSuccess,p=atob(a.attr("data-configuration")),n=JSON.parse(p),p=b,e={pageContext:m,configuration:n},C=f.now();b--;var q=p-b-1;y.sendRequest(f,Aa+n.type,e,function(b){var c=f.now()-C;l.count("vse_component_lazyLoaderHook:success:",c);l.count("vse_component_lazyLoaderHook:success:"+m.page+":"+m.placement+":"+n.type+":"+q,1);a.html(b);h(f,e)},function(h){(0===h.http.status||500<=h.http.status&&599>=h.http.status)&&0<b?(l.count("vse_component_lazyLoaderHook:error:"+
m.page+":"+m.placement+":"+n.type+":"+q,1),d.callSubComponentBuilder(c,a,b)):(l.count("vse_component_lazyLoaderHook:failure",1),k(f,e))})};return d}();try{var Ba=function(d){return new d(function(c,a){v.when("A","a-carousel-framework","a-carousel-constants","3p-promise","a-button","ready").register("VSEComponentAssets",function(a,d,n,k,h){return{setClientPrefix:function(c,r){var e=new ia(a);e.vars.clientPrefix=c;e.vars.setMaxHeightToLBLeftColumn=r.setMaxHeightToLBLeftColumn||!1;e.vars.templateId=
r.templateId;e.vars.showLightboxV2Experience=r.showLightboxV2Experience||!1;e.vars.isMobile=a.capabilities.mobile;e.vars.disableFullScreenOnMshop=r.disableFullScreenOnMshop||!1;e.vars.A.objectIsEmpty(r)||(r.hasOwnProperty(f.IS_VIDEO_IMMERSIVE_PLAYER_KEY)&&(e.vars.isVideoImmersivePlayer=r.isVideoImmersivePlayer),r.hasOwnProperty(f.SHOW_CONTENT_CAROUSEL)&&(e.vars.showContentCarousel=r.showContentCarousel));a.off("vse:ns:player:"+e.vars.clientPrefix+":init");a.off("vse:ns:metadata:"+e.vars.clientPrefix+
":init");a.off("vse:ns:socialShare:"+e.vars.clientPrefix+":init");a.off("vse:ns:feedback:"+e.vars.clientPrefix+":init");a.off("vse:ns:relatedProducts:"+e.vars.clientPrefix+":init");a.off("vse:ns:relatedVideos:"+e.vars.clientPrefix+":init");a.off("vse:ns:relatedVideosVernacularExperience:"+e.vars.clientPrefix+"init");a.off("vse:ns:ingressCarousel:"+e.vars.clientPrefix+":init");a.off("vse:"+e.vars.clientPrefix+":page:lightBoxOpened");a.off("vse:"+e.vars.clientPrefix+":page:lightBoxClosed");a.off("vse:"+
e.vars.clientPrefix+":lazyload:relatedvideos:succeeded");a.off("vse:"+e.vars.clientPrefix+":page:watchAllClicked");a.off("vse:ns:"+e.vars.clientPrefix+":hideAdditionalUXFeatures");a.off("vse:ns:inlinePlayer:"+e.vars.clientPrefix+":init");v.when("mash").execute("VSEComponentAsset-Mash-Detection",function(a){e.vars.isMshop=!0;e.vars.mShopFactory=a});a.on("vse:ns:player:"+e.vars.clientPrefix+":init",function(d){try{var g=x.fetchLatestPageState(a,d);if(g){l.count(f.PLAYER_INITIALIZED+":"+e.vars.clientPrefix,
1);var h=g.awaConfig;e.vars.isMobile=g.isMobile;e.vars.productAsin=g.productAsin;e.vars.playFullScreenVideo=g.enableFullScreenByDefault;e.vars.contentId=h.initialVideo;e.vars.shouldLoop=h.shouldLoop;e.vars.containerId=h.containerId;e.vars.playerContainer="#"+e.vars.containerId+"-container";e.vars.placement=h.nexusMetricsConfig.placementContext;e.vars.nexusMetricsConfig=h.nexusMetricsConfig;e.vars.useUpNextComponent=h.useUpNextComponent;e.vars.enableClickBasedAttribution=h.enableClickBasedAttribution;
e.vars.aciContentId=h.aciContentId;e.vars.linkCode=h.ospLinkCode;e.vars.useAutoplayFallback=h.useAutoplayFallback;e.vars.useUpNextComponent&&(e.vars.upNextString=g.upNextString?g.upNextString:"UP NEXT",e.vars.cancelString=g.cancelString?g.cancelString:"CANCEL");d={gatedP:D,EventEmitter:L,promise:k};var m={videoUrl:g.videoUrl,contentId:e.vars.contentId,vendorCode:g.vendorCode,vendorTrackingId:g.vendorTrackingId,productAsin:g.productAsin,videoReferenceId:g.videoReferenceId,eventTimestamp:e.vars.A.now(),
imageUrl:g.imageUrl,duration:0,refTag:f.EMPTY_STRING,rankingStrategy:f.EMPTY_STRING,aciContentId:g.aciContentId,mimeType:g.mimeType,videoTitle:g.videoTitle,creatorType:g.creatorType};e.setVideoDetails(e.vars.contentId,g);var n=g.initialClosedCaptions;e.vars.A.objectIsEmpty(n)||e.setInitialClosedCaptions(m,n);e.vars.isVideoImmersivePlayer&&e.setupVIPClosedCaptions(g.closedCaptionsConfig,n);h.initialVideo=m;e.vars.playerFactory=new V(d);if(e.vars.A.objectIsEmpty(g.inlinePlayerConfig)||!0!==g.needPlayerFactory){e.vars.player=
e.vars.playerFactory.create(h);!e.vars.isVideoImmersivePlayer&&e.vars.playFullScreenVideo&&(e.vars.player.aspectRatio(e.getAspectRatio(e.getDeviceOrientation())),e.vars.player.fluid(!1));e.vars.isVideoImmersivePlayer&&(e.vars.player.on("playerClick",e.onPlayerTapHandler),e.vars.player.on("texttrackenable",e.onTextTrackEnable),e.vars.useAutoplayFallback&&(e.vars.player.on("autoplayFailed",e._playerFailedAutoplayHandler),e.vars.player.on("autoplaySucceeded",e._playerSucceededAutoplayHandler)));e.attachPlayerEventListeners();
if(e.vars.A.objectIsEmpty(h.osaInstrumentationConfig))l.count(e.vars.clientPrefix+".noOsaInstrumentationConfig",1);else{var r={$container:e.vars.A.$("#"+e.vars.containerId),schemaId:h.osaInstrumentationConfig.schemaId,producerId:h.osaInstrumentationConfig.producerId};e.vars.onSiteAttributionMetrics=new P(r,e.vars.player,e.vars.A,e.vars.isVideoImmersivePlayer,e.vars.clientPrefix)}"nexus"===h.metricsEmissionMethod&&e.vars.nexusMetricsConfig&&(e.vars.buildNexusPayload=F.makeApplicationNexusPayloadBuilder(e.vars.A,
e.vars.nexusMetricsConfig),e.vars.emitMetricsToNexus=!0);var B=e.vars.A.$("#ive-"+e.vars.clientPrefix+"-player-label-container");B.length&&e.vars.A.$(e.vars.playerContainer).append(B);e.vars.A.trigger("vsePlayer-"+e.vars.clientPrefix,{player:e.vars.player,containerId:e.vars.containerId});e.vars.A.trigger(e.vars.clientPrefix+":vse:player:registered")}else e.vars.A.trigger("ivePlayerFactory-"+e.vars.clientPrefix,{playerFactory:e.vars.playerFactory})}else l.count(f.PLAYER_PAGE_STATE_NOT_FOUND_ERROR_KEY+
":"+e.vars.clientPrefix,1),e.vars.A.trigger("vse-common-assets-player-"+d+"-initialization-failed")}catch(u){l.logFatal(f.ATTRIBUTION_NAME+":"+e.vars.clientPrefix,"Fatal during player initialization.",u),l.count(c+".playerInitializationFatal",1)}});a.on("vse:ns:metadata:"+e.vars.clientPrefix+":init",function(d){try{var g=x.fetchLatestPageState(a,d);g?(e.vars.defaultEntityId=g.defaultEntityId,g.entityId&&g.entityType&&e.setFollowEntities(g.entityId,g.entityType),e.vars.showUploadDate=g.showUploadDate,
e.vars.videoVoteConfig=g.videoVoteConfig,e.vars.videoVoteConfig=a.$.extend({},e.vars.videoVoteConfig),d={gatedP:D,promise:k},e.vars.videoVoteConfig.hasOwnProperty("placementContext")&&(e.vars.videoVoteConfig.dependencies=d,e.vars.videoVoteContainerFactory=new N(a,e.vars.videoVoteConfig),e.vars.activeVideoVoteContainer=e.vars.videoVoteContainerFactory.createFromSelector("#vse-video-votes-lb-details-"+e.vars.videoVoteConfig.placementContext)),g.nexusMetricsConfig&&(e.vars.nexusMetricsConfig=g.nexusMetricsConfig,
e.vars.buildNexusPayload=F.makeApplicationNexusPayloadBuilder(e.vars.A,e.vars.nexusMetricsConfig),e.vars.emitMetricsToNexus=!0),g.customerReviewConfig&&(e.vars.customerReviewsConfig=g.customerReviewConfig,e.vars.customerReviewsConfig.showCustomerReviewMetadata&&(e.vars.A.delay(function(){e.compactReviewIfNeeded();e.updateReviewsExpandButtonVisibility()},250),e.attachReviewsPlayerEventListeners(),e.vars.A.off("a:declarative:"+e.vars.clientPrefix+"-expand-review-content:click"),e.vars.A.off("a:declarative:"+
e.vars.clientPrefix+"-expand-review-content:touch"),e.vars.A.declarative(e.vars.clientPrefix+"-expand-review-content","click touch",function(a){e.isReviewTextOverflow()&&!e.isReviewTextExpanded()&&(e.vars.$(f.VIPOverlaySelector).addClass("vse-reviews-expand-full-cr"),e.resetReviewTextStyle(),e.styleExpandedReviewText(),e.pauseVideoIfNeeded())}),e.vars.A.off("a:declarative:"+e.vars.clientPrefix+"-collapse-review-content:click"),e.vars.A.off("a:declarative:"+e.vars.clientPrefix+"-collapse-review-content:touch"),
e.vars.A.declarative(e.vars.clientPrefix+"-collapse-review-content","click touch",function(a){e.vars.$(f.VIPOverlaySelector).removeClass("vse-reviews-expand-full-cr");e.vars.$(".vse-reviews-content-ellipsis-wrapper").scrollTop(0);e.resetReviewTextStyle();e.vars.A.animationFrameDelay(function(){e.compactReviewIfNeeded();e.updateReviewsExpandButtonVisibility()});e.vars.vipControlsShouldPause&&e.resumeVideoIfNeeded()}),e.vars.A.on("resize",e.handleReviewsOnResize))),e.vars.A.trigger(e.vars.clientPrefix+
":vse:metadata:registered")):(l.count(f.METADATA_PAGE_STATE_NOT_FOUND_ERROR_KEY+":"+e.vars.clientPrefix,1),e.vars.A.trigger("vse-common-assets-metadata-"+d+"-initialization-failed"))}catch(h){l.logFatal(f.ATTRIBUTION_NAME+":"+e.vars.clientPrefix,"Fatal during metadata initialization.",h),l.count(c+".metadataInitializationFatal",1)}});a.on("vse:ns:socialShare:"+e.vars.clientPrefix+":init",function(d){try{var g=x.fetchLatestPageState(a,d);if(g){e.vars.socialSharePageState=d;e.vars.socialShareId=g.id;
e.vars.A.off("a:declarative:"+e.vars.clientPrefix+"-social-share-mshop-action:click");e.vars.A.off("a:declarative:"+e.vars.clientPrefix+"-social-share-mshop-action:touch");e.vars.A.declarative(e.vars.clientPrefix+"-social-share-mshop-action","click touch",function(a){e.vars.isMshop&&!e.vars.A.objectIsEmpty(e.vars.mShopFactory)&&(a=e.getActiveAsset(),a=e.getMshopShareParams(a),e.vars.mShopFactory.share(a))});if(!e.vars.isMobile){var h=e.vars.A.$("#"+e.vars.socialShareId+"-trigger [aria-expanded]");
a.off("a:popover:afterShow:"+e.vars.socialShareId+"-popover");a.on("a:popover:afterShow:"+e.vars.socialShareId+"-popover",function(){e.emitClickMetric(f.METRIC_SHARE_ICON);h.attr("aria-expanded","true")});a.off("a:popover:beforeHide:"+e.vars.socialShareId+"-popover");a.on("a:popover:beforeHide:"+e.vars.socialShareId+"-popover",function(){h.attr("aria-expanded","false")})}e.vars.A.off("a:declarative:"+e.vars.clientPrefix+"-swf-share-network:click");e.vars.A.declarative(e.vars.clientPrefix+"-swf-share-network",
"click",function(a){a=a.data;var b=e.vars.A.state(e.vars.socialSharePageState);ka.share(b,a.network);l.count(f.socialShareClickMetricName,1);e.emitClickMetric(f.METRIC_SHARE_SELECTION_CLICK)});e.vars.A.trigger(e.vars.clientPrefix+":vse:socialShare:registered")}else l.count(f.SOCIAL_SHARE_STATE_NOT_FOUND_ERROR_KEY+":"+e.vars.clientPrefix,1),e.vars.A.trigger("vse-common-assets-social-share-"+d+"-initialization-failed")}catch(k){l.logFatal(f.ATTRIBUTION_NAME+":"+e.vars.clientPrefix,"Fatal during socialShare initialization.",
k),l.count(c+".socialShareInitializationFatal",1)}});a.on("vse:ns:feedback:"+e.vars.clientPrefix+":init",function(a,b){try{var d=x.fetchLatestPageState(e.vars.A,a);if(d){var g=d.id;e.vars.feedbackContainer="#vse-"+e.vars.clientPrefix+"-feedback-container";e.vars.cursorOnVideoPlayerDiv=!1;e.deRegisterFeedback(g);b="true"===b;e.vars.showMoreMenuExperience=b;e.vars.showMoreMenuExperience&&e.vars.$(e.vars.feedbackContainer).css({display:"inline-block"});e.vars.A.on("vse:"+g+":feedback:shown",function(){e.pauseVideoIfNeeded();
e.vars.isFeedbackClosed=!1;e.vars.$(".vse-fb-copyright").click(function(a){e.vars.isMshop&&e.vars.isVideoImmersivePlayer&&(a.preventDefault(),e.vars.feedback.showInfringementNotSupport())});e.vars.$(".vse-fb-report-illegal-content").click(function(a){e.vars.isMshop&&e.vars.isVideoImmersivePlayer&&(e.vars.feedback.closeFeedbackForm(),e.openExternalLinkFromLightBox(a))});e.vars.showMoreMenuExperience?e.vars.$("#vse-report-trigger").click(function(a){a.preventDefault();e.emitClickMetric(f.METRIC_REPORT_CLICK)}):
e.emitClickMetric(f.METRIC_REPORT_CLICK)});e.vars.A.off("vse:"+g+":feedback:submitted:success");e.vars.A.on("vse:"+g+":feedback:submitted:success",function(){e.emitClickMetric(f.METRIC_REPORT_SUBMIT);l.count(f.METRIC_REPORT_SUBMIT,1)});e.vars.A.on("vse:"+g+":feedback:hidden",function(){e.vars.vipControlsShouldPause&&e.resumeVideoIfNeeded();e.vars.isFeedbackClosed=!0;e.vars.showMoreMenuExperience?e.vars.isVideoImmersivePlayer||e.vars.cursorOnVideoPlayerDiv||e.hideFeedbackLink(e.vars.feedbackContainer,
e.vars.playerContainer):e.vars.cursorOnVideoPlayerDiv||e.hideFeedbackLink(e.vars.feedbackContainer,e.vars.playerContainer);e.vars.showMoreMenuExperience&&e.vars.$("#vse-report-trigger").unbind("click");e.vars.$(".vse-fb-copyright").unbind("click");e.vars.isMshop&&e.vars.mShopFactory&&e.vars.A.delay(function(){e.vars.mShopFactory.dispatchEvent({type:"appOverlays.Hide"})},500)});var k=new ta({A:e.vars.A,buttonApi:h});e.vars.feedback=k.create(g,a,b);e.updateFeedback(e.vars.currentAssetSpec);e.vars.isFeedbackClosed=
!0;var m=e.vars.A.$(e.vars.feedbackContainer);e.vars.showMoreMenuExperience&&e.vars.isVideoImmersivePlayer?e.vars.A.$("#"+e.vars.templateId+" .vse-lb-actions-container").prepend(m):e.vars.A.$(e.vars.playerContainer).append(m);e.vars.isVideoImmersivePlayer||(e.vars.A.declarative.create(e.vars.$(e.vars.playerContainer),"feedback-overlays-player",{}),e.vars.A.declarative("feedback-overlays-player","mouseenter touchstart focus",function(){e.vars.isFeedbackClosed&&e.showFeedbackLink(e.vars.feedbackContainer,
e.vars.playerContainer);e.vars.cursorOnVideoPlayerDiv=!0;e.vars.A.capabilities.touch&&e.vars.A.delay(e.feedBackMouseLeaveHandler,3E3)}),e.vars.A.declarative("feedback-overlays-player","mouseleave",e.feedBackMouseLeaveHandler));e.vars.A.trigger(e.vars.clientPrefix+":vse:feedback:registered")}else l.count(f.FEEDBACK_PAGE_STATE_NOT_FOUND_ERROR_KEY+":"+e.vars.clientPrefix,1),e.vars.A.trigger("vse-common-assets-feedback-"+a+"-initialization-failed")}catch(n){l.logFatal(f.ATTRIBUTION_NAME+":"+e.vars.clientPrefix,
"Fatal during feedback initialization.",n),l.count(c+".feedbackInitializationFatal",1)}});a.on("vse:ns:relatedProducts:"+e.vars.clientPrefix+":init",function(a){try{!e.vars.isVideoImmersivePlayer||!e.vars.A.objectIsEmpty(e.vars.videoActionTrayComponents)&&e.vars.useMultiCarousel||(e.initializeVideoActionTray(null,a),setTimeout(function(){return e.handleKeepProductCarouselOpen()},500))}catch(b){l.logFatal(f.ATTRIBUTION_NAME+":"+e.vars.clientPrefix,"Fatal during related products initialization.",b),
l.count(c+".relatedProductsInitializationFatal",1)}});a.on("vse:ns:relatedVideos:"+e.vars.clientPrefix+":init",function(h){try{var q=x.fetchLatestPageState(a,h);if(q){var r=new O(d,n,a,{gatedP:D,promise:k});e.vars.useMultiCarousel=q.useMultiCarousel;e.vars.emitMetricsToNexus=e.vars.nexusMetricsConfig?!0:!1;e.vars.enableMultiplePFOImpressions=q.enableMultiplePFOImpressions;e.vars.enableWidgetMetricsAfterOneSecond=q.enableWidgetMetricsAfterOneSecond;e.vars.emitMetricsToNexus&&(e.vars.buildNexusPayload=
F.makeApplicationNexusPayloadBuilder(e.vars.A,e.vars.nexusMetricsConfig));e.vars.hideWatchIcon=q.hideWatchIcon;e.vars.disableCreatorClicksOnMshop=q.disableCreatorClicksOnMshop;d.createAll();d.initializeAll();e.vars.useMultiCarousel?(e.vars.multiCarouselS2=null,-1!==q.carouselName.indexOf("-G2")||-1!==q.carouselName.indexOf("-G4")?(e.vars.multiCarouselS2=r.create(q),e.initializeMultiCarousel(!1,e.vars.multiCarouselS2)):(e.vars.multiCarouselS1=r.create(q),e.initializeMultiCarousel(!0,e.vars.multiCarouselS1)),
e.vars.A.objectIsEmpty(e.vars.multiCarouselS1)||e.vars.A.objectIsEmpty(e.vars.multiCarouselS2)||e.vars.A.$("#"+e.vars.templateId+" "+f.VIPMultiCarouselWrapper).addClass("vse-vip-two-carousels"),e.vars.handleMultiCarousel&&(e.dom.$wrapper.delegate(f.VIPMultiCarouselWrapper,"click touchstart",function(a){if(!e.vars.keepMultiCarouselOpen){if(e.vars.multiCarouselExpanded&&e.vars.$(f.vernacLanguageRadioBlockSelector).length)return!0;a.stopPropagation();a.preventDefault();e.openCloseMultiCarousel()}e.vars.$(a.target).closest(".vse-video-card").length&&
null!=e.vars.visualSearchComponent&&(e.vars.visualSearchComponent.hideSearchTooltip(!0),e.vars.isMultiCarouselClosedForFirstTime=!0)}),e.vars.handleMultiCarousel=!1)):e.vars.relatedVideosCarousel=r.create(q);e.removeAriaHiddenFromCarouselCards();e.vars.A.declarative(q.carouselName+"-seeMoreRelatedVideosButtonClick","click touch",function(a){try{var b=a.$currentTarget.get()[0],c=e.vars.A.$(b).find("[data-segment-id]").attr("data-segment-id");e.emitClickMetric(f.METRIC_LB_SHOW_MORE_BUTTON_CLICK,c)}catch(d){l.logError(f.ATTRIBUTION_NAME,
"Event target is undefined for show more click",d)}});e.vars.A.on("vse:contentCarousel:"+q.carouselName+":click",function(c){e.vars.A.objectIsEmpty(e.vars.player)||(null!=e.vars.onSiteAttributionMetrics&&e.vars.onSiteAttributionMetrics.emitCarouselClickEvent(),e.vars.player.play(c),a.trigger("vse:ns:partialcomponents:"+e.vars.clientPrefix+":relatedvideos:click",c),e.vars.currentIndex=e.findIndex(c),e.vars.showVotes=e.shouldShowVotes(c),e.show(c),e.vars.currentAssetSpec=c,e.vars.showLightboxV2Experience&&
e.resizeLB(),e.vars.useMultiCarousel&&e.vars.multiCarouselExpanded&&e.openCloseMultiCarousel(),e.emitClickMetric(f.METRIC_LB_THUMBNAIL_CLICK),e.vars.isVideoImmersivePlayer&&(e.vars.isUpNextComponentActive&&e.removeUpNextComponent(),e.vars.videoActionTrayComponents.updateActiveVideoContentId(c),e.resetUserActivityTimer(),e.showVideoImmersivePlayerOverlay(),e.vars.isVIPOverlayTimerSet||(e.vars.intervalUserActivityHandlerId=e.userActivityCountDown()),e.vars.videoActionTrayComponents.reset(),e.emitClickMetric(f.METRIC_WATCH_THUMBNAIL_CLICK)),
e.removeAriaHiddenFromCarouselCards())});e.vars.A.on("vse:ns:partialcomponents:"+e.vars.clientPrefix+":relatedvideos:rotate",function(a){e.vars.currentIndex=e.findIndex(a);a=e.getCurrentlyPlayingVideoInCarousel(e.vars.currentIndex);e.show(a)});if(e.isImageBlockVIP()||-1==e.vars.currentIndex)e.vars.currentIndex=e.findIndex(e.vars.currentAssetSpec);var t=-1==e.vars.currentIndex?e.vars.currentAssetSpec:e.getCurrentlyPlayingVideoInCarouselMarkAsPlaying(e.vars.currentIndex);if(t!==u){t.showHotspots&&e.showOrHideSearchButton(t);
e.vars.useAllIVXComponents&&e.updateVideoMetadataIfNeeded(t);e.markPlaying(t);e.vars.initialVideo=t;e.vars.showVotes=e.shouldShowVotes(t);e.initializeHelpfulVotes();e.createContinuousPlayPlaylist(t);e.updateFollowCreatorButton(t);e.updateFeedback(t);e.refreshSocialSharePageState(t);e.vars.isVideoImmersivePlayer?(!e.vars.A.objectIsEmpty(e.vars.videoActionTrayComponents)&&e.vars.useMultiCarousel||e.initializeVideoActionTray(q.segmentTabs,q.carouselCardWidth),e.updateSegmentTab(t),e.vars.videoActionTrayComponents.updateActiveVideoContentId(t.contentId),
e.emitRelatedVideosRenderMetric(f.METRIC_WATCH_THUMBNAIL_RENDER,e.vars.relatedVideosCarousel),e.vars.keepCarouselOpenOnLinkClick=q.keepCarouselOpenOnLinkClick,e.vars.watchAllClicked?e.handleKeepVideoCarouselOpen():e.handleKeepProductCarouselOpen()):(1===e.vars.playlist.length?a.trigger("vse:ns:relatedVideos:"+e.vars.clientPrefix+":hide"):e.toggleSingleLbCssClass(!1),e.attachStickyHeaders());e.vars.shouldShowProfiles=q.includeProfiles;-1==e.vars.currentIndex&&(e.isInfluencerVideo(t)||e.isCustomerReviewVideo(t))&&
(e.vars.shouldShowProfiles=!0);e.vars.shouldShowProfiles&&(e.getCustomerProfileDomElements(),e.isCustomerReviewVideo(t)&&e.updateCustomerProfile(t),e.isInfluencerVideo(t)&&e.updateInfluencerProfile(t),e.dom.$activeVideoCustomerProfile.delegate(".vse-profile","click",function(a){e.vars.disableCreatorClicksOnMshop?e.preventExternalLinkClick(a):(a=e.vars.$(a.target).closest("."+f.VIPVideoInfoClassName).find(".vse-profile").attr("href"),e.openExternalLinkFromLightBox(a))}),e.dom.$activeVideoCustomerProfile.delegate(".vse-link",
"click",function(a){a=e.vars.$(a.target).closest("."+f.VIPVideoInfoClassName).find(".vse-link").attr("href");e.openExternalLinkFromLightBox(a)}),a.trigger("resize",{},{width:m.innerWidth,height:m.innerHeight}));e.vars.lightboxCarouselRegistered=!0;var v=document.querySelectorAll("#"+e.vars.popoverId+" div.vse-video-item");!e.vars.carouselIntersectionObserver&&0<v.length&&m.IntersectionObserver&&(e.vars.carouselIntersectionObserver=new H(null,v,e.onIntersectionObserved,e.vars.enableWidgetMetricsAfterOneSecond));
var W=document.querySelectorAll("#"+q.carouselName+" div.vse-sm-expander");!e.vars.carouselShowMoreIntersectionObserver&&0<W.length&&m.IntersectionObserver&&(e.vars.carouselShowMoreIntersectionObserver=new H(null,W,e.onIntersectionObservedForShowMoreButton,e.vars.enableWidgetMetricsAfterOneSecond));e.vars.A.trigger(e.vars.clientPrefix+":vse:relatedVideos:registered")}}else e.vars.showVotes=!1,l.count(f.RV_PAGE_STATE_NOT_FOUND_ERROR_KEY+":"+e.vars.clientPrefix,1),e.vars.A.trigger("vse-common-assets-carousel-"+
h+"-initialization-failed")}catch(B){l.logFatal(f.ATTRIBUTION_NAME+":"+e.vars.clientPrefix,"Fatal during Lightbox carousel initialization.",B),l.count(c+".lightboxCarouselInitializationFatal",1)}});a.on("vse:"+e.vars.clientPrefix+":page:watchAllClicked",function(){e.vars.watchAllClicked=!0});a.on("vse:ns:relatedVideosVernacularExperience:"+e.vars.clientPrefix+":init",function(){a.declarative("onSelectVideoLanguage","change",function(a){a=e.vars.$("input:radio[name\x3d'videoLanguage']:checked").val();
a===f.HINDI?(e.vars.$("#"+f.relatedEnglishVideosContainer).addClass("aok-hidden"),e.vars.$("#"+f.relatedHindiVideosContainer).removeClass("aok-hidden")):a===f.ENGLISH&&(e.vars.$("#"+f.relatedHindiVideosContainer).addClass("aok-hidden"),e.vars.$("#"+f.relatedEnglishVideosContainer).removeClass("aok-hidden"))})});a.on("vse:"+e.vars.clientPrefix+":seeMoreBlock:init",function(a,b){e.vars.isMobile&&e.vars.popoverId&&(e.vars.$("#"+e.vars.popoverId).find(f.VIPShopIconBlockSelector).addClass("aok-hidden"),
e.vars.$("#"+e.vars.popoverId).find(f.VIPSeeMoreBlockSelector).removeClass("aok-hidden"),e.vars.$("#"+e.vars.popoverId).find(f.VIPSeeMoreLinkSelector).attr("href",a),e.vars.$("#"+e.vars.popoverId).find(f.VIPSeeMoreTextSelector).text(b),e.vars.$("#"+e.vars.popoverId).find(".vse-airy-container").addClass("vse-spotlight-player-container"),e.vars.$("#"+e.vars.popoverId).find(".vse-vip-action-tray").addClass("vse-spotlight-vip-action-tray"))});a.on("vse:ns:"+e.vars.clientPrefix+":hideAdditionalUXFeatures",
function(){e.vars.$("#"+e.vars.popoverId).find(f.VIPShareIconBlockSelector).addClass("aok-hidden");e.vars.$("#"+e.vars.popoverId).find("."+f.VIPVideoHelpfulVotesClassName).css({display:"none",visibility:"hidden"})});a.on("vse:ns:ingressCarousel:"+e.vars.clientPrefix+":init",function(h,m){try{e.vars.widgetStartTime=m;var r=a.now(),t=x.fetchLatestPageState(a,h);if(t){e.vars.popoverName=t.lightboxPopoverConfig.popoverId;var u=e.vars.popoverName+"-trigger",v=e.vars.popoverName+"-wrapper",w=new O(d,n,
a,{gatedP:D,EventEmitter:L,promise:k});e.vars.ingressCarousel=w.create(t);if(e.vars.A.objectIsEmpty(e.vars.ingressCarousel))throw new G("Cannot create Ingress Carousel. Carousel is null or undefined");e.vars.ingressPlaylist=e.vars.ingressCarousel.getplaylist();e.vars.A.on(e.vars.A.constants.BROWSER_EVENTS.SCROLL,e.vseCsmWidgetLoadedMetrics);e.vseCsmWidgetLoadedMetrics();e.vars.modalFactory=e.getModalFactory();a.on("vse:contentCarousel:"+t.carouselName+":click",function(c){var d=e.vars.modalFactory&&
e.vars.modalFactory.get(e.vars.$("#"+u));l.count(""+e.vars.clientPrefix+f.METRIC_WIDGET_CLICK,1);d?(d.show(),a.off("a:popover:afterShow:"+e.vars.popoverName),a.on("a:popover:afterShow:"+e.vars.popoverName,function(d){a.$(d.popover.$popover).addClass(a.$("#"+v).data("cssClass"));a.trigger("vse:"+e.vars.clientPrefix+":page:lightBoxOpened",{assetSpec:c,lightBoxId:v})})):l.count(f.LB_POPOVER_NOT_FOUND_ERROR_KEY+":"+e.vars.clientPrefix,1)});a.on("a:popover:beforeHide:"+e.vars.popoverName,function(){a.objectIsEmpty(e.vars.ingressCarousel)||
e.vars.ingressCarousel.destroy();a.trigger("vse:"+e.vars.clientPrefix+":page:lightBoxClosed")});var y=a.now();l.count(c+".requestToReadyDuration",y-m);l.count(c+".requestToInitDuration",r-m);l.count(c+".initToReadyDuration",y-r);a.$("#vse-spinner").addClass("aok-hidden");e.vars.A.trigger(e.vars.clientPrefix+":vse:ingressCarousel:registered")}else e.vars.showVotes=!1,l.count(f.INGRESS_RV_PAGE_STATE_NOT_FOUND_ERROR_KEY+":"+e.vars.clientPrefix,1),e.vars.A.trigger("vse-common-assets-carousel-"+h+"-initialization-failed")}catch(z){l.logFatal(f.ATTRIBUTION_NAME+
":"+e.vars.clientPrefix,"Fatal during Ingress carousel initialization.",z),l.count(c+".ingressCarouselInitializationFatal",1),e.vars.A.hide("#"+e.vars.clientPrefix+f.INGRESS_CAROUSEL_SUFFIX)}});a.on("vse:"+e.vars.clientPrefix+":page:lightBoxOpened",function(d){e.removeAriaHiddenFromCarouselCards();if(!0===d.enableClickBasedAttribution||!1===d.enableClickBasedAttribution)e.vars.enableClickBasedAttribution=d.enableClickBasedAttribution;!e.vars.aciContentId&&d.assetSpec&&d.assetSpec.aciContentId&&(e.vars.aciContentId=
d.aciContentId);var g=e.vars.A.now();d.player&&d.templateId&&(e.vars.player=d.player,e.vars.useAllIVXComponents=!1,e.vars.templateId=d.templateId);e.vars.firstRelatedProductOverride=d.firstRelatedProductOverride;e.vars.lightboxOpened=!0;e.vars.popoverId=d.lightBoxId;e.vars.A.objectIsEmpty(d.assetSpec)&&(e.vars.ingressHasInitialAssetSpec=!1);d.lazyLoadProductAsin&&(e.vars.lightboxCarouselRegistered=!1);e.vars.lightboxCarouselRegistered?(e.vars.ingressHasInitialAssetSpec?(e.vars.currentIndex=e.findIndex(d.assetSpec),
e.vars.currentAssetSpec=e.getCurrentlyPlayingVideoInCarouselMarkAsPlaying(e.vars.currentIndex),e.vars.seekTime=d.assetSpec.seekTime,e.vars.videoUrlInlineVideoKey=d.assetSpec.videoUrl):(e.vars.currentAssetSpec=e.getActiveAsset(),e.vars.currentIndex=e.vars.currentAssetSpec.index),e.createContinuousPlayPlaylist(e.vars.currentAssetSpec)):(e.vars.seekTime=e.vars.ingressHasInitialAssetSpec?d.assetSpec.seekTime:d.seekTime,e.vars.rankingStrategy=e.vars.ingressHasInitialAssetSpec?d.assetSpec.rankingStrategy:
d.rankingStrategy,e.vars.videoUrlInlineVideoKey=e.vars.ingressHasInitialAssetSpec?d.assetSpec.videoUrl:d.videoUrl,e.vars.currentIndex=e.vars.ingressHasInitialAssetSpec&&!d.lazyLoadProductAsin?d.assetSpec.index:0,e.vars.currentAssetSpec=e.vars.ingressHasInitialAssetSpec?d.assetSpec:e.vars.initialVideo,e.vars.ingressHasInitialAssetSpec&&e.vars.initialVideo&&(e.vars.A.objectIsEmpty(e.vars.currentAssetSpec.vendorName)&&(e.vars.currentAssetSpec.vendorName=e.vars.initialVideo.vendorName,e.vars.currentAssetSpec.entityId=
e.vars.initialVideo.entityId,e.vars.currentAssetSpec.entityType=e.vars.initialVideo.entityType),e.vars.A.objectIsEmpty(e.vars.currentAssetSpec.closedCaptions)&&(e.vars.currentAssetSpec.closedCaptions=e.vars.initialVideo.closedCaptions),e.vars.A.objectIsEmpty(e.vars.currentAssetSpec.labelDetails)&&(e.vars.currentAssetSpec.labelDetails=e.vars.initialVideo.labelDetails)));d.initialRelatedProducts&&(e.vars.currentAssetSpec.relatedProducts=d.initialRelatedProducts);e.vars.currentAssetSpec&&e.vars.A.objectIsEmpty(e.vars.currentAssetSpec.rankingStrategy)&&
(e.vars.currentAssetSpec.rankingStrategy=e.vars.rankingStrategy);e.vars.lightboxOpenedFirstTime&&(e.getDomElements(e.vars.popoverId,e.vars.templateId),e.vars.isMobile||(e.dom.$wrapper.closest(f.LightboxWrapperSelector).addClass(e.dom.$wrapper.attr("class")),e.addPlayerHoverHandler()),e.vars.showContentCarousel||(e.vars.showVotes=e.shouldShowVotes(e.vars.currentAssetSpec),e.initializeHelpfulVotes()));e.vars.A.capabilities.mobile&&!e.vars.A.capabilities.isAmazonApp&&e.vars.$("body").scrollTop(1);e.vars.$("body").addClass("vse-lb-no-scroll");
e.vars.$("#"+e.vars.popoverId).addClass("vse-lb-opened");e.show(e.vars.currentAssetSpec);e.vars.lightboxOpenedFirstTime?(a.trigger("resize",{},{width:m.innerWidth,height:m.innerHeight}),e.vars.isVideoImmersivePlayer||e.setupDefaultClosedCaptions()):(e.resizeLB(),e.resetCarouselWithSeeMore());e.attachStickyHeaders();if(e.vars.isVideoImmersivePlayer){var h=a.capabilities.isAmazonApp?"vse-vip-lb-mshop":"vse-vip-lb-mweb";e.vars.$(f.VIPLightboxSelector).addClass(h);e.vars.$("#"+e.vars.popoverId).closest(".a-popover-secondary").addClass("vse-vip");
a.capabilities.ios&&(e.vars.$(f.VIPLightboxSelector).addClass("vse-ivx-ios"),e.vars.viewportMetaTag=e.vars.$('meta[name\x3d"viewport"]'),e.vars.viewportMetaTagContent=e.vars.viewportMetaTag.attr("content"));e.needToUpdateVideoInfoLater()?e.clearCurrentVideoInfo():(e.resetUserActivityTimer(),e.showVideoImmersivePlayerOverlay());e.vars.useAutoplayFallback||(e.vars.intervalUserActivityHandlerId=e.userActivityCountDown());e.vars.useAllIVXComponents&&e.initializeVIPControls();e.updateAudioToggleStatus();
e.vars.lightboxOpenedFirstTime||(e.vars.useMultiCarousel||e.updateSegmentTab(e.vars.currentAssetSpec),e.vars.lightboxCarouselRegistered&&e.vars.videoActionTrayComponents.updateActiveVideoContentId(e.vars.currentAssetSpec.contentId),e.vars.watchAllClicked?e.handleKeepVideoCarouselOpen():e.handleKeepProductCarouselOpen());a.delay(function(){e.vars.$("body").addClass("vse-vip-body")},250)}e.vars.currentAssetSpec&&!e.vars.currentAssetSpec.eventTimestamp&&(e.vars.currentAssetSpec.eventTimestamp=g);e.vars.currentAssetSpec.seekTime=
e.vars.seekTime;e.vars.A.delay(function(){e.dom.$wrapper.find(".vse-lb-container").animate({opacity:1},200);e.vars.useAllIVXComponents&&(e.emitEventDurationMetric(f.METRIC_OPEN_LIGHTBOX_EVENT_EXECUTION,e.vars.A.now()-g),e.startPlaying(e.vars.currentAssetSpec))},200);e.dom.$activeVideoOspLink.unbind("click").click(function(a){e.vars.disableCreatorClicksOnMshop?e.closeIXVAndTriggerDisclosureEvent(a):e.openExternalLinkFromLightBox(a)});e.dom.$activeVideoCRLink.click(function(a){a=e.vars.$(a.target).closest(".vse-cr-link").attr("href");
e.openExternalLinkFromLightBox(a)});!e.vars.isMobile&&e.vars.placement&&-1!==e.vars.placement.toLowerCase().indexOf("search")&&e.vars.$("#"+e.vars.popoverId).closest(f.LightboxWrapperSelector).addClass("vse-responsive-lightbox");e.vars.isMobile&&e.vars.placement&&-1!==e.vars.placement.toLowerCase().indexOf("search")&&e.vars.$("#"+e.vars.popoverId).closest(f.LightboxWrapperSelector).removeClass("vse-responsive-lightbox").removeClass("vse-vertical-lightbox").addClass("vse-vip");e.isImageBlockVIP()&&
e.vars.$("#"+e.vars.popoverId).closest(".video-immersive-view-gallery").addClass("vse-vip");v.when("mash").execute("vse-mash-detection",function(a){e.vars.isMshop=!0;e.vars.mShopFactory=a;e.vars.disableFullScreenOnMshop||e.requestMshopFullscreen();document.addEventListener("visibilitychange",function(){"visible"==document.visibilityState&&!e.vars.disableFullScreenOnMshop&&e.vars.lightboxOpened&&e.requestMshopFullscreen()})});l.count(f.LB_OPENED+":"+e.vars.clientPrefix,1);e.emitMetric(f.METRIC_LIGHTBOX_OPEN);
var k=x.fetchLatestPageState(a,e.vars.templateId+"-lazyload-request-ps");if(e.vars.A.objectIsEmpty(k))e.vars.lightboxOpenedFirstTime=!1,l.count(f.LAZY_LOAD_PAGE_STATE_NOT_FOUND_ERROR_KEY+":"+e.vars.clientPrefix,1);else{var h=function(a,b){e.vars.A.trigger("vse:"+c+":lazyload:"+b.configuration.type+":succeeded")},n=function(a,b){e.vars.A.trigger("vse:"+c+":lazyload:"+b.configuration.type+":failed")};e.vars.lightboxOpenedFirstTime?(k=a.$.extend({video:{contentID:e.vars.currentAssetSpec.contentId,contentIDType:"ASIN",
videoURL:e.vars.currentAssetSpec.videoUrl,imageURL:e.vars.currentAssetSpec.imageURL}},k),d.lazyLoadProductAsin&&(k.product.contentID=d.lazyLoadProductAsin),ja.getLazyLoadComponents(e.vars.A,e.vars.popoverId,k,h,n),e.vars.lightboxOpenedFirstTime=!1):d.lazyLoadProductAsin&&(k.product.contentID=d.lazyLoadProductAsin,ja.getLazyLoadComponents(e.vars.A,e.vars.popoverId,k,h,n))}});a.on("vse:"+e.vars.clientPrefix+":page:lightBoxClosed",function(){e.vars.lightboxOpened&&(e.vars.lightboxOpened=!1,e.vars.ingressHasInitialAssetSpec=
!0,a.trigger("inlineVideo:immersiveViewClosed",{videoUrl:e.vars.videoUrlInlineVideoKey,seekTime:e.vars.player.getCurrentTime()}),e.dom.$wrapper.find(".vse-lb-container").animate({opacity:0}),e.vars.$("body").removeClass("vse-lb-no-scroll"),e.resetStickyHeaders(),e.vars.useAllIVXComponents&&e.vars.player.pause(),e.vars.isVideoImmersivePlayer&&(e.vars.$("body").removeClass("vse-vip-body"),e.clearIntervalUserActivityHandler(),null!=e.vars.videoActionTrayComponents&&e.vars.videoActionTrayComponents.reset(),
e.emitMetric(f.METRIC_VIP_CLOSE),e.vars.useAutoplayFallback&&!e.vars.vipPlayIconClicked&&(e.emitMetric(f.METRIC_VIP_CLOSE_WITHOUT_PLAY),l.count(e.vars.clientPrefix+":"+f.METRIC_VIP_CLOSE_WITHOUT_PLAY,1)),e.resetVIPControls(),e.vars.useMultiCarousel&&e.vars.multiCarouselExpanded&&e.openCloseMultiCarousel(),e.vars.isMshop&&!e.vars.disableFullScreenOnMshop&&e.cancelMshopFullscreen(),e.vars.A.$("#"+e.vars.templateId+" ."+f.UpNextCancelClassName).click()),e.vars.customerReviewsConfig&&e.vars.customerReviewsConfig.showCustomerReviewMetadata&&
e.vars.A.off("resize",e.handleReviewsOnResize),a.trigger("vse:ns:partialcomponents:"+e.vars.clientPrefix+":lightboxClosed"))});a.on("vse:"+e.vars.clientPrefix+":lazyload:relatedvideos:succeeded",function(){e.resizeLB();e.emitPFORenderMetric(f.METRIC_PFO_RENDER)});a.on("vse:"+e.vars.clientPrefix+":lazyload:relatedvideos:failed",function(){e.vars.isVideoImmersivePlayer?e.vars.A.hide(e.vars.A.$("#"+e.vars.templateId+" "+f.VIPWatchIconBlockSelector)):e.vars.A.hide(e.vars.A.$("#"+e.vars.templateId+" div[class^\x3d'div-'][class$\x3d'lb'] .vse-lazyload-spinner"))});
a.on("vse:ns:relatedVideos:"+e.vars.clientPrefix+":hide",function(){e.vars.lightboxOpened&&e.vars.isVideoImmersivePlayer?e.vars.A.hide(e.vars.A.$("#"+e.vars.templateId+" "+f.VIPWatchIconBlockSelector)):e.toggleSingleLbCssClass(!0)});a.on("resize",function(){e.vars.lightboxOpened&&e.resizeLB()});a.on.orientationchange(function(a){!e.vars.isVideoImmersivePlayer&&e.vars.playFullScreenVideo&&(0===a.orientation?e.vars.player.aspectRatio(e.getAspectRatio(f.PORTRAIT)):e.vars.player.aspectRatio(e.getAspectRatio(f.LANDSCAPE)));
e.vars.isMobile&&e.vars.lightboxOpened&&(e.vars.$("#"+e.vars.popoverId).height(m.innerHeight),e.dom.$lbContainer.height(m.innerHeight))});a.on("vse:ns:inlinePlayer:"+e.vars.clientPrefix+":init",function(c){try{var d=x.fetchLatestPageState(a,c.pageStateName),g=new da(a,e,c),h=a.$("#"+d.inlinePlayerConfig.lightboxClickHandlerSelector),k=c.popoverId&&c.popoverTriggerId;k&&g.addLightboxAfterShowAndBeforeHideEvents();g.initializePlayerOverlayComponents(h);var m={playerInstance:e.vars.player,changePlayerMode:g.changePlayerMode,
startPlaying:g.startPlaying};k?m.openLightbox=g.openLightbox:(m.movePlayerToLightbox=g.movePlayerToLightbox,m.movePlayerToIngress=g.movePlayerToIngress);d.needPlayerFactory?(m.playerFactoryConfig={playerFactory:e.vars.playerFactory,playerConfig:d,addPlayerLoadedHandler:g.addPlayerLoadedHandler},m.playerInstance=u,a.trigger("vse:ns:inlinePlayer:factory:"+e.vars.clientPrefix+":ready",m)):(g.addPlayerLoadedHandler(),a.trigger("vse:ns:inlinePlayer:"+e.vars.clientPrefix+":ready",m),l.count("vse:ns:inlinePlayer:initSuccess",
1))}catch(n){l.count("vse:ns:inlinePlayer:"+e.vars.clientPrefix+":initFailed",1),l.logError(f.ATTRIBUTION_NAME,"Fallback for inline player "+e.vars.clientPrefix,n),a.trigger("vse:ns:inlinePlayer:"+e.vars.clientPrefix+":initFailed",n),l.count("vse:ns:inlinePlayer:initFailed",1)}})},TestModules:ya,Utils:ia,_noneFeature:c()}})})};v.when("A","3p-promise").execute("VSE-gatedP-register-VSEComponentAssets-client",function(d,c){D.register("VSEComponentAssets","VSE-VSEComponentAssets-client-registered",Ba,
c)});v.when("A","a-carousel-constants","a-carousel-framework","a-carousel-transition-slide").execute("vse-video-carousel-transition-registration",function(d,c,a,b){var f=m.vseFeatures||{};f["vse-video-carousel-transition-strategy"]||(d=new ca(d,c,b),a.registerStrategy("transition","vse-video-carousel-transition",d.get()),f["vse-video-carousel-transition-strategy"]=!0)});v.when("A","a-carousel-framework","a-carousel-constants").execute("vse-display-strategy-registration",function(d,c,a){var b=m.vseFeatures||
{};b["vse-video-carousel-display-strategy"]||(d=new ba(d,a),c.registerStrategy("display","vse-video-carousel-display",d),b["vse-video-carousel-display-strategy"]=!0)})}catch(d){l.logError(f.ATTRIBUTION_NAME,"Error during VSE AUI module registration.",d),l.count(f.ATTRIBUTION_NAME+".moduleFatal",1)}})()});